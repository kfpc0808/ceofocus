<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Financial Master í†µí•© ê´€ë¦¬ì V22 (ê°€ì…ì—°ë™ì™„ë£Œ)</title>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    <!-- Phosphor Icons -->
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <style>
        :root {
            --primary-color: #0c2c54;
            --secondary-color: #f5f6fa;
            --accent-color: #3498db;
            --success-color: #27ae60;
            --danger-color: #e74c3c;
            --warning-bg: #fff3cd;
            --warning-text: #856404;
            --text-color: #2c3e50;
            --border-color: #dee2e6;
            --sidebar-width: 250px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Noto Sans KR', sans-serif;
            background: var(--secondary-color);
            color: var(--text-color);
            display: flex;
            min-height: 100vh;
            font-size: 0.9rem;
        }

        /* ì‚¬ì´ë“œë°” */
        .sidebar {
            width: var(--sidebar-width);
            background: var(--primary-color);
            color: white;
            position: fixed;
            height: 100vh;
            left: 0; top: 0;
            display: flex;
            flex-direction: column;
            padding: 1rem;
            z-index: 100;
        }

        .logo {
            font-size: 1.4rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            padding: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: white;
            text-decoration: none;
        }

        .nav-menu { list-style: none; flex: 1; }
        .nav-item { margin-bottom: 0.25rem; }
        .nav-link {
            display: flex; align-items: center; gap: 0.75rem;
            padding: 0.6rem 1rem;
            color: rgba(255, 255, 255, 0.7);
            text-decoration: none;
            border-radius: 6px;
            transition: all 0.3s;
            cursor: pointer;
            font-size: 0.9rem;
        }
        .nav-link:hover, .nav-link.active { background: rgba(255, 255, 255, 0.1); color: white; }
        .admin-profile {
            padding: 1rem; border-top: 1px solid rgba(255, 255, 255, 0.1);
            display: flex; align-items: center; gap: 0.75rem;
        }

        /* ë©”ì¸ ì»¨í…ì¸  */
        .main-content { margin-left: var(--sidebar-width); flex: 1; padding: 1.5rem; }
        .page-header { margin-bottom: 1.5rem; display: flex; justify-content: space-between; align-items: center; }
        .page-title { font-size: 1.5rem; color: var(--primary-color); font-weight: 700; }

        .card {
            background: white; border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            padding: 1.2rem; margin-bottom: 1.2rem;
        }

        /* íƒ­ ì»¨í…ì¸  ì œì–´ */
        .tab-content { display: none; }
        .tab-content.active { display: block; animation: fadeIn 0.3s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* ì„œë¸Œ íƒ­ */
        .sub-nav { display: flex; gap: 0.5rem; margin-bottom: 1rem; border-bottom: 2px solid #e9ecef; padding-bottom: 0; overflow-x: auto; }
        .sub-nav-item { padding: 0.5rem 0.8rem; cursor: pointer; font-weight: 600; color: #6c757d; border-bottom: 3px solid transparent; margin-bottom: -2px; transition: all 0.2s; white-space: nowrap; font-size: 0.9rem; }
        .sub-nav-item:hover { color: var(--primary-color); }
        .sub-nav-item.active { color: var(--primary-color); border-bottom-color: var(--primary-color); }
        .sub-tab-content { display: none; }
        .sub-tab-content.active { display: block; animation: fadeIn 0.3s ease; }

        /* ë²„íŠ¼ */
        .btn { padding: 0.5rem 1rem; border: none; border-radius: 4px; font-weight: 600; cursor: pointer; transition: all 0.2s; display: inline-flex; align-items: center; gap: 0.4rem; font-size: 0.85rem; text-decoration: none; }
        .btn-sm { padding: 0.25rem 0.5rem; font-size: 0.75rem; }
        .btn-primary { background: var(--primary-color); color: white; }
        .btn-secondary { background: var(--accent-color); color: white; }
        .btn-danger { background: var(--danger-color); color: white; }
        .btn-success { background: var(--success-color); color: white; }
        .btn-outline { background: white; border: 1px solid var(--border-color); color: var(--text-color); }
        .btn:hover { opacity: 0.9; transform: translateY(-1px); }
        .btn.active { background: var(--primary-color); color: white; border-color: var(--primary-color); }

        /* í…Œì´ë¸” */
        .table-controls { display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.8rem; flex-wrap: wrap; gap: 0.8rem; }
        .table-controls h3 { font-size: 1.1rem; margin: 0; }
        .search-box { display: flex; gap: 0.4rem; align-items: center; }
        .search-box input { padding: 0.4rem; border: 1px solid #dee2e6; border-radius: 4px; min-width: 200px; font-size: 0.85rem; }
        
        .table-container { overflow-x: auto; min-height: 200px; }
        table { width: 100%; border-collapse: collapse; margin-top: 0.2rem; min-width: 800px; font-size: 0.85rem; }
        th { background: #f8f9fa; color: var(--primary-color); padding: 0.6rem 0.5rem; text-align: left; font-weight: 600; border-bottom: 2px solid var(--border-color); white-space: nowrap; }
        td { padding: 0.5rem 0.5rem; border-bottom: 1px solid #eee; vertical-align: middle; white-space: nowrap; }
        .clickable-cell { cursor: pointer; color: var(--primary-color); font-weight: 600; text-decoration: underline; text-underline-offset: 2px; }
        
        .pagination { display: flex; justify-content: center; gap: 0.3rem; margin-top: 1rem; align-items: center; }
        .page-btn { padding: 0.3rem 0.6rem; border: 1px solid #dee2e6; background: white; border-radius: 4px; cursor: pointer; min-width: 28px; text-align: center; font-size: 0.85rem; }
        .page-btn:hover { background: #e9ecef; }
        .page-btn.active { background: var(--primary-color); color: white; border-color: var(--primary-color); }
        .page-btn:disabled { opacity: 0.5; cursor: not-allowed; }

        /* í¼ */
        .form-group { margin-bottom: 0.8rem; }
        .form-group label { display: block; margin-bottom: 0.3rem; font-weight: 600; color: var(--primary-color); font-size: 0.9rem; }
        .form-control { width: 100%; padding: 0.5rem; border: 1px solid var(--border-color); border-radius: 4px; font-size: 0.9rem; }
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 0.8rem; }

        /* ì—ë””í„° */
        .editor-container { border: 1px solid var(--border-color); border-radius: 4px; overflow: hidden; }
        .editor-toolbar { background: #f8f9fa; border-bottom: 1px solid var(--border-color); padding: 0.4rem; display: flex; gap: 0.4rem; align-items: center; }
        .editor-btn { background: white; border: 1px solid #dee2e6; border-radius: 3px; width: 26px; height: 26px; display: flex; justify-content: center; align-items: center; cursor: pointer; font-weight: bold; font-size: 0.8rem; }
        .editor-content { min-height: 300px; padding: 0.8rem; outline: none; overflow-y: auto; background: white; font-size: 0.9rem; line-height: 1.5; }
        .color-picker { width: 26px; height: 26px; padding: 0; border: none; cursor: pointer; }

        /* ëª¨ë‹¬ */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; justify-content: center; align-items: center; }
        .modal-content { background: white; width: 90%; max-width: 800px; border-radius: 8px; padding: 1.5rem; max-height: 90vh; overflow-y: auto; }

        /* ë°°ì§€ ë° ê¸°íƒ€ */
        .tab-btn-group { display: flex; gap: 0.4rem; margin-bottom: 0.8rem; border-bottom: 1px solid #eee; padding-bottom: 0.8rem; }
        .badge { padding: 0.2rem 0.5rem; border-radius: 3px; font-size: 0.75rem; font-weight: 600; display: inline-flex; align-items: center; gap: 3px; }
        .badge-blue { background: #e3f2fd; color: #1565c0; }
        .badge-green { background: #e8f5e9; color: #2e7d32; }
        .badge-red { background: #ffebee; color: #c62828; }
        .badge-gray { background: #f1f3f5; color: #495057; }
        .badge-warning { background: var(--warning-bg); color: var(--warning-text); }
        .badge-point { background: #fff8e1; color: #f57f17; border: 1px solid #ffecb3; }
        .badge-purple { background: #f3e5f5; color: #7b1fa2; }
        .password-display { font-family: monospace; background: #f8f9fa; padding: 2px 6px; border-radius: 3px; border: 1px solid #dee2e6; color: #d63384; font-weight: bold; font-size: 0.85rem; }
        .status-card { display: flex; align-items: center; gap: 0.8rem; background: #fff; padding: 1.2rem; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .status-icon { width: 40px; height: 40px; border-radius: 8px; display: flex; justify-content: center; align-items: center; font-size: 1.2rem; }
        .status-card div div:first-child { font-size: 0.85rem; }
        .status-card div div:last-child { font-size: 1.3rem; }
    </style>
</head>
<body>

    <!-- ì‚¬ì´ë“œë°” -->
    <nav class="sidebar">
        <a href="#" class="logo"><i class="ph ph-briefcase-metal"></i> Fin.Master</a>
        <ul class="nav-menu">
            <li class="nav-item"><a class="nav-link active" onclick="switchTab('dashboard')"><i class="ph ph-squares-four"></i> ëŒ€ì‹œë³´ë“œ</a></li>
            <li class="nav-item"><a class="nav-link" onclick="switchTab('users')"><i class="ph ph-users"></i> íšŒì› ê´€ë¦¬</a></li>
            <li class="nav-item"><a class="nav-link" onclick="switchTab('payment')"><i class="ph ph-credit-card"></i> ê²°ì œÂ·í¬ì¸íŠ¸</a></li>
            <li class="nav-item"><a class="nav-link" onclick="switchTab('prompts')"><i class="ph ph-robot"></i> AI í”„ë¡¬í”„íŠ¸</a></li>
            <li class="nav-item"><a class="nav-link" onclick="switchTab('suggestions')"><i class="ph ph-mailbox"></i> ì œì•ˆ/ê±´ì˜</a></li>
            <li class="nav-item"><a class="nav-link" onclick="switchTab('notices')"><i class="ph ph-megaphone"></i> ê³µì§€ì‚¬í•­</a></li>
            <li class="nav-item"><a class="nav-link" onclick="switchTab('admins')"><i class="ph ph-user-gear"></i> ê´€ë¦¬ì ê´€ë¦¬</a></li>
            <li class="nav-item"><a class="nav-link" onclick="switchTab('terms')"><i class="ph ph-scroll"></i> ì•½ê´€ ë° ì •ì±…</a></li>
        </ul>
        <div class="admin-profile">
            <i class="ph ph-user-circle" style="font-size: 2rem;"></i>
            <div><div style="font-weight: 600;">ìµœê³ ê´€ë¦¬ì</div><div style="font-size: 0.8rem; opacity: 0.7; cursor: pointer;" onclick="alert('ë¡œê·¸ì•„ì›ƒ ë˜ì—ˆìŠµë‹ˆë‹¤.')">ë¡œê·¸ì•„ì›ƒ</div></div>
        </div>
    </nav>

    <!-- ë©”ì¸ ì»¨í…ì¸  -->
    <main class="main-content">
        <!-- 1. ëŒ€ì‹œë³´ë“œ -->
        <div id="dashboard" class="tab-content active">
            <div class="page-header">
                <h1 class="page-title">ëŒ€ì‹œë³´ë“œ</h1>
                <div style="display: flex; align-items: center; gap: 1rem;">
                    <div style="color: #666;">ì˜¤ëŠ˜ ë‚ ì§œ: <span id="currentDate"></span></div>
                    <a href="https://console.cloud.google.com/apis/api/generativelanguage.googleapis.com/metrics" target="_blank" class="btn btn-outline" style="color: #4285F4; border-color: #4285F4;"><i class="ph ph-google-logo"></i> Gemini API ì‚¬ìš©ëŸ‰ ì¡°íšŒ</a>
                </div>
            </div>
            <!-- í†µê³„ ì¹´ë“œ -->
            <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 1rem; margin-bottom: 1.5rem;">
                <div class="status-card"><div class="status-icon" style="background: #e3f2fd; color: #1565c0;"><i class="ph ph-users"></i></div><div><div style="font-size: 0.85rem; color: #666;">ì „ì²´ íšŒì›</div><div style="font-size: 1.3rem; font-weight: 700;">1,240</div></div></div>
                <div class="status-card"><div class="status-icon" style="background: #e8f5e9; color: #2e7d32;"><i class="ph ph-credit-card"></i></div><div><div style="font-size: 0.85rem; color: #666;">ì´ë²ˆë‹¬ ê²°ì œì™„ë£Œ</div><div style="font-size: 1.3rem; font-weight: 700;">1,180ê±´</div></div></div>
                <div class="status-card"><div class="status-icon" style="background: #ffebee; color: #c62828;"><i class="ph ph-warning-circle"></i></div><div><div style="font-size: 0.85rem; color: #666;">ì‹ ê·œ ì‹ ì²­ ëŒ€ê¸°</div><div style="font-size: 1.3rem; font-weight: 700; color: var(--danger-color);">3ê±´</div></div></div>
                <div class="status-card"><div class="status-icon" style="background: #fff8e1; color: #f57f17;"><i class="ph ph-coins"></i></div><div><div style="font-size: 0.85rem; color: #666;">ì´ ë°œí–‰ í¬ì¸íŠ¸</div><div style="font-size: 1.3rem; font-weight: 700;">2.4M P</div></div></div>
            </div>
        </div>

        <!-- 2. íšŒì› ê´€ë¦¬ -->
        <div id="users" class="tab-content">
            <div class="page-header">
                <h1 class="page-title">íšŒì› ê´€ë¦¬</h1>
                <button class="btn btn-primary" onclick="openRegisterModal()"><i class="ph ph-user-plus"></i> ìˆ˜ë™ íšŒì› ë“±ë¡</button>
            </div>

            <!-- ê°€ì… ì‹ ì²­ ë‚´ì—­ (ìŠ¹ì¸ ëŒ€ê¸°) -->
            <div class="card" style="border-left: 4px solid var(--accent-color);">
                <div class="table-controls">
                    <h3>ğŸ“ ê°€ì… ì‹ ì²­ ë‚´ì—­ (ìŠ¹ì¸ ëŒ€ê¸°) - í™ˆí˜ì´ì§€ ì—°ë™</h3>
                    <div class="search-box">
                        <input type="text" id="pendingSearch" placeholder="ì´ë¦„, ì§€ì—­, ì—°ë½ì²˜ ê²€ìƒ‰" onkeyup="renderUsers()">
                    </div>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>ì‹ ì²­ì¼ì‹œ</th>
                                <th>ì„±ëª…</th>
                                <th>ì†Œì†/ì§í•¨</th>
                                <th>ì§€ì—­</th>
                                <th>ì—°ë½ì²˜</th>
                                <th>ì´ë©”ì¼</th> <!-- ì¶”ê°€ë¨: login.htmlì˜ email í•„ë“œ ëŒ€ì‘ -->
                                <th>ìœ í˜•</th> <!-- ê´€ë¦¬ì ì„ íƒ -->
                                <th>ê°€ì…ë¹„</th> <!-- ê´€ë¦¬ì í™•ì¸ -->
                                <th>ê´€ë¦¬</th>
                            </tr>
                        </thead>
                        <tbody id="pendingTableBody"></tbody>
                    </table>
                </div>
                <div id="pendingPagination" class="pagination"></div>
            </div>
            
            <!-- ì „ì²´ íšŒì› ëª©ë¡ -->
            <div class="card">
                <div class="table-controls">
                    <h3>ì „ì²´ íšŒì› ëª©ë¡</h3>
                    <div class="search-box">
                        <input type="text" id="userSearch" placeholder="ì•„ì´ë””, ì´ë¦„, ì§€ì—­ ê²€ìƒ‰" onkeyup="renderUsers()">
                    </div>
                </div>
                <div class="table-container">
                    <table>
                        <thead><tr><th>No</th><th>ì•„ì´ë””</th><th>ì„±ëª…</th><th>ì†Œì†/ì§í•¨</th><th>ì§€ì—­</th><th>ìœ í˜•</th><th>ì—°ë½ì²˜/ë©”ì¼</th><th>ê°€ì…ë¹„</th><th>ì›” ê²°ì œì•¡</th><th>ìƒíƒœ</th><th>ê´€ë¦¬</th></tr></thead>
                        <tbody id="userTableBody"></tbody>
                    </table>
                </div>
                <div id="userPagination" class="pagination"></div>
            </div>
        </div>

        <!-- 3. ê²°ì œ ë° í¬ì¸íŠ¸ ê´€ë¦¬ (ê¸°ì¡´ ìœ ì§€) -->
        <div id="payment" class="tab-content">
            <div class="page-header">
                <h1 class="page-title">ê²°ì œ ë° í¬ì¸íŠ¸ ê´€ë¦¬</h1>
                <button class="btn btn-secondary" onclick="runBatchSimulation()"><i class="ph ph-play-circle"></i> ì •ê¸° ê²°ì œ ì¼ê´„ ì‹¤í–‰</button>
            </div>

            <div class="sub-nav">
                <div class="sub-nav-item active" onclick="switchSubTab(this, 'payment-status-view')">ê²°ì œ í˜„í™© ë° ì´ë ¥</div>
                <div class="sub-nav-item" onclick="switchSubTab(this, 'payment-points-view')">í¬ì¸íŠ¸ ì´ìš© ë‚´ì—­</div>
                <div class="sub-nav-item" onclick="switchSubTab(this, 'payment-usage_analysis-view')">í¬ì¸íŠ¸ ì‚¬ìš© ë¶„ì„</div>
                <div class="sub-nav-item" onclick="switchSubTab(this, 'payment-expiration-view')">í¬ì¸íŠ¸ ì†Œë©¸ ê´€ë¦¬</div>
                <div class="sub-nav-item" onclick="switchSubTab(this, 'payment-unpaid-view')">ë¯¸ê²°ì œ/ì—°ì²´ ê´€ë¦¬</div>
            </div>

            <div id="payment-status-view" class="sub-tab-content active">
                <div class="card">
                    <div class="table-controls"><h3>ğŸ’³ ì´ë²ˆë‹¬ ê²°ì œ í˜„í™©</h3><div class="search-box"><input type="text" id="paymentSearch" placeholder="ê²€ìƒ‰..." onkeyup="renderPaymentHistory()"></div></div>
                    <div class="table-container"><table><thead><tr><th>ê²°ì œì¼ì‹œ</th><th>ì•„ì´ë””</th><th>ì„±ëª…</th><th>ê²°ì œ ê¸ˆì•¡</th><th>ìœ í˜•</th><th>ê²°ê³¼</th></tr></thead><tbody id="paymentHistoryBody"></tbody></table></div>
                    <div id="paymentPagination" class="pagination"></div>
                </div>
            </div>
            
            <div id="payment-points-view" class="sub-tab-content">
                <div class="card">
                    <div class="table-controls"><h3>ğŸ“Š í¬ì¸íŠ¸ ë¡œê·¸</h3><div class="search-box"><input type="text" id="pointSearch" placeholder="ê²€ìƒ‰..." onkeyup="renderPointLogs()"></div></div>
                    <div class="table-container"><table><thead><tr><th>ì¼ì‹œ</th><th>ì•„ì´ë””</th><th>ì„±ëª…</th><th>êµ¬ë¶„</th><th>ë‚´ìš©</th><th>ë³€ë™</th><th>ì”ì•¡</th></tr></thead><tbody id="pointLogsBody"></tbody></table></div>
                    <div id="pointPagination" class="pagination"></div>
                </div>
            </div>

            <div id="payment-usage_analysis-view" class="sub-tab-content">
                <div class="card"><h3>ğŸ“ˆ í¬ì¸íŠ¸ ì‚¬ìš© ë¶„ì„</h3><div class="table-container"><table style="text-align: center;"><thead><tr><th rowspan="2">íšŒì›ì •ë³´</th><th rowspan="2">ëŒ€ìƒ ì›”</th><th colspan="2" style="background:#e3f2fd">ìš”ì•½ë¶„ì„(500P)</th><th colspan="2" style="background:#e8f5e9">ìƒì„¸ë¶„ì„(2000P)</th><th rowspan="2">ì´ í¬ì¸íŠ¸</th></tr><tr><th>íšŸìˆ˜</th><th>ì°¨ê°ì•¡</th><th>íšŸìˆ˜</th><th>ì°¨ê°ì•¡</th></tr></thead><tbody id="usageStatsBody"></tbody></table></div></div>
            </div>
            <div id="payment-expiration-view" class="sub-tab-content"><div class="card"><p>ì†Œë©¸ ì˜ˆì • ëª©ë¡ (ì¤€ë¹„ì¤‘)</p></div></div>
            <div id="payment-unpaid-view" class="sub-tab-content"><div class="card"><p>ë¯¸ê²°ì œ íšŒì› ëª©ë¡ (ì¤€ë¹„ì¤‘)</p></div></div>
        </div>

        <!-- 4. í”„ë¡¬í”„íŠ¸ ê´€ë¦¬ íƒ­ (ê¸°ì¡´ ìœ ì§€) -->
        <div id="prompts" class="tab-content">
            <div class="page-header"><h1 class="page-title">AI í”„ë¡¬í”„íŠ¸ ê´€ë¦¬</h1></div>
            <div class="sub-nav">
                <div class="sub-nav-item active" onclick="switchSubTab(this, 'prompt-company')">ê¸°ì—…ë§ˆë‹¹</div>
                <div class="sub-nav-item" onclick="switchSubTab(this, 'prompt-ceo')">CEO Focus</div>
                <div class="sub-nav-item" onclick="switchSubTab(this, 'prompt-guarantee')">ë³´ì¥ë¶„ì„</div>
                <div class="sub-nav-item" onclick="switchSubTab(this, 'prompt-ff')">FF</div>
            </div>
            <div id="prompt-company" class="sub-tab-content active"><div class="card"><h3>ğŸ­ ê¸°ì—…ë§ˆë‹¹</h3><div class="form-group"><textarea class="form-control" style="min-height: 400px; font-family: monospace;">System Instruction...</textarea></div><button class="btn btn-primary">ì €ì¥</button></div></div>
            <div id="prompt-ceo" class="sub-tab-content"><div class="card"><h3>ğŸ‘” CEO Focus</h3><textarea class="form-control" style="min-height: 400px;"></textarea><button class="btn btn-primary mt-1">ì €ì¥</button></div></div>
            <div id="prompt-guarantee" class="sub-tab-content"><div class="card"><h3>ğŸ›¡ï¸ ë³´ì¥ë¶„ì„</h3><textarea class="form-control" style="min-height: 400px;"></textarea><button class="btn btn-primary mt-1">ì €ì¥</button></div></div>
            <div id="prompt-ff" class="sub-tab-content"><div class="card"><h3>ğŸ“‹ FF</h3><textarea class="form-control" style="min-height: 400px;"></textarea><button class="btn btn-primary mt-1">ì €ì¥</button></div></div>
        </div>

        <!-- 5. ì œì•ˆ/ê±´ì˜ (ê¸°ì¡´ ìœ ì§€) -->
        <div id="suggestions" class="tab-content">
            <div class="page-header"><h1 class="page-title">ì œì•ˆ / ê±´ì˜ì‚¬í•­</h1></div>
            <div class="card">
                <div class="table-controls"><h3>ëª©ë¡</h3><div class="search-box"><input type="text" id="suggestionSearch" placeholder="ì œëª©, ì‘ì„±ì ê²€ìƒ‰" onkeyup="renderSuggestions()"></div></div>
                <div class="table-container"><table><thead><tr><th>No</th><th>ì œëª©</th><th>ì‘ì„±ì</th><th>ì‘ì„±ì¼</th><th>ìƒíƒœ</th><th>ê´€ë¦¬</th></tr></thead><tbody id="suggestionTableBody"></tbody></table></div>
                <div id="suggestionPagination" class="pagination"></div>
            </div>
        </div>

        <!-- 6. ê³µì§€ì‚¬í•­ (ê¸°ì¡´ ìœ ì§€) -->
        <div id="notices" class="tab-content">
            <div class="page-header"><h1 class="page-title">ê³µì§€ì‚¬í•­ ê´€ë¦¬</h1><button class="btn btn-primary" onclick="openNoticeModal()"><i class="ph ph-pencil-simple"></i> ìƒˆ ê³µì§€ ë“±ë¡</button></div>
            <div class="card">
                <div class="table-controls"><h3>ë“±ë¡ëœ ê³µì§€ì‚¬í•­</h3><div class="search-box"><input type="text" id="noticeSearch" placeholder="ì œëª© ê²€ìƒ‰" onkeyup="renderNotices()"></div></div>
                <div class="table-container"><table><thead><tr><th style="width: 50px;">No</th><th>ì œëª©</th><th>ë“±ë¡ì¼ì</th><th>ì²¨ë¶€íŒŒì¼</th><th>ê´€ë¦¬</th></tr></thead><tbody id="noticeTableBody"></tbody></table></div>
                <div id="noticePagination" class="pagination"></div>
            </div>
        </div>

        <!-- 7. ê´€ë¦¬ì ê´€ë¦¬ (ê¸°ì¡´ ìœ ì§€) -->
        <div id="admins" class="tab-content">
            <div class="page-header"><h1 class="page-title">ê´€ë¦¬ì ê³„ì • ê´€ë¦¬</h1><button class="btn btn-primary"><i class="ph ph-plus"></i> ê´€ë¦¬ì ì¶”ê°€</button></div>
            <div class="card">
                <div class="table-controls"><h3>ê´€ë¦¬ì ëª©ë¡</h3><div class="search-box"><input type="text" id="adminSearch" placeholder="ì•„ì´ë””, ì´ë¦„ ê²€ìƒ‰" onkeyup="renderAdmins()"></div></div>
                <div class="table-container"><table><thead><tr><th>ì•„ì´ë””</th><th>ì´ë¦„</th><th>ê¶Œí•œ</th><th>ê´€ë¦¬</th></tr></thead><tbody id="adminTableBody"></tbody></table></div>
                <div id="adminPagination" class="pagination"></div>
            </div>
        </div>

        <!-- 8. ì•½ê´€ (ê¸°ì¡´ ìœ ì§€) -->
        <div id="terms" class="tab-content">
            <div class="page-header"><h1 class="page-title">ì•½ê´€ ë° ì •ì±… ê´€ë¦¬</h1></div>
            <div class="card">
                <div class="tab-btn-group"><button class="btn btn-primary active" id="btn-term-service" onclick="loadTerm('service')">ì„œë¹„ìŠ¤ ì´ìš©ì•½ê´€</button><button class="btn btn-outline" id="btn-term-privacy" onclick="loadTerm('privacy')">ê°œì¸ì •ë³´ ì²˜ë¦¬ë°©ì¹¨</button><button class="btn btn-outline" id="btn-term-marketing" onclick="loadTerm('marketing')">ë§ˆì¼€íŒ… ìˆ˜ì‹ ë™ì˜</button></div>
                <div class="form-group"><textarea class="form-control" id="termEditor" style="min-height: 500px; font-family: monospace; line-height: 1.6;"></textarea></div>
                <button class="btn btn-primary" onclick="saveTerms()"><i class="ph ph-floppy-disk"></i> í˜„ì¬ ë‚´ìš© ì €ì¥</button>
            </div>
        </div>
    </main>

    <!-- ëª¨ë‹¬: ID ë°œê¸‰ ë° ê°€ì… ìŠ¹ì¸ (í•„ë“œ ìë™ ì…ë ¥ ì—°ë™) -->
    <div id="registerModal" class="modal">
        <div class="modal-content">
            <h3>ğŸ‘¥ íšŒì› ìŠ¹ì¸ ë° ID ë°œê¸‰</h3>
            <p style="font-size:0.9rem; color:#666; margin-bottom:1rem;">ì‹ ì²­ ì •ë³´ë¥¼ í™•ì¸í•˜ê³  ID/ë¹„ë°€ë²ˆí˜¸ ë° ê¶Œí•œì„ ì„¤ì •í•˜ì„¸ìš”.</p>
            <form id="registerForm">
                <!-- ì‹ ì²­ ì •ë³´ (Read-Only: login.htmlì˜ í•„ë“œëª… ë°˜ì˜) -->
                <div style="background:#f8f9fa; padding:1rem; border-radius:6px; margin-bottom:1rem; border:1px solid #eee;">
                    <h4 style="margin-bottom:0.5rem; font-size:0.9rem; color:var(--primary-color);">[ì‹ ì²­ì ì •ë³´]</h4>
                    <div class="form-row">
                        <div class="form-group"><label>ì„±ëª…</label><input type="text" id="newUserName" class="form-control" readonly style="background:white"></div>
                        <div class="form-group"><label>ì—°ë½ì²˜</label><input type="text" id="newUserPhone" class="form-control" readonly style="background:white"></div>
                    </div>
                    <div class="form-row">
                        <div class="form-group"><label>ì´ë©”ì¼</label><input type="text" id="newUserEmail" class="form-control" readonly style="background:white"></div>
                        <div class="form-group"><label>ì§€ì—­</label><input type="text" id="newUserRegion" class="form-control" readonly style="background:white"></div>
                    </div>
                    <div class="form-row">
                        <div class="form-group"><label>ì†Œì†ì‚¬</label><input type="text" id="newUserCompany" class="form-control" readonly style="background:white"></div>
                        <div class="form-group"><label>ì§í•¨</label><input type="text" id="newUserTitle" class="form-control" readonly style="background:white"></div>
                    </div>
                </div>

                <!-- ê´€ë¦¬ì ì„¤ì • -->
                <div style="padding:1rem; border:1px solid #dee2e6; border-radius:6px;">
                    <h4 style="margin-bottom:0.5rem; font-size:0.9rem; color:var(--accent-color);">[ê´€ë¦¬ì ì„¤ì •]</h4>
                    <div class="form-row">
                        <div class="form-group"><label>ì•„ì´ë”” (ìƒì„±)</label><input type="text" id="newUserId" class="form-control" placeholder="ì˜ˆ: FP2025001" required></div>
                        <div class="form-group"><label>ë¹„ë°€ë²ˆí˜¸ (ì´ˆê¸°ê°’)</label><input type="text" id="newUserPw" class="form-control" value="1234" required></div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>íšŒì› ìœ í˜• (ë³¸ì‚¬ ì§€ì •)</label>
                            <select id="newUserType" class="form-control">
                                <option value="inner">ì´ë„ˆ</option>
                                <option value="branch">ì§€ì‚¬ì¥</option>
                                <option value="consultant_home">ì»¨í™ˆ</option>
                                <option value="non_member">ë¹„íšŒì›</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>ê°€ì…ë¹„ ì…ê¸ˆ í™•ì¸</label>
                            <select id="regFeeStatus" class="form-control" style="font-weight:bold;">
                                <option value="unpaid" selected style="color:red;">ë¯¸ì…ê¸ˆ (Default)</option>
                                <option value="paid" style="color:green;">ì…ê¸ˆì™„ë£Œ (10,000ì›)</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group"><label>ì›” ì •ê¸°ê²°ì œ ê¸ˆì•¡</label><input type="number" id="newUserFee" class="form-control" value="10000"></div>
                </div>

                <div class="flex-between" style="margin-top:1rem;">
                    <button type="button" class="btn btn-outline" onclick="document.getElementById('registerModal').style.display='none'">ì·¨ì†Œ</button>
                    <button type="submit" class="btn btn-primary">ìŠ¹ì¸ ë° ìƒì„±</button>
                </div>
            </form>
        </div>
    </div>

    <!-- ê³µì§€ì‚¬í•­ ëª¨ë‹¬ -->
    <div id="noticeModal" class="modal">
        <div class="modal-content">
            <h3>ğŸ“¢ ê³µì§€ì‚¬í•­ ë“±ë¡</h3>
            <form id="noticeForm">
                <input type="hidden" id="noticeId">
                <div class="form-group"><label>ì œëª©</label><input type="text" id="noticeTitle" class="form-control"></div>
                <div class="form-group"><label>ë‚´ìš©</label><div class="editor-container"><div class="editor-toolbar"><button type="button" onclick="execCmd('bold')"><b>B</b></button></div><div id="noticeEditor" class="editor-content" contenteditable="true"></div></div></div>
                <div class="flex-between"><button type="button" class="btn btn-outline" onclick="document.getElementById('noticeModal').style.display='none'">ì·¨ì†Œ</button><button type="submit" class="btn btn-primary">ì €ì¥</button></div>
            </form>
        </div>
    </div>

    <script>
        document.getElementById('currentDate').innerText = new Date().toLocaleDateString();

        function switchTab(tabId) {
            document.querySelectorAll('.nav-menu .nav-link').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
            event.target.closest('.nav-link').classList.add('active');
            document.getElementById(tabId).classList.add('active');
            
            if(tabId === 'users') { renderUsers(); }
            if(tabId === 'notices') { renderNotices(); }
            if(tabId === 'suggestions') { renderSuggestions(); }
            if(tabId === 'admins') { renderAdmins(); }
            if(tabId === 'payment') { renderPaymentHistory(); renderPointLogs(); }
            if(tabId === 'terms') loadTerm('service');
        }

        function switchSubTab(element, viewId) {
            element.parentElement.querySelectorAll('.sub-nav-item').forEach(el => el.classList.remove('active'));
            element.classList.add('active');
            element.parentElement.parentElement.querySelectorAll('.sub-tab-content').forEach(el => el.classList.remove('active'));
            document.getElementById(viewId).classList.add('active');
        }

        // --- ê³µí†µ í˜ì´ì§•/ê²€ìƒ‰ ë¡œì§ (ê¸°ì¡´ ìœ ì§€) ---
        const PAGE_SIZE = 15;
        const state = { users: { page: 1, search: '' }, pending: { page: 1, search: '' }, payments: { page: 1, search: '' }, points: { page: 1, search: '' }, notices: { page: 1, search: '' }, suggestions: { page: 1, search: '' }, admins: { page: 1, search: '' } };

        function filterAndPaginate(data, stateKey) {
            const s = state[stateKey];
            const filtered = data.filter(item => { if (!s.search) return true; return Object.values(item).some(val => String(val).toLowerCase().includes(s.search.toLowerCase())); });
            const totalPages = Math.ceil(filtered.length / PAGE_SIZE) || 1;
            if (s.page > totalPages) s.page = totalPages;
            const start = (s.page - 1) * PAGE_SIZE;
            const paged = filtered.slice(start, start + PAGE_SIZE);
            return { paged, totalPages, totalCount: filtered.length };
        }

        function renderPaginationControls(containerId, stateKey, totalPages, renderFn) {
            const container = document.getElementById(containerId);
            let html = `<button class="page-btn" onclick="changePage('${stateKey}', ${state[stateKey].page - 1})" ${state[stateKey].page === 1 ? 'disabled' : ''}>Prev</button>`;
            for(let i=1; i<=totalPages; i++) { html += `<button class="page-btn ${i === state[stateKey].page ? 'active' : ''}" onclick="changePage('${stateKey}', ${i})">${i}</button>`; }
            html += `<button class="page-btn" onclick="changePage('${stateKey}', ${state[stateKey].page + 1})" ${state[stateKey].page === totalPages ? 'disabled' : ''}>Next</button>`;
            container.innerHTML = html;
            window.changePage = (key, newPage) => { if(newPage < 1 || newPage > totalPages) return; state[key].page = newPage; renderFn(); };
        }

        // --- ë°ì´í„° (ì‹œë®¬ë ˆì´ì…˜: login.htmlì˜ í•„ë“œëª… ë°˜ì˜) ---
        function generateDummy(count, generator) { return Array.from({length: count}, (_, i) => generator(i + 1)); }

        // ê°€ì… ì‹ ì²­ ë‚´ì—­ (login.htmlì— ìˆë˜ í•„ë“œ ëª¨ë‘ ë°˜ì˜: position -> title ë¡œ ë§¤í•‘)
        let pendingApps = [
            { id: 101, name: 'ë°•ì‹ ì²­', phone: '010-9999-8888', email: 'park@naver.com', company: 'í•œí™”ìƒëª…', title: 'íŒ€ì¥', region: 'ëŒ€ì „', appliedAt: '2025-11-30 10:00', type: '-', feeStatus: 'unpaid' },
            { id: 102, name: 'ìµœëŒ€ê¸°', phone: '010-7777-6666', email: 'choi@gmail.com', company: 'êµë³´ìƒëª…', title: 'FP', region: 'ê´‘ì£¼', appliedAt: '2025-11-30 11:30', type: '-', feeStatus: 'unpaid' },
            { id: 103, name: 'ì´ì‹ ê·œ', phone: '010-1234-4321', email: 'lee@daum.net', company: 'ì‚¼ì„±í™”ì¬', title: 'RC', region: 'ì„œìš¸', appliedAt: '2025-11-30 14:00', type: '-', feeStatus: 'unpaid' }
        ];

        let users = generateDummy(50, i => ({ id: i, userId: `FP2025${i.toString().padStart(3,'0')}`, name: `íšŒì›${i}`, company: 'ì‚¼ì„±ìƒëª…', jobTitle: 'FP', region: 'ì„œìš¸', email: `user${i}@test.com`, type: 'branch', phone: '010-1234-5678', feeStatus: 'paid', monthlyFee: 10000, status: 'active' }));
        let notices = generateDummy(20, i => ({ id: i, title: `ê³µì§€ì‚¬í•­ ì œëª© ${i}`, content: 'ë‚´ìš©...', date: '2025-11-28', file: '' }));
        let suggestions = generateDummy(10, i => ({ id: i, title: `ê±´ì˜ì‚¬í•­ ${i}`, writer: `íšŒì›${i}`, date: '2025-11-30', status: 'ëŒ€ê¸°' }));
        let admins = [ { id: 'admin', name: 'ìµœê³ ê´€ë¦¬ì', role: 'Super', date: '2025-01-01' } ];
        let payments = generateDummy(30, i => ({ date: '2025-11-30', userId: `FP2025${i}`, name: `íšŒì›${i}`, amount: 10000, type: 'ì •ê¸°ê²°ì œ', result: 'success' }));
        let pointLogs = generateDummy(30, i => ({ date: '2025-11-30', userId: `FP2025${i}`, name: `íšŒì›${i}`, type: 'earn', category: 'ì ë¦½', amount: 10000, balance: 10000 }));

        // --- ë Œë”ë§ í•¨ìˆ˜ë“¤ ---
        function renderUsers() {
            // ëŒ€ê¸°ì ëª©ë¡ (ì—…ë°ì´íŠ¸: ìœ í˜•/ê°€ì…ë¹„/ì´ë©”ì¼ ë“± ëª¨ë“  í•„ë“œ í‘œì‹œ)
            state.pending.search = document.getElementById('pendingSearch').value;
            const pendingRes = filterAndPaginate(pendingApps, 'pending');
            const pendingBody = document.getElementById('pendingTableBody');
            if(pendingRes.totalCount === 0) pendingBody.innerHTML = '<tr><td colspan="9" style="text-align:center;">ì‹ ì²­ ëŒ€ê¸° ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
            else pendingBody.innerHTML = pendingRes.paged.map(app => `
                <tr>
                    <td>${app.appliedAt}</td>
                    <td>${app.name}</td>
                    <td>${app.company} ${app.title}</td>
                    <td>${app.region}</td>
                    <td>${app.phone}</td>
                    <td>${app.email}</td>
                    <td><span class="badge badge-gray">${app.type || 'ë¯¸ì§€ì •'}</span></td>
                    <td><span class="badge badge-red">ë¯¸ì…ê¸ˆ</span></td>
                    <td><button class="btn btn-primary btn-sm" onclick="openIssueIdModal(${app.id})">IDë°œê¸‰</button></td>
                </tr>`).join('');
            renderPaginationControls('pendingPagination', 'pending', pendingRes.totalPages, renderUsers);

            // ì „ì²´ íšŒì› ëª©ë¡ (ê¸°ì¡´ ìœ ì§€)
            state.users.search = document.getElementById('userSearch').value;
            const userRes = filterAndPaginate(users, 'users');
            const userBody = document.getElementById('userTableBody');
            userBody.innerHTML = userRes.paged.map((u) => {
                const feeBadge = u.feeStatus === 'paid' ? '<span class="badge badge-green">ë‚©ë¶€</span>' : '<span class="badge badge-red">ë¯¸ë‚©</span>';
                const typeMap = {'inner': 'ì´ë„ˆ', 'branch': 'ì§€ì‚¬ì¥', 'consultant_home': 'ì»¨í™ˆ', 'non_member': 'ë¹„íšŒì›', 'general': 'ì¼ë°˜'}; // ë§¤í•‘
                return `<tr>
                    <td>${u.id}</td>
                    <td class="clickable-cell">${u.userId}</td>
                    <td>${u.name}</td>
                    <td>${u.company} ${u.jobTitle}</td>
                    <td>${u.region}</td>
                    <td><span class="badge badge-gray">${typeMap[u.type] || u.type}</span></td>
                    <td>${u.phone}<br><span style="color:#888;font-size:0.8rem">${u.email}</span></td>
                    <td>${feeBadge}</td>
                    <td style="font-weight:bold; color:var(--accent-color);">${u.monthlyFee.toLocaleString()}</td>
                    <td><span class="badge badge-green">${u.status}</span></td>
                    <td><button class="btn btn-outline btn-sm">ê´€ë¦¬</button></td>
                </tr>`;
            }).join('');
            renderPaginationControls('userPagination', 'users', userRes.totalPages, renderUsers);
        }

        // --- ìŠ¹ì¸ ë° ë“±ë¡ ë¡œì§ (ê¸°ì¡´ ìœ ì§€) ---
        function openIssueIdModal(appId) {
            const app = pendingApps.find(a => a.id === appId);
            if(!app) return;

            // ì‹ ì²­ ì •ë³´ ìë™ ì…ë ¥ (Readonly)
            document.getElementById('newUserName').value = app.name;
            document.getElementById('newUserPhone').value = app.phone;
            document.getElementById('newUserEmail').value = app.email;
            document.getElementById('newUserRegion').value = app.region;
            document.getElementById('newUserCompany').value = app.company;
            document.getElementById('newUserTitle').value = app.title;
            
            // ê´€ë¦¬ì ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
            document.getElementById('newUserId').value = ''; 
            document.getElementById('newUserPw').value = '1234';
            document.getElementById('newUserType').value = 'inner'; 
            document.getElementById('regFeeStatus').value = 'unpaid'; 
            
            document.getElementById('registerForm').dataset.appId = appId;
            document.getElementById('registerModal').style.display = 'flex';
        }

        // ìˆ˜ë™ ë“±ë¡ (ì‹ ì²­ ë‚´ì—­ ì—†ì´)
        function openRegisterModal() {
            document.getElementById('registerForm').reset();
            document.querySelectorAll('#registerForm input[readonly]').forEach(el => {
                el.removeAttribute('readonly');
                el.style.background = 'white';
            });
            delete document.getElementById('registerForm').dataset.appId;
            document.getElementById('registerModal').style.display = 'flex';
        }

        document.getElementById('registerForm').addEventListener('submit', function(e){
            e.preventDefault();
            const appId = this.dataset.appId ? parseInt(this.dataset.appId) : null;
            
            const newUser = {
                id: users.length+1, 
                userId: document.getElementById('newUserId').value,
                name: document.getElementById('newUserName').value, 
                phone: document.getElementById('newUserPhone').value,
                email: document.getElementById('newUserEmail').value,
                region: document.getElementById('newUserRegion').value,
                company: document.getElementById('newUserCompany').value, 
                jobTitle: document.getElementById('newUserTitle').value,
                type: document.getElementById('newUserType').value, 
                monthlyFee: parseInt(document.getElementById('newUserFee').value),
                feeStatus: document.getElementById('regFeeStatus').value, 
                status: 'active'
            };
            
            users.unshift(newUser); 

            if(appId) {
                pendingApps = pendingApps.filter(a => a.id !== appId);
            }

            renderUsers();
            document.getElementById('registerModal').style.display='none';
            alert('íšŒì› ê³„ì •ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.');
        });

        // --- ê¸°íƒ€ ë Œë”ë§ í•¨ìˆ˜ë“¤ ---
        function renderNotices() {
            state.notices.search = document.getElementById('noticeSearch').value;
            const res = filterAndPaginate(notices, 'notices');
            document.getElementById('noticeTableBody').innerHTML = res.paged.map(n => `<tr><td>${n.id}</td><td style="font-weight:600; cursor:pointer;" onclick="openEditNotice(${n.id})">${n.title}</td><td>${n.date}</td><td>${n.file?n.file:'-'}</td><td><button class="btn btn-outline btn-sm" onclick="openEditNotice(${n.id})">ìˆ˜ì •</button></td></tr>`).join('');
            renderPaginationControls('noticePagination', 'notices', res.totalPages, renderNotices);
        }
        function renderSuggestions() {
            state.suggestions.search = document.getElementById('suggestionSearch').value;
            const res = filterAndPaginate(suggestions, 'suggestions');
            document.getElementById('suggestionTableBody').innerHTML = res.paged.map(s => `<tr><td>${s.id}</td><td>${s.title}</td><td>${s.writer}</td><td>${s.date}</td><td><span class="badge badge-warning">${s.status}</span></td><td><button class="btn btn-outline btn-sm">ë³´ê¸°</button></td></tr>`).join('');
            renderPaginationControls('suggestionPagination', 'suggestions', res.totalPages, renderSuggestions);
        }
        function renderAdmins() {
            state.admins.search = document.getElementById('adminSearch').value;
            const res = filterAndPaginate(admins, 'admins');
            document.getElementById('adminTableBody').innerHTML = res.paged.map(a => `<tr><td>${a.id}</td><td>${a.name}</td><td>${a.role}</td><td>-</td></tr>`).join('');
            renderPaginationControls('adminPagination', 'admins', res.totalPages, renderAdmins);
        }
        function renderPaymentHistory() {
            state.payments.search = document.getElementById('paymentSearch').value;
            const res = filterAndPaginate(payments, 'payments');
            document.getElementById('paymentHistoryBody').innerHTML = res.paged.map(p => `<tr><td>${p.date}</td><td>${p.userId}</td><td>${p.name}</td><td>${p.amount.toLocaleString()}</td><td>${p.type}</td><td>${p.result}</td></tr>`).join('');
            renderPaginationControls('paymentPagination', 'payments', res.totalPages, renderPaymentHistory);
        }
        function renderPointLogs() {
            state.points.search = document.getElementById('pointSearch').value;
            const res = filterAndPaginate(pointLogs, 'points');
            document.getElementById('pointLogsBody').innerHTML = res.paged.map(l => `<tr><td>${l.date}</td><td>${l.userId}</td><td>${l.name}</td><td>${l.type}</td><td>${l.category}</td><td>${l.amount}</td><td>${l.balance}</td></tr>`).join('');
            renderPaginationControls('pointPagination', 'points', res.totalPages, renderPointLogs);
        }

        // --- ê¸°íƒ€ ê³µí†µ ë¡œì§ ---
        function openNoticeModal() { document.getElementById('noticeModal').style.display='flex'; }
        function openEditNotice(id) { document.getElementById('noticeModal').style.display='flex'; }
        function execCmd(cmd) { document.execCommand(cmd, false, null); }
        function runBatchSimulation() { alert('ì¼ê´„ ê²°ì œ ì‹¤í–‰'); }
        function loadTerm(t) { document.getElementById('termEditor').value = t + ' ë‚´ìš©...'; }
        function saveTerms() { alert('ì €ì¥ë¨'); }

        window.onload = function() {
            renderUsers();
        }
    </script>
</body>
</html>