<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>ê¸°ì—… ì§€ì›ì‚¬ì—… AI ë§¤ì¹­ - KFPC</title>
  
  <!-- CryptoJS for AES-256 encryption -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
  
  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
  
  <!-- Google API for Drive -->
  <script src="https://apis.google.com/js/api.js"></script>
  
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Noto Sans KR', sans-serif;
      background: linear-gradient(135deg, #0c2c54 0%, #2a5a8a 100%);
      color: #fff;
      min-height: 100vh;
      -webkit-overflow-scrolling: touch;
    }
    
    .loading-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #0c2c54 0%, #2a5a8a 100%);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      transition: opacity 0.3s;
    }
    
    .loading-screen.hide {
      opacity: 0;
      pointer-events: none;
    }
    
    .loader {
      width: 50px;
      height: 50px;
      border: 4px solid rgba(255,255,255,0.3);
      border-top-color: #FF8802;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    .loading-text {
      margin-top: 1rem;
      font-size: 1.1rem;
    }
    
    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 1.5rem;
    }
    
    .header {
      position: relative;
      text-align: center;
      margin-bottom: 2rem;
      padding-bottom: 1.5rem;
      border-bottom: 2px solid rgba(255,255,255,0.2);
    }
    
    .header h1 {
      font-size: 2rem;
      margin-bottom: 0.5rem;
    }
    
    .btn-main {
      position: absolute;
      top: 0;
      right: 0;
      padding: 0.75rem 1.25rem;
      border-radius: 10px;
      border: none;
      background: rgba(255,255,255,0.2);
      color: white;
      font-size: 1rem;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.2s;
      border: 1px solid rgba(255,255,255,0.3);
    }
    
    .btn-main:hover {
      background: rgba(255,255,255,0.3);
    }
    
    .required-notice {
      background: rgba(255, 136, 2, 0.2);
      border: 2px solid #FF8802;
      border-radius: 12px;
      padding: 1rem 1.5rem;
      margin-bottom: 2rem;
      text-align: center;
      font-size: 1rem;
    }
    
    .required-notice strong {
      color: #FFD700;
      font-size: 1.1rem;
    }
    
    .btn {
      padding: 0.875rem 1.5rem;
      border-radius: 12px;
      border: none;
      font-size: 1rem;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.2s;
      min-height: 48px;
      user-select: none;
    }
    
    .btn:active {
      transform: translateY(1px);
    }
    
    .btn-primary {
      background: linear-gradient(135deg, #FF8802 0%, #FF6B00 100%);
      color: white;
      box-shadow: 0 4px 12px rgba(255,136,2,0.3);
    }
    
    .btn-secondary {
      background: rgba(255,255,255,0.15);
      color: white;
      border: 1px solid rgba(255,255,255,0.3);
    }
    
    .card {
      background: rgba(255,255,255,0.12);
      border-radius: 16px;
      padding: 1.5rem;
      margin-bottom: 1.5rem;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255,255,255,0.2);
    }
    
    .card h2 {
      font-size: 1.3rem;
      margin-bottom: 1.25rem;
      color: #ffd27f;
      padding-bottom: 0.75rem;
      border-bottom: 2px solid rgba(255,255,255,0.2);
    }
    
    .card h3 {
      font-size: 1.1rem;
      margin: 1.5rem 0 1rem 0;
      color: #ffd27f;
      padding-bottom: 0.5rem;
      border-bottom: 1px solid rgba(255,255,255,0.15);
    }
    
    .form-grid {
      display: grid;
      gap: 1rem;
      grid-template-columns: 1fr;
    }
    
    @media (min-width: 480px) {
      .form-grid {
        grid-template-columns: repeat(2, 1fr);
      }
      .form-grid .full-width {
        grid-column: 1 / -1;
      }
    }
    
    @media (min-width: 1024px) {
      .form-grid {
        grid-template-columns: repeat(3, 1fr);
      }
    }
    
    .form-group {
      display: flex;
      flex-direction: column;
    }
    
    .form-group label {
      font-size: 0.9rem;
      font-weight: 600;
      margin-bottom: 0.5rem;
      color: #ffd27f;
    }
    
    .required {
      color: #FF8802;
      font-weight: 700;
    }
    
    .form-group input,
    .form-group select,
    .form-group textarea {
      width: 100%;
      padding: 0.875rem;
      border-radius: 10px;
      border: 1px solid rgba(255,255,255,0.3);
      background: rgba(255,255,255,0.95);
      color: #333;
      font-size: 16px;
      -webkit-appearance: none;
      appearance: none;
    }
    
    .form-group select {
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23333' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 0.875rem center;
      padding-right: 2.5rem;
    }
    
    .form-group input:focus,
    .form-group select:focus,
    .form-group textarea:focus {
      outline: none;
      border-color: #FF8802;
      box-shadow: 0 0 0 3px rgba(255, 136, 2, 0.2);
    }
    
    .form-group textarea {
      min-height: 80px;
      resize: vertical;
      font-family: inherit;
    }
    
    .checkbox-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
      gap: 0.75rem;
    }
    
    .checkbox-item {
      display: flex;
      align-items: center;
      padding: 0.75rem;
      background: rgba(255,255,255,0.1);
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.2s;
      min-height: 48px;
    }
    
    .checkbox-item:active {
      background: rgba(255,255,255,0.2);
    }
    
    .checkbox-item input[type="checkbox"],
    .checkbox-item input[type="radio"] {
      width: 20px;
      height: 20px;
      margin-right: 0.5rem;
      cursor: pointer;
      -webkit-appearance: none;
      appearance: none;
      background: rgba(255,255,255,0.9);
      border: 2px solid rgba(255,255,255,0.5);
      border-radius: 4px;
      position: relative;
    }
    
    .checkbox-item input[type="radio"] {
      border-radius: 50%;
    }
    
    .checkbox-item input:checked {
      background: #FF8802;
      border-color: #FF8802;
    }
    
    .checkbox-item input:checked::after {
      content: 'âœ“';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: white;
      font-size: 14px;
      font-weight: bold;
    }
    
    .checkbox-item label {
      font-size: 0.9rem;
      cursor: pointer;
      margin: 0;
      color: #fff;
    }
    
    .loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(12, 44, 84, 0.95);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 10000;
    }
    
    .loading-overlay .loader {
      width: 60px;
      height: 60px;
    }
    
    .loading-overlay h2 {
      margin-top: 1.5rem;
      font-size: 1.3rem;
    }
    
    .loading-overlay p {
      margin-top: 0.5rem;
      font-size: 1rem;
      opacity: 0.8;
    }
    
    .result-card {
      background: rgba(255,255,255,0.95);
      color: #333;
      border-radius: 16px;
      padding: 1.5rem;
      margin-bottom: 1rem;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    
    .result-card .rank {
      display: inline-block;
      background: linear-gradient(135deg, #FF8802 0%, #FF6B00 100%);
      color: white;
      padding: 0.3rem 0.875rem;
      border-radius: 20px;
      font-size: 0.9rem;
      font-weight: 700;
      margin-bottom: 0.75rem;
    }
    
    .result-card h3 {
      font-size: 1.2rem;
      color: #0c2c54;
      margin-bottom: 0.5rem;
      line-height: 1.4;
      border: none;
      padding: 0;
    }
    
    .match-score {
      display: inline-block;
      background: #4CAF50;
      color: white;
      padding: 0.4rem 0.95rem;
      border-radius: 20px;
      font-weight: 700;
      margin-bottom: 1rem;
      font-size: 0.95rem;
    }
    
    .info-text {
      font-size: 0.85rem;
      color: rgba(255,255,255,0.7);
      margin-top: 0.25rem;
      font-style: italic;
    }
    
    @media (max-width: 479px) {
      .container {
        padding: 1rem;
      }
      .header h1 {
        font-size: 1.6rem;
        padding-right: 80px;
      }
      .btn-main {
        padding: 0.6rem 1rem;
        font-size: 0.9rem;
      }
      .card {
        padding: 1.25rem;
      }
    }
  </style>
</head>
<body>
  <div class="loading-screen" id="loading-screen">
    <div class="loader"></div>
    <div class="loading-text">ì•± ë¡œë”© ì¤‘...</div>
  </div>

  <!-- Google ë¡œê·¸ì¸ í™”ë©´ -->
  <div id="login-screen" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(135deg, #0c2c54 0%, #2a5a8a 100%); z-index: 9999; display: flex; align-items: center; justify-content: center;">
    <div style="background: white; padding: 3rem; border-radius: 20px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); text-align: center; max-width: 400px; width: 90%;">
      <div style="font-size: 4rem; margin-bottom: 1rem;">ğŸ¢</div>
      <h2 style="color: #0c2c54; margin-bottom: 0.5rem; font-size: 1.8rem;">ê¸°ì—… ì§€ì›ì‚¬ì—… AI ë§¤ì¹­</h2>
      <p style="color: #666; margin-bottom: 2rem; font-size: 0.95rem;">êµ¬ê¸€ ë“œë¼ì´ë¸Œì— ì•ˆì „í•˜ê²Œ ì €ì¥ë©ë‹ˆë‹¤</p>
      
      <button id="google-signin-btn" onclick="signInWithGoogle()" style="
        width: 100%;
        padding: 1rem;
        background: white;
        border: 2px solid #ddd;
        border-radius: 8px;
        font-size: 1rem;
        font-weight: 600;
        color: #333;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.75rem;
        transition: all 0.2s;
      " onmouseover="this.style.boxShadow='0 4px 12px rgba(0,0,0,0.15)'" onmouseout="this.style.boxShadow='none'">
        <svg width="20" height="20" viewBox="0 0 24 24">
          <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
          <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
          <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
          <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
        </svg>
        Google ê³„ì •ìœ¼ë¡œ ì‹œì‘í•˜ê¸°
      </button>
      
      <div style="margin-top: 2rem; padding: 1rem; background: #f8f9fa; border-radius: 8px; text-align: left; font-size: 0.85rem; color: #666;">
        <div style="font-weight: 600; margin-bottom: 0.5rem; color: #0c2c54;">ğŸ”’ ì •ë³´ë³´í˜¸</div>
        <div style="line-height: 1.6;">
          â€¢ ë°ì´í„°ëŠ” ì‚¬ìš©ìì˜ êµ¬ê¸€ ë“œë¼ì´ë¸Œì— ì•”í˜¸í™” ì €ì¥<br>
          â€¢ ì–¸ì œë“  ìˆ˜ì •/ì‚­ì œ ê°€ëŠ¥
        </div>
      </div>
    </div>
  </div>

  <div class="container" id="main-content" style="display: none;">
    <div class="header">
      <h1>ğŸ¢ ê¸°ì—… ì§€ì›ì‚¬ì—… AI ë§¤ì¹­</h1>
      <div style="display: flex; align-items: center; gap: 1rem;">
        <div id="user-info" style="font-size: 0.9rem; color: #ddd;"></div>
        <button class="btn-main" onclick="signOut()" style="background: rgba(255,255,255,0.2); border: 1px solid rgba(255,255,255,0.3);">ë¡œê·¸ì•„ì›ƒ</button>
        <button class="btn-main" onclick="goHome()">ë©”ì¸</button>
      </div>
    </div>

    <div class="required-notice">
      <strong>* í‘œì‹œ í•­ëª©ì€ í•„ìˆ˜ ì…ë ¥ ì‚¬í•­ì…ë‹ˆë‹¤</strong>
    </div>

    <!-- 1. ê³ ê°ì‚¬ ì„ íƒ -->
    <div class="card">
      <h2>1. ê³ ê°ì‚¬ ì„ íƒ</h2>
      <div class="form-grid">
        <div class="form-group full-width">
          <label>ì €ì¥ëœ ê³ ê°ì‚¬</label>
          <select id="company-select" onchange="loadSelectedCompany()">
            <option value="">-- ìƒˆë¡œ ì…ë ¥ --</option>
          </select>
        </div>
      </div>
      <button class="btn btn-secondary" onclick="clearForm()" style="margin-top: 1rem;">
        ğŸ”„ ìƒˆë¡œ ì…ë ¥
      </button>
    </div>

    <!-- Section 1: ê¸°ì—… ê¸°ë³¸ì •ë³´ -->
    <div class="card">
      <h2>Section 1. ê¸°ì—… ê¸°ë³¸ì •ë³´</h2>
      
      <h3>1-1. ê¸°ì—… ì‹ë³„ì •ë³´</h3>
      <div class="form-grid">
        <div class="form-group full-width">
          <label>ê¸°ì—…ëª… <span class="required">*</span></label>
          <input type="text" id="company-name" placeholder="ìƒí˜¸ëª…ì„ ì •í™•íˆ ì…ë ¥" required>
        </div>
        
        <div class="form-group">
          <label>ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸ <span class="required">*</span></label>
          <div style="display: flex; align-items: center; gap: 0.5rem;">
            <input type="text" id="business-number-1" placeholder="000" maxlength="3" style="width: 80px;" inputmode="numeric" required oninput="moveFocusOnMaxLength(this, 'business-number-2', 3)">
            <span style="color: #ddd;">-</span>
            <input type="text" id="business-number-2" placeholder="00" maxlength="2" style="width: 60px;" inputmode="numeric" required oninput="moveFocusOnMaxLength(this, 'business-number-3', 2)">
            <span style="color: #ddd;">-</span>
            <input type="text" id="business-number-3" placeholder="00000" maxlength="5" style="width: 100px;" inputmode="numeric" required>
          </div>
          <span class="info-text">API ìë™ì¡°íšŒ í‚¤</span>
        </div>
        
        <div class="form-group">
          <label>ë²•ì¸ë“±ë¡ë²ˆí˜¸</label>
          <div style="display: flex; align-items: center; gap: 0.5rem;">
            <input type="text" id="corp-number-1" placeholder="000000" maxlength="6" style="width: 100px;" inputmode="numeric" oninput="moveFocusOnMaxLength(this, 'corp-number-2', 6)">
            <span style="color: #ddd;">-</span>
            <input type="text" id="corp-number-2" placeholder="0000000" maxlength="7" style="width: 120px;" inputmode="numeric">
          </div>
          <span class="info-text">ë²•ì¸ì¸ ê²½ìš° í•„ìˆ˜</span>
        </div>
        
        <div class="form-group">
          <label>ê°œì—…ì—°ì›”ì¼(ì‚¬ì—…ìë“±ë¡ì¦) <span class="required">*</span></label>
          <input type="date" id="establish-date" required>
          <span class="info-text">ì…ë ¥ ì‹œ ì—…ë ¥ ìë™ ê³„ì‚°ë¨</span>
        </div>
      </div>
      
      <h3>1-2. ê¸°ì—… ë¶„ë¥˜</h3>
      <div class="form-grid">
        <div class="form-group">
          <label>ê¸°ì—… ê·œëª¨ <span class="required">*</span></label>
          <select id="company-size" required>
            <option value="">ì„ íƒí•˜ì„¸ìš”</option>
            <option value="ì˜ˆë¹„ì°½ì—…ì">ì˜ˆë¹„ì°½ì—…ì</option>
            <option value="ì†Œìƒê³µì¸">ì†Œìƒê³µì¸</option>
            <option value="ì†Œê¸°ì—…">ì†Œê¸°ì—…</option>
            <option value="ì¤‘ê¸°ì—…">ì¤‘ê¸°ì—…</option>
            <option value="ì¤‘ê²¬ê¸°ì—…">ì¤‘ê²¬ê¸°ì—…</option>
            <option value="ëŒ€ê¸°ì—…">ëŒ€ê¸°ì—…</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>ê¸°ì—… í˜•íƒœ <span class="required">*</span></label>
          <select id="company-type" required>
            <option value="">ì„ íƒí•˜ì„¸ìš”</option>
            <option value="ê°œì¸ì‚¬ì—…ì">ê°œì¸ì‚¬ì—…ì</option>
            <option value="ë²•ì¸(ì£¼ì‹)">ë²•ì¸(ì£¼ì‹íšŒì‚¬)</option>
            <option value="ë²•ì¸(ìœ í•œ)">ë²•ì¸(ìœ í•œíšŒì‚¬)</option>
            <option value="í˜‘ë™ì¡°í•©">í˜‘ë™ì¡°í•©</option>
            <option value="ì‚¬íšŒì ê¸°ì—…">ì‚¬íšŒì ê¸°ì—…</option>
            <option value="ì†Œì…œë²¤ì²˜">ì†Œì…œë²¤ì²˜</option>
            <option value="ë¹„ì˜ë¦¬">ë¹„ì˜ë¦¬ë²•ì¸</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>ì—…ì¢…(KSIC ì½”ë“œ) <span class="required">*</span></label>
          <input type="text" id="ksic-code" placeholder="6ìë¦¬ í‘œì¤€ì‚°ì—…ë¶„ë¥˜" maxlength="6" required>
        </div>
        
        <div class="form-group full-width">
          <label>ì£¼ë ¥ ì œí’ˆ/ì„œë¹„ìŠ¤ í‚¤ì›Œë“œ</label>
          <input type="text" id="product-keywords" placeholder="í‚¤ì›Œë“œ 3ê°œ ì´ë‚´ (ì˜ˆ: AIì±—ë´‡, ê³ ê°ê´€ë¦¬SW, í´ë¼ìš°ë“œ)">
        </div>
      </div>
      
      <h3>1-3. ì‚¬ì—…ì¥ ì •ë³´</h3>
      <div class="form-grid">
        <div class="form-group">
          <label>ë³¸ì  ì†Œì¬ì§€ (ì‹œë„) <span class="required">*</span></label>
          <select id="location-sido" required>
            <option value="">ì„ íƒí•˜ì„¸ìš”</option>
            <option value="ì„œìš¸">ì„œìš¸</option>
            <option value="ê²½ê¸°">ê²½ê¸°</option>
            <option value="ì¸ì²œ">ì¸ì²œ</option>
            <option value="ë¶€ì‚°">ë¶€ì‚°</option>
            <option value="ëŒ€êµ¬">ëŒ€êµ¬</option>
            <option value="ëŒ€ì „">ëŒ€ì „</option>
            <option value="ê´‘ì£¼">ê´‘ì£¼</option>
            <option value="ìš¸ì‚°">ìš¸ì‚°</option>
            <option value="ì„¸ì¢…">ì„¸ì¢…</option>
            <option value="ê°•ì›">ê°•ì›</option>
            <option value="ì¶©ë¶">ì¶©ë¶</option>
            <option value="ì¶©ë‚¨">ì¶©ë‚¨</option>
            <option value="ì „ë¶">ì „ë¶</option>
            <option value="ì „ë‚¨">ì „ë‚¨</option>
            <option value="ê²½ë¶">ê²½ë¶</option>
            <option value="ê²½ë‚¨">ê²½ë‚¨</option>
            <option value="ì œì£¼">ì œì£¼</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>ì‹œêµ°êµ¬</label>
          <input type="text" id="location-sigungu" placeholder="ì˜ˆ: ê°•ë‚¨êµ¬">
        </div>
        
        <div class="form-group">
          <label>ì‚°ì—…ë‹¨ì§€ ì…ì£¼</label>
          <select id="industrial-complex">
            <option value="ë¯¸ì…ì£¼">ë¯¸ì…ì£¼</option>
            <option value="ì¼ë°˜ì‚°ë‹¨">ì¼ë°˜ì‚°ë‹¨</option>
            <option value="êµ­ê°€ì‚°ë‹¨">êµ­ê°€ì‚°ë‹¨</option>
            <option value="ì§€ë°©ì‚°ë‹¨">ì§€ë°©ì‚°ë‹¨</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>ìˆ˜ë„ê¶Œ ì—¬ë¶€ <span class="required">*</span></label>
          <select id="capital-area" required>
            <option value="">ì„ íƒí•˜ì„¸ìš”</option>
            <option value="Y">ì˜ˆ (ì„œìš¸/ê²½ê¸°/ì¸ì²œ)</option>
            <option value="N">ì•„ë‹ˆì˜¤ (ì§€ë°©)</option>
          </select>
        </div>
      </div>
    </div>

    <!-- Section 2: ëŒ€í‘œì ì •ë³´ -->
    <div class="card">
      <h2>Section 2. ëŒ€í‘œì ì •ë³´</h2>
      <div class="form-grid">
        <div class="form-group">
          <label>ëŒ€í‘œì ì„±ëª… <span class="required">*</span></label>
          <input type="text" id="ceo-name" required>
        </div>
        
        <div class="form-group">
          <label>ìƒë…„ì›”ì¼ <span class="required">*</span></label>
          <input type="date" id="ceo-birth" required>
          <span class="info-text">ì²­ë…„(ë§Œ39ì„¸â†“) íŒì •</span>
        </div>
        
        <div class="form-group">
          <label>ì„±ë³„ <span class="required">*</span></label>
          <select id="ceo-gender" required>
            <option value="">ì„ íƒí•˜ì„¸ìš”</option>
            <option value="ë‚¨">ë‚¨</option>
            <option value="ì—¬">ì—¬</option>
          </select>
          <span class="info-text">ì—¬ì„±ê¸°ì—… ì „ìš© íŠ¸ë™</span>
        </div>
        
        <div class="form-group">
          <label>ì¥ì• ì¸ ì—¬ë¶€</label>
          <select id="ceo-disabled">
            <option value="N">ì•„ë‹ˆì˜¤</option>
            <option value="Y">ì˜ˆ</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>êµ­ê°€ë³´í›ˆëŒ€ìƒì</label>
          <select id="ceo-veteran">
            <option value="N">ì•„ë‹ˆì˜¤</option>
            <option value="Y">ì˜ˆ</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>ë¶í•œì´íƒˆì£¼ë¯¼</label>
          <select id="ceo-defector">
            <option value="N">ì•„ë‹ˆì˜¤</option>
            <option value="Y">ì˜ˆ</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>ì¬ì°½ì—… ì—¬ë¶€</label>
          <select id="ceo-restart">
            <option value="ì´ˆì°½ì—…">ì´ˆì°½ì—…</option>
            <option value="ì¬ì°½ì—…">ì¬ì°½ì—…</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>ì—°ëŒ€ë³´ì¦ ë©´ì œ ëŒ€ìƒ</label>
          <select id="guarantee-exempt">
            <option value="N">ì•„ë‹ˆì˜¤</option>
            <option value="Y">ì˜ˆ</option>
          </select>
        </div>
      </div>
    </div>

    <!-- Section 3: ì¬ë¬´ ë° ì‹ ìš©ì •ë³´ -->
    <div class="card">
      <h2>Section 3. ì¬ë¬´ ë° ì‹ ìš©ì •ë³´</h2>
      
      <h3>3-1. ì¬ë¬´ í˜„í™© (ìµœê·¼ 3ê°œë…„)</h3>
      <div class="form-grid">
        <div class="form-group">
          <label>ë§¤ì¶œì•¡ - ìµœê·¼ë…„ë„ (ì–µì›) <span class="required">*</span></label>
          <input type="number" id="revenue-recent" placeholder="ì˜ˆ: 15" required>
        </div>
        
        <div class="form-group">
          <label>ë§¤ì¶œì•¡ - ì „ë…„ë„ (ì–µì›)</label>
          <input type="number" id="revenue-prev1" placeholder="ì˜ˆ: 12">
        </div>
        
        <div class="form-group">
          <label>ë§¤ì¶œì•¡ - ì „ì „ë…„ë„ (ì–µì›)</label>
          <input type="number" id="revenue-prev2" placeholder="ì˜ˆ: 10">
        </div>
        
        <div class="form-group">
          <label>ì˜ì—…ì´ìµ - ìµœê·¼ë…„ë„ (ì–µì›)</label>
          <input type="number" id="profit-recent" placeholder="ì˜ˆ: 2">
        </div>
        
        <div class="form-group">
          <label>ìë³¸ê¸ˆ (ì–µì›)</label>
          <input type="number" id="capital" placeholder="ì˜ˆ: 5">
        </div>
        
        <div class="form-group">
          <label>ìë³¸ì´ê³„ (ì–µì›)</label>
          <input type="number" id="total-equity" placeholder="ì˜ˆ: 8">
        </div>
        
        <div class="form-group">
          <label>ë¶€ì±„ì´ê³„ (ì–µì›)</label>
          <input type="number" id="total-debt" placeholder="ì˜ˆ: 7">
        </div>
        
        <div class="form-group">
          <label>ë¶€ì±„ë¹„ìœ¨ (%)</label>
          <input type="number" id="debt-ratio" placeholder="ì˜ˆ: 87.5">
        </div>
      </div>
      
      <h3>3-2. ê²°ê²©ì‚¬ìœ  ì²´í¬</h3>
      <div class="form-grid">
        <div class="form-group">
          <label>êµ­ì„¸ ì²´ë‚© <span class="required">*</span></label>
          <select id="tax-arrears" required>
            <option value="N">ì—†ìŒ</option>
            <option value="Y">ìˆìŒ</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>ì§€ë°©ì„¸ ì²´ë‚© <span class="required">*</span></label>
          <select id="local-tax-arrears" required>
            <option value="N">ì—†ìŒ</option>
            <option value="Y">ìˆìŒ</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>4ëŒ€ë³´í—˜ ë¯¸ë‚©/ì²´ë‚©</label>
          <select id="insurance-arrears">
            <option value="N">ì—†ìŒ</option>
            <option value="Y">ìˆìŒ</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>ì™„ì „ìë³¸ì ì‹</label>
          <select id="capital-erosion">
            <option value="N">ì•„ë‹ˆì˜¤</option>
            <option value="Y">ì˜ˆ</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>ë¶€ë„/íšŒìƒ/íŒŒì‚° ì´ë ¥</label>
          <select id="bankruptcy-history">
            <option value="N">ì—†ìŒ</option>
            <option value="Y">ìˆìŒ</option>
          </select>
        </div>
      </div>
      
      <h3>3-3. ì‹ ìš©ì •ë³´</h3>
      <div class="form-grid">
        <div class="form-group">
          <label>ê¸°ì—…ì‹ ìš©ë“±ê¸‰</label>
          <select id="credit-rating">
            <option value="">ì„ íƒí•˜ì„¸ìš”</option>
            <option value="AAA">AAA</option>
            <option value="AA">AA</option>
            <option value="A">A</option>
            <option value="BBB">BBB</option>
            <option value="BB">BB</option>
            <option value="B">B</option>
            <option value="CCC">CCC</option>
            <option value="CC">CC</option>
            <option value="C">C</option>
            <option value="D">D</option>
          </select>
          <span class="info-text">ë‚˜ì´ìŠ¤/KIS ê¸°ì¤€</span>
        </div>
        
        <div class="form-group">
          <label>ê¸°ìˆ ì‹ ìš©í‰ê°€(TCB) ë“±ê¸‰</label>
          <select id="tcb-rating">
            <option value="">ì„ íƒí•˜ì„¸ìš”</option>
            <option value="T-1">T-1</option>
            <option value="T-2">T-2</option>
            <option value="T-3">T-3</option>
            <option value="T-4">T-4</option>
            <option value="T-5">T-5</option>
            <option value="T-6">T-6</option>
            <option value="T-7">T-7</option>
            <option value="T-8">T-8</option>
            <option value="T-9">T-9</option>
            <option value="T-10">T-10</option>
          </select>
        </div>
      </div>
    </div>

    <!-- Section 4: ê³ ìš© ì •ë³´ -->
    <div class="card">
      <h2>Section 4. ê³ ìš© ì •ë³´</h2>
      
      <h3>4-1. ì¸ë ¥ í˜„í™©</h3>
      <div class="form-grid">
        <div class="form-group">
          <label>ìƒì‹œê·¼ë¡œì ìˆ˜ (ëª…) <span class="required">*</span></label>
          <input type="number" id="employees-total" placeholder="ëŒ€í‘œì ì œì™¸" required>
        </div>
        
        <div class="form-group">
          <label>ì „ë…„ë„ ê·¼ë¡œì ìˆ˜ (ëª…)</label>
          <input type="number" id="employees-prev" placeholder="ì „ë…„ë„">
        </div>
        
        <div class="form-group">
          <label>ì²­ë…„ ê³ ìš© (ë§Œ15~34ì„¸)</label>
          <input type="number" id="employees-youth" placeholder="ì²­ë…„ ì¸ì›">
          <span class="info-text">ì²­ë…„ê³ ìš© ê°€ì </span>
        </div>
        
        <div class="form-group">
          <label>ì—¬ì„± ê³ ìš©</label>
          <input type="number" id="employees-female" placeholder="ì—¬ì„± ì¸ì›">
          <span class="info-text">ì—¬ì„±ê³ ìš© ê°€ì </span>
        </div>
        
        <div class="form-group">
          <label>ì¥ì• ì¸ ê³ ìš©</label>
          <input type="number" id="employees-disabled" placeholder="ì¥ì• ì¸ ì¸ì›">
        </div>
        
        <div class="form-group">
          <label>ê³ ë ¹ì ê³ ìš© (ë§Œ60ì„¸ ì´ìƒ)</label>
          <input type="number" id="employees-senior" placeholder="ê³ ë ¹ì ì¸ì›">
        </div>
        
        <div class="form-group">
          <label>ë¹„ì •ê·œì§ ë¹„ìœ¨ (%)</label>
          <input type="number" id="irregular-ratio" placeholder="ì˜ˆ: 20">
        </div>
      </div>
      
      <h3>4-2. ì±„ìš© ê³„íš</h3>
      <div class="form-grid">
        <div class="form-group">
          <label>í–¥í›„ 6ê°œì›” ì±„ìš© ê³„íš (ëª…)</label>
          <input type="number" id="hiring-plan" placeholder="ì˜ˆì • ì¸ì›">
        </div>
        
        <div class="form-group full-width">
          <label>ìš°ì„  ì±„ìš© ë¶„ì•¼</label>
          <input type="text" id="hiring-field" placeholder="ì˜ˆ: ì—°êµ¬ê°œë°œ, ìƒì‚°, ì˜ì—…ë§ˆì¼€íŒ…">
        </div>
      </div>
    </div>

    <!-- Section 5: ê¸°ìˆ  ë° ì¸ì¦ ì •ë³´ -->
    <div class="card">
      <h2>Section 5. ê¸°ìˆ  ë° ì¸ì¦ ì •ë³´</h2>
      
      <h3>5-1. ê¸°ì—… ì¸ì¦ (ìœ íš¨ê¸°ê°„ í™•ì¸ í•„ìˆ˜)</h3>
      <div class="form-grid">
        <div class="form-group">
          <label>ë²¤ì²˜ê¸°ì—… ì¸ì¦</label>
          <select id="cert-venture">
            <option value="N">ì—†ìŒ</option>
            <option value="Y">ìˆìŒ</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>ë²¤ì²˜ê¸°ì—… ë§Œë£Œì¼</label>
          <input type="date" id="cert-venture-expire">
        </div>
        
        <div class="form-group">
          <label>ì´ë…¸ë¹„ì¦ˆ(ê¸°ìˆ í˜ì‹ )</label>
          <select id="cert-innobiz">
            <option value="N">ì—†ìŒ</option>
            <option value="Y">ìˆìŒ</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>ì´ë…¸ë¹„ì¦ˆ ë§Œë£Œì¼</label>
          <input type="date" id="cert-innobiz-expire">
        </div>
        
        <div class="form-group">
          <label>ë©”ì¸ë¹„ì¦ˆ(ê²½ì˜í˜ì‹ )</label>
          <select id="cert-mainbiz">
            <option value="N">ì—†ìŒ</option>
            <option value="Y">ìˆìŒ</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>ë©”ì¸ë¹„ì¦ˆ ë§Œë£Œì¼</label>
          <input type="date" id="cert-mainbiz-expire">
        </div>
        
        <div class="form-group">
          <label>ë…¹ìƒ‰ì¸ì¦ê¸°ì—…</label>
          <select id="cert-green">
            <option value="N">ì—†ìŒ</option>
            <option value="Y">ìˆìŒ</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>ì†Œì¬ë¶€í’ˆì¥ë¹„ ì „ë¬¸ê¸°ì—…</label>
          <select id="cert-materials">
            <option value="N">ì—†ìŒ</option>
            <option value="Y">ìˆìŒ</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>ë¿Œë¦¬ê¸°ì—…</label>
          <select id="cert-root">
            <option value="N">ì—†ìŒ</option>
            <option value="Y">ìˆìŒ</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>World Class 300</label>
          <select id="cert-worldclass">
            <option value="N">ì—†ìŒ</option>
            <option value="Y">ìˆìŒ</option>
          </select>
        </div>
      </div>
      
      <h3>5-2. ì—°êµ¬ê°œë°œ ì—­ëŸ‰</h3>
      <div class="form-grid">
        <div class="form-group">
          <label>ì—°êµ¬ì¡°ì§</label>
          <select id="research-org">
            <option value="ì—†ìŒ">ì—†ìŒ</option>
            <option value="ê¸°ì—…ë¶€ì„¤ì—°êµ¬ì†Œ">ê¸°ì—…ë¶€ì„¤ì—°êµ¬ì†Œ</option>
            <option value="ì—°êµ¬ê°œë°œì „ë‹´ë¶€ì„œ">ì—°êµ¬ê°œë°œì „ë‹´ë¶€ì„œ</option>
          </select>
          <span class="info-text">ê¸°ìˆ ê°œë°œì‚¬ì—… í•„ìˆ˜</span>
        </div>
        
        <div class="form-group">
          <label>ì „ë‹´ ì—°êµ¬ì› (ëª…)</label>
          <input type="number" id="researchers" placeholder="ì—°êµ¬ì¸ë ¥">
        </div>
        
        <div class="form-group">
          <label>R&D íˆ¬ìì•¡ (ì–µì›)</label>
          <input type="number" id="rd-investment" placeholder="ìµœê·¼ë…„ë„">
        </div>
        
        <div class="form-group">
          <label>R&D íˆ¬ì ë¹„ìœ¨ (%)</label>
          <input type="number" id="rd-ratio" placeholder="ë§¤ì¶œ ëŒ€ë¹„">
        </div>
        
        <div class="form-group">
          <label>íŠ¹í—ˆ ë“±ë¡ (ê±´)</label>
          <input type="number" id="patents-registered" placeholder="ë“±ë¡">
        </div>
        
        <div class="form-group">
          <label>íŠ¹í—ˆ ì¶œì› (ê±´)</label>
          <input type="number" id="patents-applied" placeholder="ì¶œì›">
        </div>
        
        <div class="form-group">
          <label>ìƒí‘œê¶Œ ë“±ë¡ (ê±´)</label>
          <input type="number" id="trademarks" placeholder="ìƒí‘œê¶Œ">
        </div>
        
        <div class="form-group">
          <label>ê¸°ìˆ ì´ì „ ê²½í—˜</label>
          <select id="tech-transfer">
            <option value="N">ì—†ìŒ</option>
            <option value="Y">ìˆìŒ</option>
          </select>
        </div>
      </div>
      
      <h3>5-3. ìƒì‚° ë° í’ˆì§ˆ ì¸ì¦</h3>
      <div class="checkbox-grid">
        <div class="checkbox-item">
          <input type="checkbox" id="iso-9001" value="ISO9001">
          <label for="iso-9001">ISO 9001 (í’ˆì§ˆ)</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="iso-14001" value="ISO14001">
          <label for="iso-14001">ISO 14001 (í™˜ê²½)</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="iso-45001" value="ISO45001">
          <label for="iso-45001">ISO 45001 (ì•ˆì „)</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="cert-gmp" value="GMP">
          <label for="cert-gmp">GMP</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="cert-kc" value="KC/KS">
          <label for="cert-kc">KC/KS ì¸ì¦</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="cert-haccp" value="HACCP">
          <label for="cert-haccp">HACCP</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="cert-fda" value="FDA">
          <label for="cert-fda">FDA</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="cert-ce" value="CE">
          <label for="cert-ce">CE</label>
        </div>
      </div>
      
      <h3>5-4. ESG ë° ìŠ¤ë§ˆíŠ¸í™”</h3>
      <div class="form-grid">
        <div class="form-group">
          <label>ESG í‰ê°€ë“±ê¸‰</label>
          <select id="esg-rating">
            <option value="ë¯¸í‰ê°€">ë¯¸í‰ê°€</option>
            <option value="S">S</option>
            <option value="A">A</option>
            <option value="B">B</option>
            <option value="C">C</option>
            <option value="D">D</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>íƒ„ì†Œì¤‘ë¦½ ì„ ì–¸/ì´í–‰</label>
          <select id="carbon-neutral">
            <option value="N">ì•„ë‹ˆì˜¤</option>
            <option value="Y">ì˜ˆ</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>ìŠ¤ë§ˆíŠ¸ê³µì¥ ìˆ˜ì¤€</label>
          <select id="smart-factory">
            <option value="Level0">Level 0 (ë¯¸êµ¬ì¶•)</option>
            <option value="Level1">Level 1 (ê¸°ì´ˆ)</option>
            <option value="Level2">Level 2 (ì¤‘ê°„1)</option>
            <option value="Level3">Level 3 (ì¤‘ê°„2)</option>
            <option value="Level4">Level 4 (ê³ ë„í™”)</option>
            <option value="Level5">Level 5 (ìµœê³ )</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>ë””ì§€í„¸ì „í™˜(DX) ë‹¨ê³„</label>
          <select id="digital-transform">
            <option value="ê´€ì‹¬">ê´€ì‹¬</option>
            <option value="ë„ì…">ë„ì…</option>
            <option value="í™•ì‚°">í™•ì‚°</option>
            <option value="ê³ ë„í™”">ê³ ë„í™”</option>
          </select>
        </div>
      </div>
    </div>

    <!-- Section 6: ìˆ˜ì¶œ ë° í•´ì™¸ì§„ì¶œ -->
    <div class="card">
      <h2>Section 6. ìˆ˜ì¶œ ë° í•´ì™¸ì§„ì¶œ</h2>
      <div class="form-grid">
        <div class="form-group">
          <label>ìˆ˜ì¶œ ì‹¤ì  - ìµœê·¼ë…„ë„ ($)</label>
          <input type="number" id="export-recent" placeholder="ì˜ˆ: 100000">
        </div>
        
        <div class="form-group">
          <label>ìˆ˜ì¶œ ì‹¤ì  - ì „ë…„ë„ ($)</label>
          <input type="number" id="export-prev" placeholder="ì˜ˆ: 80000">
        </div>
        
        <div class="form-group full-width">
          <label>ì£¼ìš” ìˆ˜ì¶œêµ­</label>
          <input type="text" id="export-countries" placeholder="ë§¤ì¶œë¹„ì¤‘ ìƒìœ„ 3ê°œêµ­ (ì˜ˆ: ë¯¸êµ­, ì¤‘êµ­, ì¼ë³¸)">
        </div>
        
        <div class="form-group">
          <label>HS CODE (ì£¼ë ¥ ìˆ˜ì¶œí’ˆëª©)</label>
          <input type="text" id="hs-code" placeholder="6~10ìë¦¬">
        </div>
        
        <div class="form-group full-width">
          <label>í•´ì™¸ ì¸ì¦</label>
          <input type="text" id="overseas-cert" placeholder="ì˜ˆ: FDA, CE, UL, JIS">
        </div>
        
        <div class="form-group">
          <label>í•´ì™¸ ë²•ì¸/ì§€ì‚¬</label>
          <select id="overseas-office">
            <option value="N">ì—†ìŒ</option>
            <option value="Y">ìˆìŒ</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>í•´ì™¸ ë²•ì¸ êµ­ê°€</label>
          <input type="text" id="overseas-country" placeholder="êµ­ê°€ëª…">
        </div>
        
        <div class="form-group">
          <label>FTA í™œìš©</label>
          <select id="fta-use">
            <option value="N">ì•„ë‹ˆì˜¤</option>
            <option value="Y">ì˜ˆ</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>ìˆ˜ì¶œë°”ìš°ì²˜ ì´ìš© ê²½í—˜</label>
          <select id="export-voucher">
            <option value="N">ì—†ìŒ</option>
            <option value="Y">ìˆìŒ</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>í•´ì™¸ì „ì‹œíšŒ ì°¸ê°€ (ìµœê·¼ 3ë…„)</label>
          <input type="number" id="overseas-exhibition" placeholder="ì°¸ê°€ íšŸìˆ˜">
        </div>
      </div>
    </div>

    <!-- Section 7: ì •ë¶€ì§€ì› ì´ë ¥ -->
    <div class="card">
      <h2>Section 7. ì •ë¶€ì§€ì› ì´ë ¥</h2>
      
      <h3>7-1. ìµœê·¼ 3ë…„ ì§€ì›ì‚¬ì—… ì´ë ¥</h3>
      <div class="form-grid">
        <div class="form-group full-width">
          <label>2024ë…„ ì§€ì›ì‚¬ì—…</label>
          <textarea id="support-2024" placeholder="ì‚¬ì—…ëª…, ì§€ì›ê¸°ê´€, ê¸ˆì•¡ (ì˜ˆ: ê¸°ìˆ ê°œë°œì‚¬ì—…, ì¤‘ì†Œë²¤ì²˜ê¸°ì—…ë¶€, 5ì²œë§Œì›)"></textarea>
        </div>
        
        <div class="form-group full-width">
          <label>2023ë…„ ì§€ì›ì‚¬ì—…</label>
          <textarea id="support-2023" placeholder="ì‚¬ì—…ëª…, ì§€ì›ê¸°ê´€, ê¸ˆì•¡"></textarea>
        </div>
        
        <div class="form-group full-width">
          <label>2022ë…„ ì§€ì›ì‚¬ì—…</label>
          <textarea id="support-2022" placeholder="ì‚¬ì—…ëª…, ì§€ì›ê¸°ê´€, ê¸ˆì•¡"></textarea>
        </div>
      </div>
      
      <h3>7-2. ì œì¬/ë¶ˆì´ìµ ì´ë ¥</h3>
      <div class="form-grid">
        <div class="form-group">
          <label>ì •ë¶€ì‚¬ì—… ì¤‘ë„í¬ê¸°</label>
          <select id="project-abandon">
            <option value="N">ì—†ìŒ</option>
            <option value="Y">ìˆìŒ</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>ì •ë¶€ì‚¬ì—… í™˜ìˆ˜ ì¡°ì¹˜</label>
          <select id="subsidy-return">
            <option value="N">ì—†ìŒ</option>
            <option value="Y">ìˆìŒ</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>ì°¸ì—¬ì œí•œ ì¡°ì¹˜</label>
          <select id="participation-ban">
            <option value="N">ì—†ìŒ</option>
            <option value="Y">ìˆìŒ</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>ë¶€ì •ìˆ˜ê¸‰ ì´ë ¥</label>
          <select id="fraud-history">
            <option value="N">ì—†ìŒ</option>
            <option value="Y">ìˆìŒ</option>
          </select>
        </div>
      </div>
    </div>

    <!-- Section 8: íŠ¹í™” ê¸°ì—… ë¶„ë¥˜ -->
    <div class="card">
      <h2>Section 8. íŠ¹í™” ê¸°ì—… ë¶„ë¥˜</h2>
      <div class="checkbox-grid">
        <div class="checkbox-item">
          <input type="checkbox" id="social-enterprise" value="ì‚¬íšŒì ê¸°ì—…">
          <label for="social-enterprise">ì‚¬íšŒì ê¸°ì—…</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="social-venture" value="ì†Œì…œë²¤ì²˜">
          <label for="social-venture">ì†Œì…œë²¤ì²˜</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="preliminary-social" value="ì˜ˆë¹„ì‚¬íšŒì ê¸°ì—…">
          <label for="preliminary-social">ì˜ˆë¹„ì‚¬íšŒì ê¸°ì—…</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="village-enterprise" value="ë§ˆì„ê¸°ì—…">
          <label for="village-enterprise">ë§ˆì„ê¸°ì—…</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="cooperative" value="í˜‘ë™ì¡°í•©">
          <label for="cooperative">í˜‘ë™ì¡°í•©</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="agri-enterprise" value="ë†ê³µìƒìœµí•©">
          <label for="agri-enterprise">ë†ê³µìƒìœµí•©ê¸°ì—…</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="strong-small" value="ê°•ì†Œê¸°ì—…">
          <label for="strong-small">ê°•ì†Œê¸°ì—…</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="hidden-champion" value="íˆë“ ì±”í”¼ì–¸">
          <label for="hidden-champion">íˆë“ ì±”í”¼ì–¸</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="family-friendly" value="ê°€ì¡±ì¹œí™”ê¸°ì—…">
          <label for="family-friendly">ê°€ì¡±ì¹œí™” ì¸ì¦ê¸°ì—…</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="youth-friendly" value="ì²­ë…„ì¹œí™”ê°•ì†Œê¸°ì—…">
          <label for="youth-friendly">ì²­ë…„ì¹œí™” ê°•ì†Œê¸°ì—…</label>
        </div>
      </div>
    </div>

    <!-- Section 9: í¬ë§ ì§€ì›ë¶„ì•¼ -->
    <div class="card">
      <h2>Section 9. í¬ë§ ì§€ì›ë¶„ì•¼ <span class="required">*</span></h2>
      
      <h3>9-1. ì§€ì› í•„ìš” ë¶„ì•¼ (ì¤‘ë³µì„ íƒ ê°€ëŠ¥)</h3>
      <div class="checkbox-grid">
        <div class="checkbox-item">
          <input type="checkbox" id="support-funding" value="ì •ì±…ìê¸ˆ">
          <label for="support-funding">ì •ì±…ìê¸ˆ</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="support-rd" value="ê¸°ìˆ ê°œë°œ">
          <label for="support-rd">ê¸°ìˆ ê°œë°œ(R&D)</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="support-commercialize" value="ì‚¬ì—…í™”">
          <label for="support-commercialize">ì‚¬ì—…í™”</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="support-marketing" value="íŒë¡œë§ˆì¼€íŒ…">
          <label for="support-marketing">íŒë¡œ/ë§ˆì¼€íŒ…</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="support-export" value="ìˆ˜ì¶œì§€ì›">
          <label for="support-export">ìˆ˜ì¶œì§€ì›</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="support-hr" value="ì¸ë ¥êµìœ¡">
          <label for="support-hr">ì¸ë ¥/êµìœ¡</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="support-facility" value="ì‹œì„¤ê³µê°„">
          <label for="support-facility">ì‹œì„¤/ê³µê°„</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="support-consulting" value="ì»¨ì„¤íŒ…">
          <label for="support-consulting">ì»¨ì„¤íŒ…</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="support-startup" value="ì°½ì—…">
          <label for="support-startup">ì°½ì—…</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="support-esg" value="ESGíƒ„ì†Œì¤‘ë¦½">
          <label for="support-esg">ESG/íƒ„ì†Œì¤‘ë¦½</label>
        </div>
      </div>
      
      <h3>9-2. í˜„ì¬ ê¸°ì—… ë°œì „ ë‹¨ê³„ <span class="required">*</span></h3>
      <div class="checkbox-grid">
        <div class="checkbox-item">
          <input type="radio" name="stage" id="stage-idea" value="ì•„ì´í…œêµ¬ìƒ">
          <label for="stage-idea">ì•„ì´í…œ êµ¬ìƒ/ê²€ì¦</label>
        </div>
        <div class="checkbox-item">
          <input type="radio" name="stage" id="stage-prototype" value="ì‹œì œí’ˆê°œë°œ">
          <label for="stage-prototype">ì‹œì œí’ˆ ê°œë°œ</label>
        </div>
        <div class="checkbox-item">
          <input type="radio" name="stage" id="stage-production" value="ì–‘ì‚°ì¤€ë¹„">
          <label for="stage-production">ì–‘ì‚° ì¤€ë¹„/ì´ˆê¸°</label>
        </div>
        <div class="checkbox-item">
          <input type="radio" name="stage" id="stage-growth" value="ì„±ì¥ë‹¨ê³„">
          <label for="stage-growth">ì„±ì¥ ë‹¨ê³„</label>
        </div>
        <div class="checkbox-item">
          <input type="radio" name="stage" id="stage-leap" value="ë„ì•½ë‹¨ê³„">
          <label for="stage-leap">ë„ì•½ ë‹¨ê³„</label>
        </div>
      </div>
      
      <h3>9-3. ì‹œê¸‰ë„ <span class="required">*</span></h3>
      <div class="checkbox-grid">
        <div class="checkbox-item">
          <input type="radio" name="urgency" id="urgent-high" value="ê¸´ê¸‰">
          <label for="urgent-high">ê¸´ê¸‰ (1ê°œì›” ë‚´)</label>
        </div>
        <div class="checkbox-item">
          <input type="radio" name="urgency" id="urgent-normal" value="ë³´í†µ">
          <label for="urgent-normal">ë³´í†µ (3ê°œì›” ë‚´)</label>
        </div>
        <div class="checkbox-item">
          <input type="radio" name="urgency" id="urgent-long" value="ì¥ê¸°">
          <label for="urgent-long">ì¥ê¸° (6ê°œì›”~1ë…„)</label>
        </div>
      </div>
    </div>

    <!-- Section 10: ì¶”ê°€ íŠ¹ì´ì‚¬í•­ -->
    <div class="card">
      <h2>Section 10. ì¶”ê°€ íŠ¹ì´ì‚¬í•­</h2>
      
      <h3>10-1. ìƒìƒí˜‘ë ¥ ê´€ë ¨</h3>
      <div class="form-grid">
        <div class="form-group">
          <label>ëŒ€ê¸°ì—… í˜‘ë ¥ì‚¬</label>
          <select id="large-partner">
            <option value="N">ì•„ë‹ˆì˜¤</option>
            <option value="Y">ì˜ˆ</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>ì£¼ìš” ê±°ë˜ì²˜ëª…</label>
          <input type="text" id="main-client" placeholder="ëŒ€ê¸°ì—…ëª…">
        </div>
        
        <div class="form-group">
          <label>ì¤‘ì†Œê¸°ì—… ê°„ í˜‘ì—…</label>
          <select id="sme-cooperation">
            <option value="N">ì•„ë‹ˆì˜¤</option>
            <option value="Y">ì˜ˆ</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>ì‚°í•™ì—° í˜‘ë ¥</label>
          <select id="industry-academia">
            <option value="N">ì•„ë‹ˆì˜¤</option>
            <option value="Y">ì˜ˆ</option>
          </select>
        </div>
        
        <div class="form-group full-width">
          <label>í˜‘ë ¥ ëŒ€í•™/ì—°êµ¬ì†Œ</label>
          <input type="text" id="partner-institute" placeholder="ì˜ˆ: ì„œìš¸ëŒ€, í•œêµ­ì „ìí†µì‹ ì—°êµ¬ì›">
        </div>
      </div>
      
      <h3>10-2. íŠ¹ìˆ˜ ìƒí™©</h3>
      <div class="form-grid">
        <div class="form-group">
          <label>íì—… í›„ ì¬ì°½ì—…</label>
          <select id="reopen-after-close">
            <option value="N">ì•„ë‹ˆì˜¤</option>
            <option value="Y">ì˜ˆ</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>íì—…ì¼ì</label>
          <input type="date" id="close-date">
        </div>
        
        <div class="form-group">
          <label>ê°€ì—…ìŠ¹ê³„</label>
          <select id="family-succession">
            <option value="N">ì•„ë‹ˆì˜¤</option>
            <option value="Y">ì˜ˆ</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>ìŠ¹ê³„ì—°ë„</label>
          <input type="number" id="succession-year" placeholder="YYYY">
        </div>
        
        <div class="form-group">
          <label>M&A/ì¸ìˆ˜í•©ë³‘</label>
          <select id="merger">
            <option value="N">ì•„ë‹ˆì˜¤</option>
            <option value="Y">ì˜ˆ</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>í•©ë³‘ì¼ì</label>
          <input type="date" id="merger-date">
        </div>
      </div>
      
      <h3>10-3. ììœ  ê¸°ìˆ  í•­ëª©</h3>
      <div class="form-grid">
        <div class="form-group full-width">
          <label>ê¸°ì—… íŠ¹ì¥ì  (100ì ì´ë‚´)</label>
          <textarea id="company-strength" maxlength="100" placeholder="ìš°ë¦¬ ê¸°ì—…ë§Œì˜ ê°•ì , íŠ¹í™” ê¸°ìˆ  ë“±"></textarea>
        </div>
        
        <div class="form-group full-width">
          <label>ì£¼ìš” ì• ë¡œì‚¬í•­</label>
          <textarea id="main-difficulty" placeholder="í˜„ì¬ ê²ªê³  ìˆëŠ” ì£¼ìš” ì–´ë ¤ì›€"></textarea>
        </div>
        
        <div class="form-group full-width">
          <label>ê´€ì‹¬ ì •ì±… í‚¤ì›Œë“œ</label>
          <input type="text" id="policy-keywords" placeholder="ì˜ˆ: ì²­ë…„ê³ ìš©, ìŠ¤ë§ˆíŠ¸ê³µì¥, ìˆ˜ì¶œë§ˆì¼€íŒ…">
        </div>
      </div>
    </div>

    <!-- ì‹¤í–‰ ë²„íŠ¼ -->
    <div class="card">
      <button class="btn btn-primary" onclick="analyzePrograms()" style="width: 100%; font-size: 1.1rem; padding: 1rem; margin-bottom: 0.75rem;">
        ğŸ” ë§ì¶¤ ì§€ì›ì‚¬ì—… ì°¾ê¸°
      </button>
      <button class="btn btn-secondary" onclick="saveCompany()" style="width: 100%;">
        ğŸ’¾ ì´ ì •ë³´ ì €ì¥í•˜ê¸° (AES-256 ì•”í˜¸í™”)
      </button>
    </div>

    <!-- ê²°ê³¼ í‘œì‹œ ì˜ì—­ -->
    <div id="results-section" style="display: none;"></div>
  </div>

  <script>
    // ==================== Firebase & Google Drive ì„¤ì • ====================
    
    // Firebase ì„¤ì • (ì‚¬ìš©ìê°€ Firebase Consoleì—ì„œ ë°›ì€ ê°’ìœ¼ë¡œ êµì²´ í•„ìš”)
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_PROJECT_ID.appspot.com",
      messagingSenderId: "YOUR_SENDER_ID",
      appId: "YOUR_APP_ID"
    };
    
    // Firebase ì´ˆê¸°í™”
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    
    // Google API í´ë¼ì´ì–¸íŠ¸ ì´ˆê¸°í™”
    let gapiInited = false;
    let gisInited = false;
    let tokenClient;
    let accessToken = null;
    
    const DISCOVERY_DOC = 'https://www.googleapis.com/discovery/v1/apis/drive/v3/rest';
    const SCOPES = 'https://www.googleapis.com/auth/drive.file https://www.googleapis.com/auth/drive.appdata';
    
    // Google API ì´ˆê¸°í™”
    function gapiLoaded() {
      gapi.load('client', initializeGapiClient);
    }
    
    async function initializeGapiClient() {
      await gapi.client.init({
        discoveryDocs: [DISCOVERY_DOC],
      });
      gapiInited = true;
    }
    
    // Google ë¡œê·¸ì¸
    async function signInWithGoogle() {
      try {
        console.log('ğŸ” Google ë¡œê·¸ì¸ ì‹œì‘...');
        
        const provider = new firebase.auth.GoogleAuthProvider();
        provider.addScope('https://www.googleapis.com/auth/drive.file');
        provider.addScope('https://www.googleapis.com/auth/drive.appdata');
        
        const result = await auth.signInWithPopup(provider);
        const credential = result.credential;
        accessToken = credential.accessToken;
        
        console.log('âœ… ë¡œê·¸ì¸ ì„±ê³µ:', result.user.email);
        
        // Google API í´ë¼ì´ì–¸íŠ¸ ì„¤ì •
        gapi.client.setToken({ access_token: accessToken });
        
        // ë¡œê·¸ì¸ í™”ë©´ ìˆ¨ê¸°ê³  ë©”ì¸ í™”ë©´ í‘œì‹œ
        document.getElementById('login-screen').style.display = 'none';
        document.getElementById('main-content').style.display = 'block';
        
        // Google Driveì—ì„œ ë°ì´í„° ë¡œë“œ
        await loadFromDrive();
        
      } catch (error) {
        console.error('âŒ ë¡œê·¸ì¸ ì‹¤íŒ¨:', error);
        alert('ë¡œê·¸ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
      }
    }
    
    // Google ë¡œê·¸ì•„ì›ƒ
    async function signOut() {
      try {
        await auth.signOut();
        accessToken = null;
        savedCompanies = {};
        
        document.getElementById('main-content').style.display = 'none';
        document.getElementById('login-screen').style.display = 'flex';
        
        console.log('âœ… ë¡œê·¸ì•„ì›ƒ ì™„ë£Œ');
      } catch (error) {
        console.error('âŒ ë¡œê·¸ì•„ì›ƒ ì‹¤íŒ¨:', error);
      }
    }
    
    // Google Driveì— ì €ì¥
    async function saveToDrive(data) {
      try {
        if (!accessToken) {
          console.error('âŒ Access tokenì´ ì—†ìŠµë‹ˆë‹¤');
          return false;
        }
        
        console.log('ğŸ’¾ Google Driveì— ì €ì¥ ì¤‘...');
        
        // ë°ì´í„° ì•”í˜¸í™”
        const encryptedData = encryptData(data);
        
        // ê¸°ì¡´ íŒŒì¼ ê²€ìƒ‰
        const searchResponse = await gapi.client.drive.files.list({
          q: "name='kfpc-bizinfo-data.json' and trashed=false",
          spaces: 'appDataFolder',
          fields: 'files(id, name)',
        });
        
        const files = searchResponse.result.files;
        const fileContent = JSON.stringify({ encryptedData, timestamp: new Date().toISOString() });
        const file = new Blob([fileContent], { type: 'application/json' });
        
        if (files && files.length > 0) {
          // ê¸°ì¡´ íŒŒì¼ ì—…ë°ì´íŠ¸
          const fileId = files[0].id;
          const form = new FormData();
          form.append('metadata', new Blob([JSON.stringify({})], { type: 'application/json' }));
          form.append('file', file);
          
          const updateResponse = await fetch(
            `https://www.googleapis.com/upload/drive/v3/files/${fileId}?uploadType=multipart`,
            {
              method: 'PATCH',
              headers: { Authorization: `Bearer ${accessToken}` },
              body: form,
            }
          );
          
          if (updateResponse.ok) {
            console.log('âœ… Drive ì—…ë°ì´íŠ¸ ì™„ë£Œ');
            return true;
          }
        } else {
          // ìƒˆ íŒŒì¼ ìƒì„±
          const metadata = {
            name: 'kfpc-bizinfo-data.json',
            mimeType: 'application/json',
            parents: ['appDataFolder'],
          };
          
          const form = new FormData();
          form.append('metadata', new Blob([JSON.stringify(metadata)], { type: 'application/json' }));
          form.append('file', file);
          
          const createResponse = await fetch(
            'https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart',
            {
              method: 'POST',
              headers: { Authorization: `Bearer ${accessToken}` },
              body: form,
            }
          );
          
          if (createResponse.ok) {
            console.log('âœ… Drive ì €ì¥ ì™„ë£Œ');
            return true;
          }
        }
        
        return false;
      } catch (error) {
        console.error('âŒ Drive ì €ì¥ ì‹¤íŒ¨:', error);
        return false;
      }
    }
    
    // Google Driveì—ì„œ ë¶ˆëŸ¬ì˜¤ê¸°
    async function loadFromDrive() {
      try {
        if (!accessToken) {
          console.error('âŒ Access tokenì´ ì—†ìŠµë‹ˆë‹¤');
          return false;
        }
        
        console.log('ğŸ“¥ Google Driveì—ì„œ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...');
        
        const searchResponse = await gapi.client.drive.files.list({
          q: "name='kfpc-bizinfo-data.json' and trashed=false",
          spaces: 'appDataFolder',
          fields: 'files(id, name)',
        });
        
        const files = searchResponse.result.files;
        if (!files || files.length === 0) {
          console.log('ğŸ“ ì €ì¥ëœ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤');
          return false;
        }
        
        const fileId = files[0].id;
        const getResponse = await fetch(
          `https://www.googleapis.com/drive/v3/files/${fileId}?alt=media`,
          {
            headers: { Authorization: `Bearer ${accessToken}` },
          }
        );
        
        if (getResponse.ok) {
          const fileData = await getResponse.json();
          const decryptedData = decryptData(fileData.encryptedData);
          
          if (decryptedData) {
            savedCompanies = decryptedData;
            updateCompanySelect();
            console.log('âœ… Drive ë¡œë“œ ì™„ë£Œ:', Object.keys(savedCompanies).length, 'ê°œ ê³ ê°ì‚¬');
            return true;
          }
        }
        
        return false;
      } catch (error) {
        console.error('âŒ Drive ë¡œë“œ ì‹¤íŒ¨:', error);
        return false;
      }
    }
    
    // ==================== AES-256 ì•”í˜¸í™” ====================
    
    // AES-256 ì•”í˜¸í™” í‚¤ (ì•± ê³ ìœ  í‚¤)
    const ENCRYPTION_KEY = 'KFPC-BizInfo-2025-AES256-SecureKey';
    
    let savedCompanies = {};

    // ì•”í˜¸í™” í•¨ìˆ˜
    function encryptData(data) {
      return CryptoJS.AES.encrypt(JSON.stringify(data), ENCRYPTION_KEY).toString();
    }
    
    // ë³µí˜¸í™” í•¨ìˆ˜
    function decryptData(encryptedData) {
      try {
        const bytes = CryptoJS.AES.decrypt(encryptedData, ENCRYPTION_KEY);
        return JSON.parse(bytes.toString(CryptoJS.enc.Utf8));
      } catch (e) {
        console.error('ë³µí˜¸í™” ì‹¤íŒ¨:', e);
        return null;
      }
    }
    
    // ==================== ë“±ë¡ë²ˆí˜¸ ì…ë ¥ ìë™ í¬ì»¤ìŠ¤ ====================
    function moveFocusOnMaxLength(currentInput, nextInputId, maxLength) {
      // ìˆ«ìë§Œ ì…ë ¥ë˜ë„ë¡ í•„í„°ë§
      currentInput.value = currentInput.value.replace(/[^\d]/g, '');
      
      // ìµœëŒ€ ê¸¸ì´ì— ë„ë‹¬í•˜ë©´ ë‹¤ìŒ inputìœ¼ë¡œ í¬ì»¤ìŠ¤ ì´ë™
      if (currentInput.value.length >= maxLength) {
        const nextInput = document.getElementById(nextInputId);
        if (nextInput) {
          nextInput.focus();
        }
      }
    }
    
    // ==================== ìˆ«ì í¬ë§·íŒ… ====================
    function formatNumber(value) {
      if (!value) return '';
      // ìˆ«ìê°€ ì•„ë‹Œ ë¬¸ì ì œê±°
      const numStr = String(value).replace(/[^\d]/g, '');
      if (!numStr) return '';
      
      // ìˆ«ìë¥¼ ì²œ ë‹¨ìœ„ë¡œ ì½¤ë§ˆ ì¶”ê°€
      return numStr.replace(/\B(?=(\d{3})+(?!\d))/g, ',');
    }
    
    function unformatNumber(value) {
      if (!value) return '';
      // ì½¤ë§ˆ ì œê±°í•˜ê³  ìˆœìˆ˜ ìˆ«ìë§Œ ë°˜í™˜
      return String(value).replace(/,/g, '');
    }
    
    function attachNumberFormatting() {
      // ëª¨ë“  ìˆ«ì ì…ë ¥ í•„ë“œ ID ëª©ë¡
      const numberFields = [
        // Section 3: ì¬ë¬´ ì •ë³´
        'revenue-recent', 'revenue-prev1', 'revenue-prev2',
        'profit-recent', 'capital', 'total-equity', 'total-debt', 'debt-ratio',
        'tax-arrears', 'local-tax-arrears', 'insurance-arrears',
        // Section 4: ê³ ìš© ì •ë³´
        'employees-total', 'employees-prev', 'employees-youth', 
        'employees-female', 'employees-disabled', 'employees-senior',
        'irregular-ratio', 'hiring-plan',
        // Section 5: ê¸°ìˆ  ì •ë³´
        'researchers', 'rd-investment', 'rd-ratio',
        'patents-registered', 'patents-applied', 'trademarks',
        // Section 6: ìˆ˜ì¶œ ì •ë³´
        'export-recent', 'export-prev'
      ];
      
      numberFields.forEach(fieldId => {
        const field = document.getElementById(fieldId);
        if (field) {
          // typeì„ textë¡œ ë³€ê²½í•˜ê³  inputmode ì¶”ê°€
          field.type = 'text';
          field.setAttribute('inputmode', 'numeric');
          
          // input ì´ë²¤íŠ¸ë¡œ ì‹¤ì‹œê°„ í¬ë§·íŒ…
          field.addEventListener('input', function(e) {
            const cursorPos = this.selectionStart;
            const oldLength = this.value.length;
            
            // í¬ë§·íŒ… ì ìš©
            const formatted = formatNumber(this.value);
            this.value = formatted;
            
            // ì»¤ì„œ ìœ„ì¹˜ ì¡°ì •
            const newLength = formatted.length;
            const lengthDiff = newLength - oldLength;
            
            // ìˆ«ì ì…ë ¥ ì¤‘ ì½¤ë§ˆê°€ ì¶”ê°€ë˜ë©´ ì»¤ì„œ ìœ„ì¹˜ ì¡°ì •
            if (lengthDiff > 0 && cursorPos < newLength) {
              this.setSelectionRange(cursorPos + lengthDiff, cursorPos + lengthDiff);
            } else {
              this.setSelectionRange(cursorPos, cursorPos);
            }
          });
          
          // blur ì´ë²¤íŠ¸ë¡œ ìµœì¢… í¬ë§·íŒ…
          field.addEventListener('blur', function() {
            this.value = formatNumber(this.value);
          });
        }
      });
      
      console.log('âœ… ìˆ«ì í•„ë“œ ì‹¤ì‹œê°„ ì½¤ë§ˆ í¬ë§·íŒ… í™œì„±í™” (' + numberFields.length + 'ê°œ í•„ë“œ)');
    }

    async function initializeApp() {
      try {
        console.log('ğŸš€ ì•± ì´ˆê¸°í™”');
        
        // Google API ë¡œë“œ
        gapi.load('client', gapiLoaded);
        
        // Firebase ì¸ì¦ ìƒíƒœ í™•ì¸
        auth.onAuthStateChanged(async (user) => {
          if (user) {
            console.log('âœ… ë¡œê·¸ì¸ ìƒíƒœ:', user.email);
            
            // ì‚¬ìš©ì ì •ë³´ í‘œì‹œ
            document.getElementById('user-info').textContent = user.email;
            
            // í† í° ê°±ì‹ 
            const credential = await user.getIdTokenResult();
            accessToken = credential.token;
            
            // Google API í´ë¼ì´ì–¸íŠ¸ ì„¤ì •
            if (gapiInited) {
              gapi.client.setToken({ access_token: accessToken });
            }
            
            // ë¡œê·¸ì¸ í™”ë©´ ìˆ¨ê¸°ê³  ë©”ì¸ í™”ë©´ í‘œì‹œ
            document.getElementById('login-screen').style.display = 'none';
            document.getElementById('main-content').style.display = 'block';
            
            // Google Driveì—ì„œ ë°ì´í„° ë¡œë“œ
            await loadFromDrive();
            
            // ìˆ«ì í¬ë§·íŒ… í™œì„±í™”
            attachNumberFormatting();
            
            hideLoading();
          } else {
            console.log('âš ï¸ ë¡œê·¸ì¸ í•„ìš”');
            // ë¡œê·¸ì¸ í™”ë©´ í‘œì‹œ
            document.getElementById('login-screen').style.display = 'flex';
            hideLoading();
          }
        });
        
      } catch (error) {
        console.error('âŒ ì´ˆê¸°í™” ì‹¤íŒ¨:', error);
        hideLoading();
      }
    }
    
    function hideLoading() {
      const loading = document.getElementById('loading-screen');
      loading.classList.add('hide');
      setTimeout(() => loading.style.display = 'none', 300);
    }
    
    function collectFormData() {
      // ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸ 3ê°œ input í•©ì¹˜ê¸°
      const bizNum1 = document.getElementById('business-number-1').value;
      const bizNum2 = document.getElementById('business-number-2').value;
      const bizNum3 = document.getElementById('business-number-3').value;
      const businessNumber = bizNum1 && bizNum2 && bizNum3 ? `${bizNum1}-${bizNum2}-${bizNum3}` : '';
      
      // ë²•ì¸ë“±ë¡ë²ˆí˜¸ 2ê°œ input í•©ì¹˜ê¸°
      const corpNum1 = document.getElementById('corp-number-1').value;
      const corpNum2 = document.getElementById('corp-number-2').value;
      const corpNumber = corpNum1 && corpNum2 ? `${corpNum1}-${corpNum2}` : '';
      
      // ëª¨ë“  ì…ë ¥ í•„ë“œ ë°ì´í„° ìˆ˜ì§‘
      const data = {
        // Section 1
        companyName: document.getElementById('company-name').value,
        businessNumber: businessNumber,
        corpNumber: corpNumber,
        establishDate: document.getElementById('establish-date').value,
        businessAge: document.getElementById('business-age')?.value || '',
        companySize: document.getElementById('company-size').value,
        companyType: document.getElementById('company-type').value,
        ksicCode: document.getElementById('ksic-code').value,
        productKeywords: document.getElementById('product-keywords').value,
        locationSido: document.getElementById('location-sido').value,
        locationSigungu: document.getElementById('location-sigungu').value,
        industrialComplex: document.getElementById('industrial-complex').value,
        capitalArea: document.getElementById('capital-area').value,
        
        // Section 2
        ceoName: document.getElementById('ceo-name').value,
        ceoBirth: document.getElementById('ceo-birth').value,
        ceoGender: document.getElementById('ceo-gender').value,
        ceoDisabled: document.getElementById('ceo-disabled').value,
        ceoVeteran: document.getElementById('ceo-veteran').value,
        ceoDefector: document.getElementById('ceo-defector').value,
        ceoRestart: document.getElementById('ceo-restart').value,
        guaranteeExempt: document.getElementById('guarantee-exempt').value,
        
        // Section 3 (ìˆ«ì í•„ë“œëŠ” ì½¤ë§ˆ ì œê±°)
        revenueRecent: unformatNumber(document.getElementById('revenue-recent').value),
        revenuePrev1: unformatNumber(document.getElementById('revenue-prev1').value),
        revenuePrev2: unformatNumber(document.getElementById('revenue-prev2').value),
        profitRecent: unformatNumber(document.getElementById('profit-recent').value),
        capital: unformatNumber(document.getElementById('capital').value),
        totalEquity: unformatNumber(document.getElementById('total-equity').value),
        totalDebt: unformatNumber(document.getElementById('total-debt').value),
        debtRatio: unformatNumber(document.getElementById('debt-ratio').value),
        taxArrears: unformatNumber(document.getElementById('tax-arrears').value),
        localTaxArrears: unformatNumber(document.getElementById('local-tax-arrears').value),
        insuranceArrears: unformatNumber(document.getElementById('insurance-arrears').value),
        capitalErosion: document.getElementById('capital-erosion').value,
        bankruptcyHistory: document.getElementById('bankruptcy-history').value,
        creditRating: document.getElementById('credit-rating').value,
        tcbRating: document.getElementById('tcb-rating').value,
        
        // Section 4 (ìˆ«ì í•„ë“œëŠ” ì½¤ë§ˆ ì œê±°)
        employeesTotal: unformatNumber(document.getElementById('employees-total').value),
        employeesPrev: unformatNumber(document.getElementById('employees-prev').value),
        employeesYouth: unformatNumber(document.getElementById('employees-youth').value),
        employeesFemale: unformatNumber(document.getElementById('employees-female').value),
        employeesDisabled: unformatNumber(document.getElementById('employees-disabled').value),
        employeesSenior: unformatNumber(document.getElementById('employees-senior').value),
        irregularRatio: unformatNumber(document.getElementById('irregular-ratio').value),
        hiringPlan: unformatNumber(document.getElementById('hiring-plan').value),
        hiringField: document.getElementById('hiring-field').value,
        
        // Section 5
        certVenture: document.getElementById('cert-venture').value,
        certVentureExpire: document.getElementById('cert-venture-expire').value,
        certInnobiz: document.getElementById('cert-innobiz').value,
        certInnobizExpire: document.getElementById('cert-innobiz-expire').value,
        certMainbiz: document.getElementById('cert-mainbiz').value,
        certMainbizExpire: document.getElementById('cert-mainbiz-expire').value,
        certGreen: document.getElementById('cert-green').value,
        certMaterials: document.getElementById('cert-materials').value,
        certRoot: document.getElementById('cert-root').value,
        certWorldclass: document.getElementById('cert-worldclass').value,
        researchOrg: document.getElementById('research-org').value,
        researchers: unformatNumber(document.getElementById('researchers').value),
        rdInvestment: unformatNumber(document.getElementById('rd-investment').value),
        rdRatio: unformatNumber(document.getElementById('rd-ratio').value),
        patentsRegistered: unformatNumber(document.getElementById('patents-registered').value),
        patentsApplied: unformatNumber(document.getElementById('patents-applied').value),
        trademarks: unformatNumber(document.getElementById('trademarks').value),
        techTransfer: document.getElementById('tech-transfer').value,
        qualityCerts: Array.from(document.querySelectorAll('#iso-9001, #iso-14001, #iso-45001, #cert-gmp, #cert-kc, #cert-haccp, #cert-fda, #cert-ce')).filter(el => el.checked).map(el => el.value),
        esgRating: document.getElementById('esg-rating').value,
        carbonNeutral: document.getElementById('carbon-neutral').value,
        smartFactory: document.getElementById('smart-factory').value,
        digitalTransform: document.getElementById('digital-transform').value,
        
        // Section 6
        exportRecent: unformatNumber(document.getElementById('export-recent').value),
        exportPrev: unformatNumber(document.getElementById('export-prev').value),
        exportCountries: document.getElementById('export-countries').value,
        hsCode: document.getElementById('hs-code').value,
        overseasCert: document.getElementById('overseas-cert').value,
        overseasOffice: document.getElementById('overseas-office').value,
        overseasCountry: document.getElementById('overseas-country').value,
        ftaUse: document.getElementById('fta-use').value,
        exportVoucher: document.getElementById('export-voucher').value,
        overseasExhibition: document.getElementById('overseas-exhibition').value,
        
        // Section 7
        support2024: document.getElementById('support-2024').value,
        support2023: document.getElementById('support-2023').value,
        support2022: document.getElementById('support-2022').value,
        projectAbandon: document.getElementById('project-abandon').value,
        subsidyReturn: document.getElementById('subsidy-return').value,
        participationBan: document.getElementById('participation-ban').value,
        fraudHistory: document.getElementById('fraud-history').value,
        
        // Section 8
        specialTypes: Array.from(document.querySelectorAll('#social-enterprise, #social-venture, #preliminary-social, #village-enterprise, #cooperative, #agri-enterprise, #strong-small, #hidden-champion, #family-friendly, #youth-friendly')).filter(el => el.checked).map(el => el.value),
        
        // Section 9
        supportNeeds: Array.from(document.querySelectorAll('#support-funding, #support-rd, #support-commercialize, #support-marketing, #support-export, #support-hr, #support-facility, #support-consulting, #support-startup, #support-esg')).filter(el => el.checked).map(el => el.value),
        companyStage: document.querySelector('input[name="stage"]:checked')?.value || '',
        urgency: document.querySelector('input[name="urgency"]:checked')?.value || '',
        
        // Section 10
        largePartner: document.getElementById('large-partner').value,
        mainClient: document.getElementById('main-client').value,
        smeCooperation: document.getElementById('sme-cooperation').value,
        industryAcademia: document.getElementById('industry-academia').value,
        partnerInstitute: document.getElementById('partner-institute').value,
        reopenAfterClose: document.getElementById('reopen-after-close').value,
        closeDate: document.getElementById('close-date').value,
        familySuccession: document.getElementById('family-succession').value,
        successionYear: document.getElementById('succession-year').value,
        merger: document.getElementById('merger').value,
        mergerDate: document.getElementById('merger-date').value,
        companyStrength: document.getElementById('company-strength').value,
        mainDifficulty: document.getElementById('main-difficulty').value,
        policyKeywords: document.getElementById('policy-keywords').value
      };
      
      return data;
    }
    
    function updateCompanySelect() {
      const select = document.getElementById('company-select');
      select.innerHTML = '<option value="">-- ìƒˆë¡œ ì…ë ¥ --</option>';
      
      Object.keys(savedCompanies).forEach(id => {
        const company = savedCompanies[id];
        const option = document.createElement('option');
        option.value = id;
        option.textContent = `${company.companyName} (${company.companySize})`;
        select.appendChild(option);
      });
    }
    
    function loadSelectedCompany() {
      const select = document.getElementById('company-select');
      const companyId = select.value;
      
      if (!companyId) {
        clearForm();
        return;
      }
      
      const company = savedCompanies[companyId];
      if (!company) return;
      
      // ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸ ë¶„ë¦¬ (123-45-67890 â†’ 3ê°œ input)
      if (company.businessNumber) {
        const bizParts = company.businessNumber.split('-');
        if (bizParts.length === 3) {
          document.getElementById('business-number-1').value = bizParts[0];
          document.getElementById('business-number-2').value = bizParts[1];
          document.getElementById('business-number-3').value = bizParts[2];
        }
      }
      
      // ë²•ì¸ë“±ë¡ë²ˆí˜¸ ë¶„ë¦¬ (123456-1234567 â†’ 2ê°œ input)
      if (company.corpNumber) {
        const corpParts = company.corpNumber.split('-');
        if (corpParts.length === 2) {
          document.getElementById('corp-number-1').value = corpParts[0];
          document.getElementById('corp-number-2').value = corpParts[1];
        }
      }
      
      // ìˆ«ì í•„ë“œ ëª©ë¡
      const numberFieldKeys = [
        'revenueRecent', 'revenuePrev1', 'revenuePrev2', 'profitRecent',
        'capital', 'totalEquity', 'totalDebt', 'debtRatio',
        'taxArrears', 'localTaxArrears', 'insuranceArrears',
        'employeesTotal', 'employeesPrev', 'employeesYouth', 
        'employeesFemale', 'employeesDisabled', 'employeesSenior',
        'irregularRatio', 'hiringPlan',
        'researchers', 'rdInvestment', 'rdRatio',
        'patentsRegistered', 'patentsApplied', 'trademarks',
        'exportRecent', 'exportPrev'
      ];
      
      // ëª¨ë“  í•„ë“œì— ë°ì´í„° ë¡œë“œ
      Object.keys(company).forEach(key => {
        // businessNumber, corpNumberëŠ” ì´ë¯¸ ì²˜ë¦¬í–ˆìœ¼ë¯€ë¡œ ìŠ¤í‚µ
        if (key === 'businessNumber' || key === 'corpNumber') return;
        
        const element = document.getElementById(key.replace(/([A-Z])/g, '-$1').toLowerCase());
        if (element) {
          if (element.type === 'checkbox') {
            element.checked = company[key].includes(element.value);
          } else if (element.type === 'radio') {
            if (element.value === company[key]) element.checked = true;
          } else {
            // ìˆ«ì í•„ë“œëŠ” ì½¤ë§ˆ ì¶”ê°€
            if (numberFieldKeys.includes(key)) {
              element.value = formatNumber(company[key]);
            } else {
              element.value = company[key];
            }
          }
        }
      });
      
      console.log('âœ… ê³ ê°ì‚¬ ì •ë³´ ë¡œë“œ:', company.companyName);
    }
    
    async function saveCompany() {
      const companyData = collectFormData();
      
      if (!companyData.companyName) {
        alert('íšŒì‚¬ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        return;
      }
      
      if (!companyData.businessNumber) {
        alert('ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        return;
      }
      
      const companyId = Date.now().toString();
      savedCompanies[companyId] = {
        ...companyData,
        savedAt: new Date().toISOString()
      };
      
      // Google Driveì— ì•”í˜¸í™”í•˜ì—¬ ì €ì¥
      const success = await saveToDrive(savedCompanies);
      
      if (success) {
        updateCompanySelect();
        alert(`âœ… "${companyData.companyName}" ì €ì¥ ì™„ë£Œ!\n\nğŸ” êµ¬ê¸€ ë“œë¼ì´ë¸Œì— AES-256 ì•”í˜¸í™”ë¡œ ì•ˆì „í•˜ê²Œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.`);
        console.log('ğŸ’¾ ê³ ê°ì‚¬ ì €ì¥ ì™„ë£Œ (Google Drive + ì•”í˜¸í™”)');
      } else {
        alert('âŒ ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
      }
    }
    
    function clearForm() {
      document.querySelectorAll('input, select, textarea').forEach(el => {
        if (el.type === 'checkbox' || el.type === 'radio') {
          el.checked = false;
        } else {
          el.value = '';
        }
      });
      document.getElementById('company-select').value = '';
    }
    
    async function analyzePrograms() {
      const companyData = collectFormData();
      
      // í•„ìˆ˜ í•„ë“œ ê²€ì¦
      if (!companyData.companyName || !companyData.businessNumber || !companyData.establishDate ||
          !companyData.companySize || !companyData.companyType || !companyData.ksicCode ||
          !companyData.locationSido || !companyData.capitalArea || !companyData.ceoName ||
          !companyData.ceoBirth || !companyData.ceoGender || !companyData.revenueRecent ||
          !companyData.taxArrears || !companyData.localTaxArrears || !companyData.employeesTotal ||
          !companyData.supportNeeds.length || !companyData.companyStage || !companyData.urgency) {
        alert('í•„ìˆ˜ í•­ëª©(*)ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        return;
      }
      
      try {
        showLoadingOverlay('ê¸°ì—…ë§ˆë‹¹ API ì¡°íšŒ ì¤‘...', 'AIê°€ 500ê°œ ì§€ì›ì‚¬ì—… ë¶„ì„ ì¤‘');
        
        const response = await fetch('/.netlify/functions/analyzeBizInfo', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ companyProfile: companyData })
        });
        
        if (!response.ok) throw new Error(`ì„œë²„ ì˜¤ë¥˜: ${response.status}`);
        
        const result = await response.json();
        hideLoadingOverlay();
        displayResults(result);
        
      } catch (error) {
        hideLoadingOverlay();
        console.error('âŒ ë¶„ì„ ì‹¤íŒ¨:', error);
        alert('ë¶„ì„ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\n\n' + error.message);
      }
    }
    
    function showLoadingOverlay(title, subtitle) {
      const overlay = document.createElement('div');
      overlay.className = 'loading-overlay';
      overlay.id = 'loading-overlay';
      overlay.innerHTML = `
        <div class="loader"></div>
        <h2>${title}</h2>
        <p>${subtitle}</p>
      `;
      document.body.appendChild(overlay);
    }
    
    function hideLoadingOverlay() {
      const overlay = document.getElementById('loading-overlay');
      if (overlay) overlay.remove();
    }
    
    function displayResults(result) {
      const section = document.getElementById('results-section');
      section.innerHTML = '<div class="card"><h2>ğŸ“Š AI ë¶„ì„ ê²°ê³¼</h2></div>';
      
      if (!result.recommendations || result.recommendations.length === 0) {
        section.innerHTML += '<div class="card"><p>í˜„ì¬ ì í•©í•œ ì§€ì›ì‚¬ì—…ì„ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.</p></div>';
        section.style.display = 'block';
        section.scrollIntoView({ behavior: 'smooth' });
        return;
      }
      
      result.recommendations.forEach((rec, index) => {
        const card = `
          <div class="result-card">
            <span class="rank">${index + 1}ìœ„</span>
            <h3>${rec.programName}</h3>
            <p style="color:#666;font-size:0.9rem;margin-bottom:0.75rem;">ì£¼ê´€: ${rec.organization}</p>
            <span class="match-score">ë§¤ì¹­ë„: ${rec.matchScore}ì </span>
            <div style="margin-top:1rem;padding-top:1rem;border-top:1px solid #e0e0e0;">
              <h4 style="color:#0c2c54;margin-bottom:0.5rem;">ğŸ¯ ì¶”ì²œ ì´ìœ </h4>
              <p style="color:#555;line-height:1.6;">${rec.reason}</p>
              <h4 style="color:#0c2c54;margin:1rem 0 0.5rem;">ğŸ’° ì§€ì› ë‚´ìš©</h4>
              <p style="color:#555;line-height:1.6;">${rec.benefits}</p>
              ${rec.detailUrl ? `<a href="${rec.detailUrl}" target="_blank" class="btn btn-primary" style="display:inline-block;text-decoration:none;margin-top:1rem;">ğŸ”— ìƒì„¸ ì •ë³´</a>` : ''}
            </div>
          </div>
        `;
        section.innerHTML += card;
      });
      
      section.style.display = 'block';
      section.scrollIntoView({ behavior: 'smooth' });
    }
    
    function goHome() {
      window.location.href = 'index.html';
    }
    
    window.addEventListener('load', initializeApp);
  </script>
</body>
</html>
