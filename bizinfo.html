<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>ê¸°ì—… ì§€ì›ì‚¬ì—… AI ë§¤ì¹­ - KFPC</title>
  
  <!-- CryptoJS for AES-256 encryption -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
  
  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
  
  <!-- Google API for Drive -->
  <script src="https://apis.google.com/js/api.js"></script>
  
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Noto Sans KR', sans-serif;
      background: linear-gradient(135deg, #0c2c54 0%, #2a5a8a 100%);
      color: #fff;
      min-height: 100vh;
      -webkit-overflow-scrolling: touch;
    }
    
    .loading-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #0c2c54 0%, #2a5a8a 100%);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      transition: opacity 0.3s;
    }
    
    .loading-screen.hide {
      opacity: 0;
      pointer-events: none;
    }
    
    .loader {
      width: 50px;
      height: 50px;
      border: 4px solid rgba(255,255,255,0.3);
      border-top-color: #FF8802;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    .loading-text {
      margin-top: 1rem;
      font-size: 1.1rem;
    }
    
    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 1.5rem;
    }
    
    .header {
      position: relative;
      text-align: center;
      margin-bottom: 2rem;
      padding-bottom: 1.5rem;
      border-bottom: 2px solid rgba(255,255,255,0.2);
    }
    
    .header h1 {
      font-size: 2rem;
      margin-bottom: 0.5rem;
    }
    
    .btn-main {
      position: absolute;
      top: 0;
      right: 0;
      padding: 0.75rem 1.25rem;
      border-radius: 10px;
      border: none;
      background: rgba(255,255,255,0.2);
      color: white;
      font-size: 1rem;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.2s;
      border: 1px solid rgba(255,255,255,0.3);
    }
    
    .btn-main:hover {
      background: rgba(255,255,255,0.3);
    }
    
    .required-notice {
      background: rgba(255, 136, 2, 0.2);
      border: 2px solid #FF8802;
      border-radius: 12px;
      padding: 1rem 1.5rem;
      margin-bottom: 2rem;
      text-align: center;
      font-size: 1rem;
    }
    
    .required-notice strong {
      color: #FFD700;
      font-size: 1.1rem;
    }
    
    .btn {
      padding: 0.875rem 1.5rem;
      border-radius: 12px;
      border: none;
      font-size: 1rem;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.2s;
      min-height: 48px;
      user-select: none;
    }
    
    .btn:active {
      transform: translateY(1px);
    }
    
    .btn-primary {
      background: linear-gradient(135deg, #FF8802 0%, #FF6B00 100%);
      color: white;
      box-shadow: 0 4px 12px rgba(255,136,2,0.3);
    }
    
    .btn-secondary {
      background: rgba(255,255,255,0.15);
      color: white;
      border: 1px solid rgba(255,255,255,0.3);
    }
    
    .card {
      background: rgba(255,255,255,0.12);
      border-radius: 16px;
      padding: 1.5rem;
      margin-bottom: 1.5rem;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255,255,255,0.2);
    }
    
    .card h2 {
      font-size: 1.3rem;
      margin-bottom: 1.25rem;
      color: #ffd27f;
      padding-bottom: 0.75rem;
      border-bottom: 2px solid rgba(255,255,255,0.2);
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .section-info-icon {
      position: relative;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 20px;
      height: 20px;
      background: rgba(255, 210, 127, 0.2);
      border: 1.5px solid #ffd27f;
      border-radius: 50%;
      font-size: 0.85rem;
      font-weight: 700;
      color: #ffd27f;
      cursor: help;
      transition: all 0.2s;
      flex-shrink: 0;
    }
    
    .section-info-icon:hover {
      background: rgba(255, 210, 127, 0.3);
      transform: scale(1.1);
    }
    
    .section-info-tooltip {
      visibility: hidden;
      opacity: 0;
      position: absolute;
      left: 30px;
      top: -10px;
      background: rgba(20, 40, 70, 0.98);
      color: #fff;
      padding: 0.75rem 1rem;
      border-radius: 8px;
      font-size: 0.9rem;
      font-weight: 400;
      line-height: 1.5;
      white-space: nowrap;
      z-index: 1000;
      border: 1px solid rgba(255, 210, 127, 0.3);
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
      transition: all 0.2s;
      pointer-events: none;
    }
    
    .section-info-tooltip::before {
      content: '';
      position: absolute;
      left: -8px;
      top: 50%;
      transform: translateY(-50%);
      border-width: 6px;
      border-style: solid;
      border-color: transparent rgba(20, 40, 70, 0.98) transparent transparent;
    }
    
    .section-info-icon:hover .section-info-tooltip {
      visibility: visible;
      opacity: 1;
      left: 35px;
    }
    
    .card h3 {
      font-size: 1.1rem;
      margin: 1.5rem 0 1rem 0;
      color: #ffd27f;
      padding-bottom: 0.5rem;
      border-bottom: 1px solid rgba(255,255,255,0.15);
    }
    
    .form-grid {
      display: grid;
      gap: 1rem;
      grid-template-columns: 1fr;
    }
    
    @media (min-width: 480px) {
      .form-grid {
        grid-template-columns: repeat(2, 1fr);
      }
      .form-grid .full-width {
        grid-column: 1 / -1;
      }
    }
    
    @media (min-width: 1024px) {
      .form-grid {
        grid-template-columns: repeat(3, 1fr);
      }
    }
    
    .form-group {
      display: flex;
      flex-direction: column;
    }
    
    .form-group label {
      font-size: 0.9rem;
      font-weight: 600;
      margin-bottom: 0.5rem;
      color: #ffd27f;
    }
    
    .required {
      color: #FF8802;
      font-weight: 700;
    }
    
    .form-group input,
    .form-group select,
    .form-group textarea {
      width: 100%;
      padding: 0.875rem;
      border-radius: 10px;
      border: 1px solid rgba(255,255,255,0.3);
      background: rgba(255,255,255,0.95);
      color: #333;
      font-size: 16px;
      -webkit-appearance: none;
      appearance: none;
    }
    
    .form-group select {
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23333' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 0.875rem center;
      padding-right: 2.5rem;
    }
    
    .form-group input:focus,
    .form-group select:focus,
    .form-group textarea:focus {
      outline: none;
      border-color: #FF8802;
      box-shadow: 0 0 0 3px rgba(255, 136, 2, 0.2);
    }
    
    .form-group textarea {
      min-height: 80px;
      resize: vertical;
      font-family: inherit;
    }
    
    .checkbox-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
      gap: 0.75rem;
    }
    
    .checkbox-item {
      display: flex;
      align-items: center;
      padding: 0.75rem;
      background: rgba(255,255,255,0.1);
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.2s;
      min-height: 48px;
    }
    
    .checkbox-item:active {
      background: rgba(255,255,255,0.2);
    }
    
    .checkbox-item input[type="checkbox"],
    .checkbox-item input[type="radio"] {
      width: 20px;
      height: 20px;
      margin-right: 0.5rem;
      cursor: pointer;
      -webkit-appearance: none;
      appearance: none;
      background: rgba(255,255,255,0.9);
      border: 2px solid rgba(255,255,255,0.5);
      border-radius: 4px;
      position: relative;
    }
    
    .checkbox-item input[type="radio"] {
      border-radius: 50%;
    }
    
    .checkbox-item input:checked {
      background: #FF8802;
      border-color: #FF8802;
    }
    
    .checkbox-item input:checked::after {
      content: 'âœ“';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: white;
      font-size: 14px;
      font-weight: bold;
    }
    
    .checkbox-item label {
      font-size: 0.9rem;
      cursor: pointer;
      margin: 0;
      color: #fff;
    }
    
    .loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(12, 44, 84, 0.95);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 10000;
    }
    
    .loading-overlay .loader {
      width: 60px;
      height: 60px;
    }
    
    .loading-overlay h2 {
      margin-top: 1.5rem;
      font-size: 1.3rem;
    }
    
    .loading-overlay p {
      margin-top: 0.5rem;
      font-size: 1rem;
      opacity: 0.8;
    }
    
    .result-card {
      background: rgba(255,255,255,0.95);
      color: #333;
      border-radius: 16px;
      padding: 1.5rem;
      margin-bottom: 1rem;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    
    .result-card .rank {
      display: inline-block;
      background: linear-gradient(135deg, #FF8802 0%, #FF6B00 100%);
      color: white;
      padding: 0.3rem 0.875rem;
      border-radius: 20px;
      font-size: 0.9rem;
      font-weight: 700;
      margin-bottom: 0.75rem;
    }
    
    .result-card h3 {
      font-size: 1.2rem;
      color: #0c2c54;
      margin-bottom: 0.5rem;
      line-height: 1.4;
      border: none;
      padding: 0;
    }
    
    .match-score {
      display: inline-block;
      background: #4CAF50;
      color: white;
      padding: 0.4rem 0.95rem;
      border-radius: 20px;
      font-weight: 700;
      margin-bottom: 1rem;
      font-size: 0.95rem;
    }
    
    .info-text {
      font-size: 0.85rem;
      color: rgba(255,255,255,0.7);
      margin-top: 0.25rem;
      font-style: italic;
    }
    
    @media (max-width: 479px) {
      .container {
        padding: 1rem;
      }
      .header h1 {
        font-size: 1.6rem;
        padding-right: 80px;
      }
      .btn-main {
        padding: 0.6rem 1rem;
        font-size: 0.9rem;
      }
      .card {
        padding: 1.25rem;
      }
      
      /* ìë™ì…ë ¥ ë²„íŠ¼ ëª¨ë°”ì¼ ìµœì í™” */
      .auto-fill-btn {
        padding: 1.2rem;
        font-size: 1.1rem;
        min-height: 56px; /* í„°ì¹˜í•˜ê¸° ì‰¬ìš´ í¬ê¸° */
      }
      
      .auto-fill-btn span {
        font-size: 1.1rem;
      }
    }
    
    /* ë²„íŠ¼ 1í–‰ ê³ ì • */
    button, .btn-primary, .btn-secondary {
      white-space: nowrap !important;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    
    /* íšŒì‚¬ëª… ê²€ìƒ‰ ìë™ì™„ì„± ìŠ¤íƒ€ì¼ */
    .company-search-section {
      background: rgba(255,184,77,0.1);
      border: 2px solid #FFB84D;
      border-radius: 12px;
      padding: 1.5rem;
      margin-bottom: 1.5rem;
    }
    
    .company-search-section h3 {
      font-size: 1.2rem;
      color: #FFB84D;
      margin-bottom: 0.5rem;
    }
    
    .company-search-section .hint {
      font-size: 0.9rem;
      color: rgba(255,255,255,0.7);
      margin-bottom: 1rem;
    }
    
    .search-input-wrapper {
      position: relative;
    }
    
    .search-dropdown {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      background: white;
      border-radius: 8px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.3);
      max-height: 300px;
      overflow-y: auto;
      z-index: 1000;
      margin-top: 0.5rem;
    }
    
    .search-result-item {
      padding: 1rem;
      border-bottom: 1px solid #eee;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .search-result-item:last-child {
      border-bottom: none;
    }
    
    .search-result-item:hover {
      background: #f8f9fa;
    }
    
    .search-result-item .company-name {
      font-weight: 600;
      color: #333;
      margin-bottom: 0.25rem;
    }
    
    .search-result-item .company-info {
      font-size: 0.85rem;
      color: #666;
      display: flex;
      gap: 1rem;
    }
    
    .search-loading,
    .search-error,
    .no-results {
      padding: 1.5rem;
      text-align: center;
      color: #666;
    }
    
    .search-loading {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.5rem;
    }
    
    .search-loading .spinner {
      width: 30px;
      height: 30px;
      border: 3px solid #f3f3f3;
      border-top: 3px solid #FF8802;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    
    .auto-fill-btn {
      width: 100%;
      padding: 1rem;
      background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 1.05rem;
      font-weight: 600;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      transition: all 0.3s;
      white-space: nowrap;
    }
    
    .auto-fill-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 15px rgba(76,175,80,0.4);
    }
    
    .auto-fill-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    
    .hidden {
      display: none !important;
    }
  </style>
</head>
<body>
  <div class="loading-screen" id="loading-screen">
    <div class="loader"></div>
    <div class="loading-text">ì•± ë¡œë”© ì¤‘...</div>
  </div>

  <!-- Google ë¡œê·¸ì¸ í™”ë©´ -->
  <div id="login-screen" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(135deg, #0c2c54 0%, #2a5a8a 100%); z-index: 9999; display: flex; align-items: center; justify-content: center;">
    <div style="background: white; padding: 3rem; border-radius: 20px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); text-align: center; max-width: 400px; width: 90%;">
      <div style="font-size: 4rem; margin-bottom: 1rem;">ğŸ¢</div>
      <h2 style="color: #0c2c54; margin-bottom: 0.5rem; font-size: 1.8rem;">ê¸°ì—… ì§€ì›ì‚¬ì—… AI ë§¤ì¹­</h2>
      <p style="color: #666; margin-bottom: 2rem; font-size: 0.95rem;">êµ¬ê¸€ ë“œë¼ì´ë¸Œì— ì•ˆì „í•˜ê²Œ ì €ì¥ë©ë‹ˆë‹¤</p>
      
      <button id="google-signin-btn" onclick="signInWithGoogle()" style="
        width: 100%;
        padding: 1rem;
        background: white;
        border: 2px solid #ddd;
        border-radius: 8px;
        font-size: 1rem;
        font-weight: 600;
        color: #333;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.75rem;
        transition: all 0.2s;
      " onmouseover="this.style.boxShadow='0 4px 12px rgba(0,0,0,0.15)'" onmouseout="this.style.boxShadow='none'">
        <svg width="20" height="20" viewBox="0 0 24 24">
          <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
          <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
          <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
          <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
        </svg>
        Google ê³„ì •ìœ¼ë¡œ ì‹œì‘í•˜ê¸°
      </button>
      
      <div style="margin-top: 2rem; padding: 1rem; background: #f8f9fa; border-radius: 8px; text-align: left; font-size: 0.85rem; color: #666;">
        <div style="font-weight: 600; margin-bottom: 0.5rem; color: #0c2c54;">ğŸ”’ ì •ë³´ë³´í˜¸</div>
        <div style="line-height: 1.6;">
          â€¢ ë°ì´í„°ëŠ” ì‚¬ìš©ìì˜ êµ¬ê¸€ ë“œë¼ì´ë¸Œì— ì•”í˜¸í™” ì €ì¥<br>
          â€¢ ì–¸ì œë“  ìˆ˜ì •/ì‚­ì œ ê°€ëŠ¥
        </div>
      </div>
    </div>
  </div>

  <div class="container" id="main-content" style="display: none;">
    <div class="header">
      <h1>ğŸ¢ ê¸°ì—… ì§€ì›ì‚¬ì—… AI ë§¤ì¹­</h1>
      <div style="display: flex; align-items: center; gap: 1rem;">
        <div id="user-info" style="font-size: 0.9rem; color: #ddd;"></div>
        <button class="btn-main" onclick="signOut()" style="background: rgba(255,255,255,0.2); border: 1px solid rgba(255,255,255,0.3);">ë¡œê·¸ì•„ì›ƒ</button>
        <button class="btn-main" onclick="goHome()">ë©”ì¸</button>
      </div>
    </div>

    <div class="required-notice">
      <strong>* í‘œì‹œ í•­ëª©ì€ í•„ìˆ˜ ì…ë ¥ ì‚¬í•­ì…ë‹ˆë‹¤</strong>
    </div>

    <!-- 1. ê³ ê°ì‚¬ ì„ íƒ -->
    <div class="card">
      <h2>1. ê³ ê°ì‚¬ ì„ íƒ</h2>
      <div class="form-grid">
        <div class="form-group full-width">
          <label>ì €ì¥ëœ ê³ ê°ì‚¬</label>
          <select id="company-select" onchange="loadSelectedCompany()">
            <option value="">-- ìƒˆë¡œ ì…ë ¥ --</option>
          </select>
        </div>
      </div>
      <button class="btn btn-secondary" onclick="clearForm()" style="margin-top: 1rem;">
        ğŸ”„ ìƒˆë¡œ ì…ë ¥
      </button>
    </div>

    <!-- ì‚¬ìš© ì•ˆë‚´ ì„¹ì…˜ -->
    <!-- íšŒì‚¬ ë¹ ë¥¸ ê²€ìƒ‰ ì„¹ì…˜ (NEW!) -->
    <div class="company-search-section" style="background: linear-gradient(135deg, #FF8802 0%, #FF6B00 100%); border: 2px solid rgba(255,255,255,0.3); padding: 2rem; border-radius: 16px; margin-bottom: 2rem;">
      <h3 style="color: white; margin-bottom: 0.5rem; font-size: 1.4rem;">ğŸ” íšŒì‚¬ ë¹ ë¥¸ ê²€ìƒ‰</h3>
      <p class="hint" style="color: rgba(255,255,255,0.9); margin-bottom: 1.5rem; font-size: 0.95rem;">
        ì‚¬ì—…ìë²ˆí˜¸ë¥¼ ëª¨ë¥´ì‹œë‚˜ìš”? ê¸°ì—…ëª…ìœ¼ë¡œ ê²€ìƒ‰í•˜ì—¬ ì‚¬ì—…ìë²ˆí˜¸ë¥¼ í™•ì¸í•˜ì„¸ìš”!
      </p>
      
      <div style="display: grid; grid-template-columns: 1fr auto; gap: 1rem; align-items: end;">
        <!-- íšŒì‚¬ëª… ì…ë ¥ -->
        <div class="form-group" style="margin: 0;">
          <label style="color: white; font-weight: 600;">íšŒì‚¬ëª…</label>
          <div style="position: relative;">
            <input 
              type="text" 
              id="company-search-input"
              placeholder="ì˜ˆ: ì‚¼ì„±ì „ì"
              autocomplete="off"
              style="width: 100%; padding: 0.875rem; border-radius: 10px; border: 2px solid rgba(255,255,255,0.5); background: rgba(255,255,255,0.95); color: #333; font-size: 16px;">
            
            <!-- ê²€ìƒ‰ ê²°ê³¼ ë“œë¡­ë‹¤ìš´ -->
            <div id="search-results" style="display: none; position: absolute; top: 100%; left: 0; right: 0; background: white; border-radius: 8px; box-shadow: 0 4px 20px rgba(0,0,0,0.3); max-height: 350px; overflow-y: auto; z-index: 1000; margin-top: 0.5rem;"></div>
          </div>
        </div>
        
        <!-- ê²€ìƒ‰ ë²„íŠ¼ -->
        <button id="search-company-btn" class="btn" style="background: white; color: #FF8802; padding: 0.875rem 2rem; border: none; border-radius: 10px; font-size: 1rem; font-weight: 700; cursor: pointer; white-space: nowrap; height: 52px; box-shadow: 0 2px 8px rgba(0,0,0,0.2);">
          ğŸ” ê²€ìƒ‰
        </button>
      </div>
      
      <div style="margin-top: 1rem; padding: 1rem; background: rgba(255,255,255,0.2); border-radius: 8px; border-left: 4px solid white;">
        <p style="margin: 0; color: white; font-size: 0.9rem;">
          ğŸ’¡ <strong>ê²€ìƒ‰ í›„</strong> ì›í•˜ëŠ” ê¸°ì—…ì„ í´ë¦­í•˜ë©´ <strong>ì‚¬ì—…ìë²ˆí˜¸ê°€ ìë™ìœ¼ë¡œ ì…ë ¥</strong>ë©ë‹ˆë‹¤!
        </p>
      </div>
    </div>
    <!-- Section 1: ê¸°ì—… ê¸°ë³¸ì •ë³´ -->
    <div class="card">
      <h2>Section 1. ê¸°ì—… ê¸°ë³¸ì •ë³´</h2>
      
      <h3>1-1. ê¸°ì—… ì‹ë³„ì •ë³´</h3>
      <div class="form-grid">
        <div class="form-group full-width">
          <label>ê¸°ì—…ëª… <span class="required">*</span></label>
          <input type="text" id="company-name" placeholder="ìƒí˜¸ëª…ì„ ì •í™•íˆ ì…ë ¥" required>
        </div>
        
        <div class="form-group">
          <label>ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸ <span class="required">*</span></label>
          <div style="display: flex; align-items: center; gap: 0.5rem;">
            <input type="text" id="business-number-1" placeholder="000" maxlength="3" style="width: 80px;" inputmode="numeric" required oninput="allowOnlyNumbers(this); moveFocusOnMaxLength(this, 'business-number-2', 3)">
            <span style="color: #ddd;">-</span>
            <input type="text" id="business-number-2" placeholder="00" maxlength="2" style="width: 60px;" inputmode="numeric" required oninput="allowOnlyNumbers(this); moveFocusOnMaxLength(this, 'business-number-3', 2)">
            <span style="color: #ddd;">-</span>
            <input type="text" id="business-number-3" placeholder="00000" maxlength="5" style="width: 100px;" inputmode="numeric" required oninput="allowOnlyNumbers(this)">
          </div>
          <span class="info-text">API ìë™ì¡°íšŒ í‚¤</span>
        </div>
        
        <div class="form-group">
          <label>ë²•ì¸ë“±ë¡ë²ˆí˜¸</label>
          <div style="display: flex; align-items: center; gap: 0.5rem;">
            <input type="text" id="corp-number-1" placeholder="000000" maxlength="6" style="width: 100px;" inputmode="numeric" oninput="allowOnlyNumbers(this); moveFocusOnMaxLength(this, 'corp-number-2', 6)">
            <span style="color: #ddd;">-</span>
            <input type="text" id="corp-number-2" placeholder="0000000" maxlength="7" style="width: 120px;" inputmode="numeric" oninput="allowOnlyNumbers(this)">
          </div>
          <span class="info-text">ë²•ì¸ì¸ ê²½ìš° í•„ìˆ˜</span>
        </div>
        
        <div class="form-group">
          <label>ê°œì—…ì—°ì›”ì¼(ì‚¬ì—…ìë“±ë¡ì¦) <span class="required">*</span></label>
          <input type="date" id="establish-date" required>
          <span class="info-text">ì…ë ¥ ì‹œ ì—…ë ¥ ìë™ ê³„ì‚°ë¨</span>
        </div>
      </div>
      
      <!-- ê¸°ì—…ì •ë³´ ìë™ì…ë ¥ ë²„íŠ¼ -->
      <div style="margin-top: 1.5rem;">
        <button type="button" id="auto-fill-btn" class="auto-fill-btn" disabled>
          <span>ğŸ¤–</span>
          <span>ê°€ì ¸ì˜¤ê¸°</span>
        </button>
        <p style="text-align: center; margin-top: 0.75rem; font-size: 0.9rem; color: rgba(255,255,255,0.7);">
          ğŸ’¡ ì‚¬ì—…ìë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ë©´ ë²„íŠ¼ì´ í™œì„±í™”ë©ë‹ˆë‹¤<br>
          í´ë¦­ ì‹œ êµ­ì„¸ì²­, ê¸ˆìœµìœ„ì›íšŒ ë“±ì—ì„œ ìë™ìœ¼ë¡œ ì •ë³´ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤
        </p>
      </div>
      
      <h3>1-2. ê¸°ì—… ë¶„ë¥˜</h3>
      <div class="form-grid">
        <div class="form-group">
          <label>ê¸°ì—… ê·œëª¨ <span class="required">*</span></label>
          <select id="company-size" required>
            <option value="">ì„ íƒí•˜ì„¸ìš”</option>
            <option value="ì˜ˆë¹„ì°½ì—…ì">ì˜ˆë¹„ì°½ì—…ì</option>
            <option value="ì†Œìƒê³µì¸">ì†Œìƒê³µì¸</option>
            <option value="ì†Œê¸°ì—…">ì†Œê¸°ì—…</option>
            <option value="ì¤‘ê¸°ì—…">ì¤‘ê¸°ì—…</option>
            <option value="ì¤‘ê²¬ê¸°ì—…">ì¤‘ê²¬ê¸°ì—…</option>
            <option value="ëŒ€ê¸°ì—…">ëŒ€ê¸°ì—…</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>ê¸°ì—… í˜•íƒœ <span class="required">*</span></label>
          <select id="company-type" required>
            <option value="">ì„ íƒí•˜ì„¸ìš”</option>
            <option value="ê°œì¸ì‚¬ì—…ì">ê°œì¸ì‚¬ì—…ì</option>
            <option value="ë²•ì¸(ì£¼ì‹)">ë²•ì¸(ì£¼ì‹íšŒì‚¬)</option>
            <option value="ë²•ì¸(ìœ í•œ)">ë²•ì¸(ìœ í•œíšŒì‚¬)</option>
            <option value="í˜‘ë™ì¡°í•©">í˜‘ë™ì¡°í•©</option>
            <option value="ì‚¬íšŒì ê¸°ì—…">ì‚¬íšŒì ê¸°ì—…</option>
            <option value="ì†Œì…œë²¤ì²˜">ì†Œì…œë²¤ì²˜</option>
            <option value="ë¹„ì˜ë¦¬">ë¹„ì˜ë¦¬ë²•ì¸</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>ì—…ì¢…(KSIC ì½”ë“œ) <span class="required">*</span></label>
          <select id="ksic-code" required>
            <option value="">ì„ íƒí•˜ì„¸ìš”</option>
            <optgroup label="ì œì¡°ì—…">
              <option value="10">10 - ì‹ë£Œí’ˆ ì œì¡°ì—…</option>
              <option value="11">11 - ìŒë£Œ ì œì¡°ì—…</option>
              <option value="13">13 - ì„¬ìœ ì œí’ˆ ì œì¡°ì—…</option>
              <option value="14">14 - ì˜ë³µ, ì˜ë³µì•¡ì„¸ì„œë¦¬ ë° ëª¨í”¼ì œí’ˆ ì œì¡°ì—…</option>
              <option value="15">15 - ê°€ì£½, ê°€ë°© ë° ì‹ ë°œ ì œì¡°ì—…</option>
              <option value="16">16 - ëª©ì¬ ë° ë‚˜ë¬´ì œí’ˆ ì œì¡°ì—…</option>
              <option value="17">17 - í„í”„, ì¢…ì´ ë° ì¢…ì´ì œí’ˆ ì œì¡°ì—…</option>
              <option value="18">18 - ì¸ì‡„ ë° ê¸°ë¡ë§¤ì²´ ë³µì œì—…</option>
              <option value="19">19 - ì½”í¬ìŠ¤, ì—°íƒ„ ë° ì„ìœ ì •ì œí’ˆ ì œì¡°ì—…</option>
              <option value="20">20 - í™”í•™ë¬¼ì§ˆ ë° í™”í•™ì œí’ˆ ì œì¡°ì—…</option>
              <option value="21">21 - ì˜ë£Œìš© ë¬¼ì§ˆ ë° ì˜ì•½í’ˆ ì œì¡°ì—…</option>
              <option value="22">22 - ê³ ë¬´ ë° í”Œë¼ìŠ¤í‹±ì œí’ˆ ì œì¡°ì—…</option>
              <option value="23">23 - ë¹„ê¸ˆì† ê´‘ë¬¼ì œí’ˆ ì œì¡°ì—…</option>
              <option value="24">24 - 1ì°¨ ê¸ˆì† ì œì¡°ì—…</option>
              <option value="25">25 - ê¸ˆì†ê°€ê³µì œí’ˆ ì œì¡°ì—…</option>
              <option value="26">26 - ì „ìë¶€í’ˆ, ì»´í“¨í„°, ì˜ìƒ, ìŒí–¥ ë° í†µì‹ ì¥ë¹„ ì œì¡°ì—…</option>
              <option value="27">27 - ì˜ë£Œ, ì •ë°€, ê´‘í•™ê¸°ê¸° ë° ì‹œê³„ ì œì¡°ì—…</option>
              <option value="28">28 - ì „ê¸°ì¥ë¹„ ì œì¡°ì—…</option>
              <option value="29">29 - ê¸°íƒ€ ê¸°ê³„ ë° ì¥ë¹„ ì œì¡°ì—…</option>
              <option value="30">30 - ìë™ì°¨ ë° íŠ¸ë ˆì¼ëŸ¬ ì œì¡°ì—…</option>
              <option value="31">31 - ê¸°íƒ€ ìš´ì†¡ì¥ë¹„ ì œì¡°ì—…</option>
              <option value="32">32 - ê°€êµ¬ ì œì¡°ì—…</option>
              <option value="33">33 - ê¸°íƒ€ ì œí’ˆ ì œì¡°ì—…</option>
            </optgroup>
            <optgroup label="ì •ë³´í†µì‹ ì—…">
              <option value="58">58 - ì¶œíŒì—…</option>
              <option value="59">59 - ì˜ìƒÂ·ì˜¤ë””ì˜¤ ê¸°ë¡ë¬¼ ì œì‘ ë° ë°°ê¸‰ì—…</option>
              <option value="60">60 - ë°©ì†¡ì—…</option>
              <option value="61">61 - í†µì‹ ì—…</option>
              <option value="62">62 - ì»´í“¨í„° í”„ë¡œê·¸ë˜ë°, ì‹œìŠ¤í…œ í†µí•© ë° ê´€ë¦¬ì—…</option>
              <option value="63">63 - ì •ë³´ì„œë¹„ìŠ¤ì—…</option>
            </optgroup>
            <optgroup label="ì „ë¬¸, ê³¼í•™ ë° ê¸°ìˆ  ì„œë¹„ìŠ¤ì—…">
              <option value="70">70 - ì—°êµ¬ê°œë°œì—…</option>
              <option value="71">71 - ì „ë¬¸ì„œë¹„ìŠ¤ì—…</option>
              <option value="72">72 - ê±´ì¶•ê¸°ìˆ , ì—”ì§€ë‹ˆì–´ë§ ë° ê¸°íƒ€ ê³¼í•™ê¸°ìˆ  ì„œë¹„ìŠ¤ì—…</option>
              <option value="73">73 - ê¸°íƒ€ ì „ë¬¸, ê³¼í•™ ë° ê¸°ìˆ  ì„œë¹„ìŠ¤ì—…</option>
            </optgroup>
            <optgroup label="ê¸°íƒ€">
              <option value="46">46 - ë„ë§¤ ë° ìƒí’ˆì¤‘ê°œì—…</option>
              <option value="47">47 - ì†Œë§¤ì—…</option>
              <option value="49">49 - ìœ¡ìƒìš´ì†¡ ë° íŒŒì´í”„ë¼ì¸ ìš´ì†¡ì—…</option>
              <option value="52">52 - ì°½ê³  ë° ìš´ì†¡ê´€ë ¨ ì„œë¹„ìŠ¤ì—…</option>
              <option value="56">56 - ìŒì‹ì  ë° ì£¼ì ì—…</option>
              <option value="64">64 - ê¸ˆìœµì—…</option>
              <option value="65">65 - ë³´í—˜ ë° ì—°ê¸ˆì—…</option>
              <option value="66">66 - ê¸ˆìœµ ë° ë³´í—˜ ê´€ë ¨ ì„œë¹„ìŠ¤ì—…</option>
              <option value="85">85 - êµìœ¡ ì„œë¹„ìŠ¤ì—…</option>
              <option value="86">86 - ë³´ê±´ì—…</option>
              <option value="87">87 - ì‚¬íšŒë³µì§€ ì„œë¹„ìŠ¤ì—…</option>
            </optgroup>
          </select>
          <span class="info-text">í‘œì¤€ì‚°ì—…ë¶„ë¥˜ ì¤‘ë¶„ë¥˜ ì½”ë“œ</span>
        </div>
        
        <div class="form-group full-width">
          <label>ì£¼ë ¥ ì œí’ˆ/ì„œë¹„ìŠ¤ í‚¤ì›Œë“œ</label>
          <input type="text" id="product-keywords" placeholder="í‚¤ì›Œë“œ 3ê°œ ì´ë‚´ (ì˜ˆ: AIì±—ë´‡, ê³ ê°ê´€ë¦¬SW, í´ë¼ìš°ë“œ)">
        </div>
      </div>
      
      <h3>1-3. ì‚¬ì—…ì¥ ì •ë³´</h3>
      <div class="form-grid">
        <div class="form-group">
          <label>ë³¸ì  ì†Œì¬ì§€ (ì‹œë„) <span class="required">*</span></label>
          <select id="location-sido" required onchange="updateSigunguOptions()">
            <option value="">ì„ íƒí•˜ì„¸ìš”</option>
            <option value="ì„œìš¸">ì„œìš¸</option>
            <option value="ê²½ê¸°">ê²½ê¸°</option>
            <option value="ì¸ì²œ">ì¸ì²œ</option>
            <option value="ë¶€ì‚°">ë¶€ì‚°</option>
            <option value="ëŒ€êµ¬">ëŒ€êµ¬</option>
            <option value="ëŒ€ì „">ëŒ€ì „</option>
            <option value="ê´‘ì£¼">ê´‘ì£¼</option>
            <option value="ìš¸ì‚°">ìš¸ì‚°</option>
            <option value="ì„¸ì¢…">ì„¸ì¢…</option>
            <option value="ê°•ì›">ê°•ì›</option>
            <option value="ì¶©ë¶">ì¶©ë¶</option>
            <option value="ì¶©ë‚¨">ì¶©ë‚¨</option>
            <option value="ì „ë¶">ì „ë¶</option>
            <option value="ì „ë‚¨">ì „ë‚¨</option>
            <option value="ê²½ë¶">ê²½ë¶</option>
            <option value="ê²½ë‚¨">ê²½ë‚¨</option>
            <option value="ì œì£¼">ì œì£¼</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>ì‹œêµ°êµ¬</label>
          <select id="location-sigungu">
            <option value="">ì‹œë„ë¥¼ ë¨¼ì € ì„ íƒí•˜ì„¸ìš”</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>ì‚°ì—…ë‹¨ì§€ ì…ì£¼</label>
          <select id="industrial-complex">
            <option value="ë¯¸ì…ì£¼">ë¯¸ì…ì£¼</option>
            <option value="ì¼ë°˜ì‚°ë‹¨">ì¼ë°˜ì‚°ë‹¨</option>
            <option value="êµ­ê°€ì‚°ë‹¨">êµ­ê°€ì‚°ë‹¨</option>
            <option value="ì§€ë°©ì‚°ë‹¨">ì§€ë°©ì‚°ë‹¨</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>ìˆ˜ë„ê¶Œ ì—¬ë¶€ <span class="required">*</span></label>
          <select id="capital-area" required disabled>
            <option value="">ìë™ ì„¤ì •ë¨</option>
            <option value="Y">ì˜ˆ (ì„œìš¸/ê²½ê¸°/ì¸ì²œ)</option>
            <option value="N">ì•„ë‹ˆì˜¤ (ì§€ë°©)</option>
          </select>
        </div>
      </div>
    </div>

    <!-- Section 2: ëŒ€í‘œì ì •ë³´ -->
    <div class="card">
      <h2>Section 2. ëŒ€í‘œì ì •ë³´</h2>
      <div class="form-grid">
        <div class="form-group">
          <label>ëŒ€í‘œì ì„±ëª… <span class="required">*</span></label>
          <input type="text" id="ceo-name" required>
        </div>
        
        <div class="form-group">
          <label>ìƒë…„ì›”ì¼ <span class="required">*</span></label>
          <input type="date" id="ceo-birth" required>
          <span class="info-text">ì²­ë…„(ë§Œ39ì„¸â†“) íŒì •</span>
        </div>
        
        <div class="form-group">
          <label>ì„±ë³„ <span class="required">*</span></label>
          <select id="ceo-gender" required>
            <option value="">ì„ íƒí•˜ì„¸ìš”</option>
            <option value="ë‚¨">ë‚¨</option>
            <option value="ì—¬">ì—¬</option>
          </select>
          <span class="info-text">ì—¬ì„±ê¸°ì—… ì „ìš© íŠ¸ë™</span>
        </div>
        
        <div class="form-group">
          <label>ì¥ì• ì¸ ì—¬ë¶€</label>
          <select id="ceo-disabled">
            <option value="N">ì•„ë‹ˆì˜¤</option>
            <option value="Y">ì˜ˆ</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>êµ­ê°€ë³´í›ˆëŒ€ìƒì</label>
          <select id="ceo-veteran">
            <option value="N">ì•„ë‹ˆì˜¤</option>
            <option value="Y">ì˜ˆ</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>ë¶í•œì´íƒˆì£¼ë¯¼</label>
          <select id="ceo-defector">
            <option value="N">ì•„ë‹ˆì˜¤</option>
            <option value="Y">ì˜ˆ</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>ì¬ì°½ì—… ì—¬ë¶€</label>
          <select id="ceo-restart">
            <option value="ì´ˆì°½ì—…">ì´ˆì°½ì—…</option>
            <option value="ì¬ì°½ì—…">ì¬ì°½ì—…</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>ì—°ëŒ€ë³´ì¦ ë©´ì œ ëŒ€ìƒ</label>
          <select id="guarantee-exempt">
            <option value="N">ì•„ë‹ˆì˜¤</option>
            <option value="Y">ì˜ˆ</option>
          </select>
        </div>
      </div>
    </div>

    <!-- Section 3: ì¬ë¬´ ë° ì‹ ìš©ì •ë³´ -->
    <div class="card">
      <h2>Section 3. ì¬ë¬´ ë° ì‹ ìš©ì •ë³´</h2>
      
      <h3>3-1. ì¬ë¬´ í˜„í™© (ìµœê·¼ 3ê°œë…„)</h3>
      <div class="form-grid">
        <div class="form-group">
          <label>ë§¤ì¶œì•¡ - ìµœê·¼ë…„ë„ (ì–µì›) <span class="required">*</span></label>
          <input type="number" id="revenue-recent" placeholder="ì˜ˆ: 15" required>
        </div>
        
        <div class="form-group">
          <label>ë§¤ì¶œì•¡ - ì „ë…„ë„ (ì–µì›)</label>
          <input type="number" id="revenue-prev1" placeholder="ì˜ˆ: 12">
        </div>
        
        <div class="form-group">
          <label>ë§¤ì¶œì•¡ - ì „ì „ë…„ë„ (ì–µì›)</label>
          <input type="number" id="revenue-prev2" placeholder="ì˜ˆ: 10">
        </div>
        
        <div class="form-group">
          <label>ì˜ì—…ì´ìµ - ìµœê·¼ë…„ë„ (ì–µì›)</label>
          <input type="number" id="profit-recent" placeholder="ì˜ˆ: 2">
        </div>
        
        <div class="form-group">
          <label>ìë³¸ê¸ˆ (ì–µì›)</label>
          <input type="number" id="capital" placeholder="ì˜ˆ: 5">
        </div>
        
        <div class="form-group">
          <label>ìë³¸ì´ê³„ (ì–µì›)</label>
          <input type="number" id="total-equity" placeholder="ì˜ˆ: 8">
        </div>
        
        <div class="form-group">
          <label>ë¶€ì±„ì´ê³„ (ì–µì›)</label>
          <input type="number" id="total-debt" placeholder="ì˜ˆ: 7">
        </div>
        
        <div class="form-group">
          <label>ë¶€ì±„ë¹„ìœ¨ (%)</label>
          <input type="number" id="debt-ratio" placeholder="ì˜ˆ: 87.5">
        </div>
      </div>
      
      <h3>3-2. ê²°ê²©ì‚¬ìœ  ì²´í¬</h3>
      <div class="form-grid">
        <div class="form-group">
          <label>êµ­ì„¸ ì²´ë‚© <span class="required">*</span></label>
          <select id="tax-arrears" required>
            <option value="N">ì—†ìŒ</option>
            <option value="Y">ìˆìŒ</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>ì§€ë°©ì„¸ ì²´ë‚© <span class="required">*</span></label>
          <select id="local-tax-arrears" required>
            <option value="N">ì—†ìŒ</option>
            <option value="Y">ìˆìŒ</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>4ëŒ€ë³´í—˜ ë¯¸ë‚©/ì²´ë‚©</label>
          <select id="insurance-arrears">
            <option value="N">ì—†ìŒ</option>
            <option value="Y">ìˆìŒ</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>ì™„ì „ìë³¸ì ì‹</label>
          <select id="capital-erosion">
            <option value="N">ì•„ë‹ˆì˜¤</option>
            <option value="Y">ì˜ˆ</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>ë¶€ë„/íšŒìƒ/íŒŒì‚° ì´ë ¥</label>
          <select id="bankruptcy-history">
            <option value="N">ì—†ìŒ</option>
            <option value="Y">ìˆìŒ</option>
          </select>
        </div>
      </div>
      
      <h3>3-3. ì‹ ìš©ì •ë³´</h3>
      <div class="form-grid">
        <div class="form-group">
          <label>ê¸°ì—…ì‹ ìš©ë“±ê¸‰</label>
          <select id="credit-rating">
            <option value="">ì„ íƒí•˜ì„¸ìš”</option>
            <option value="AAA">AAA</option>
            <option value="AA">AA</option>
            <option value="A">A</option>
            <option value="BBB">BBB</option>
            <option value="BB">BB</option>
            <option value="B">B</option>
            <option value="CCC">CCC</option>
            <option value="CC">CC</option>
            <option value="C">C</option>
            <option value="D">D</option>
          </select>
          <span class="info-text">ë‚˜ì´ìŠ¤/KIS ê¸°ì¤€</span>
        </div>
        
        <div class="form-group">
          <label>ê¸°ìˆ ì‹ ìš©í‰ê°€(TCB) ë“±ê¸‰</label>
          <select id="tcb-rating">
            <option value="">ì„ íƒí•˜ì„¸ìš”</option>
            <option value="T-1">T-1</option>
            <option value="T-2">T-2</option>
            <option value="T-3">T-3</option>
            <option value="T-4">T-4</option>
            <option value="T-5">T-5</option>
            <option value="T-6">T-6</option>
            <option value="T-7">T-7</option>
            <option value="T-8">T-8</option>
            <option value="T-9">T-9</option>
            <option value="T-10">T-10</option>
          </select>
        </div>
      </div>
    </div>

    <!-- Section 4: ê³ ìš© ì •ë³´ -->
    <div class="card">
      <h2>
        Section 4. ê³ ìš© ì •ë³´
        <span class="section-info-icon">
          i
          <span class="section-info-tooltip">
            âš ï¸ ê°œì¸ì •ë³´ë³´í˜¸ë²•ìœ¼ë¡œ ì¸í•´ ìë™ ì¡°íšŒê°€ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤. ìˆ˜ë™ìœ¼ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.
          </span>
        </span>
      </h2>
      
      <h3>4-1. ì¸ë ¥ í˜„í™©</h3>
      <div class="form-grid">
        <div class="form-group">
          <label>ìƒì‹œê·¼ë¡œì ìˆ˜ (ëª…) <span class="required">*</span></label>
          <input type="number" id="employees-total" placeholder="ëŒ€í‘œì ì œì™¸" required>
        </div>
        
        <div class="form-group">
          <label>ì „ë…„ë„ ê·¼ë¡œì ìˆ˜ (ëª…)</label>
          <input type="number" id="employees-prev" placeholder="ì „ë…„ë„">
        </div>
        
        <div class="form-group">
          <label>ì²­ë…„ ê³ ìš© (ë§Œ15~34ì„¸)</label>
          <input type="number" id="employees-youth" placeholder="ì²­ë…„ ì¸ì›">
          <span class="info-text">ì²­ë…„ê³ ìš© ê°€ì </span>
        </div>
        
        <div class="form-group">
          <label>ì—¬ì„± ê³ ìš©</label>
          <input type="number" id="employees-female" placeholder="ì—¬ì„± ì¸ì›">
          <span class="info-text">ì—¬ì„±ê³ ìš© ê°€ì </span>
        </div>
        
        <div class="form-group">
          <label>ì¥ì• ì¸ ê³ ìš©</label>
          <input type="number" id="employees-disabled" placeholder="ì¥ì• ì¸ ì¸ì›">
        </div>
        
        <div class="form-group">
          <label>ê³ ë ¹ì ê³ ìš© (ë§Œ60ì„¸ ì´ìƒ)</label>
          <input type="number" id="employees-senior" placeholder="ê³ ë ¹ì ì¸ì›">
        </div>
        
        <div class="form-group">
          <label>ë¹„ì •ê·œì§ ë¹„ìœ¨ (%)</label>
          <input type="number" id="irregular-ratio" placeholder="ì˜ˆ: 20">
        </div>
      </div>
      
      <h3>4-2. ì±„ìš© ê³„íš</h3>
      <div class="form-grid">
        <div class="form-group">
          <label>í–¥í›„ 6ê°œì›” ì±„ìš© ê³„íš (ëª…)</label>
          <input type="number" id="hiring-plan" placeholder="ì˜ˆì • ì¸ì›">
        </div>
        
        <div class="form-group full-width">
          <label>ìš°ì„  ì±„ìš© ë¶„ì•¼</label>
          <input type="text" id="hiring-field" placeholder="ì˜ˆ: ì—°êµ¬ê°œë°œ, ìƒì‚°, ì˜ì—…ë§ˆì¼€íŒ…">
        </div>
      </div>
      
      <h3>4-3. ê³ ìš© ì•ˆì •ì„± (ê³ ìš©ì§€ì›ê¸ˆ í•„ìˆ˜)</h3>
      <div class="form-grid">
        <div class="form-group">
          <label>ìµœê·¼ ì‹ ê·œ ì±„ìš©ì¼ <span style="color: #FFB84D;">â˜…</span></label>
          <input type="date" id="recent-hire-date">
          <span class="info-text">ìµœê·¼ 6ê°œì›” ë‚´ ì±„ìš© ì‹œ í•„ìˆ˜</span>
        </div>
        
        <div class="form-group">
          <label>ê·¼ë¡œê³„ì•½ í˜•íƒœ <span style="color: #FFB84D;">â˜…</span></label>
          <select id="contract-type">
            <option value="">ì„ íƒ</option>
            <option value="ì •ê·œì§">ì •ê·œì§</option>
            <option value="ê³„ì•½ì§">ê³„ì•½ì§ (ê¸°ê°„ì œ)</option>
            <option value="íŒŒíŠ¸íƒ€ì„">íŒŒíŠ¸íƒ€ì„</option>
            <option value="ê³„ì•½ì§ì „í™˜">ê³„ì•½ì§â†’ì •ê·œì§ ì „í™˜</option>
          </select>
          <span class="info-text">ì •ê·œì§ ì „í™˜ ì‹œ ë³„ë„ ì§€ì›ê¸ˆ</span>
        </div>
        
        <div class="form-group">
          <label>ìµœê·¼ 6ê°œì›” ê°ì› ì—¬ë¶€ <span style="color: #ff6b6b;">âš ï¸</span></label>
          <select id="layoff-recent">
            <option value="ì—†ìŒ">ì—†ìŒ</option>
            <option value="ê¶Œê³ ì‚¬ì§">ìˆìŒ (ê¶Œê³ ì‚¬ì§)</option>
            <option value="ì •ë¦¬í•´ê³ ">ìˆìŒ (ì •ë¦¬í•´ê³ )</option>
            <option value="ìì—°í‡´ì‚¬">ìì—° í‡´ì‚¬ë§Œ ìˆìŒ</option>
          </select>
          <span class="info-text" style="color: #ff6b6b;">
            âš ï¸ ê°ì› ì‹œ ëŒ€ë¶€ë¶„ ì§€ì›ê¸ˆ ì œì™¸
          </span>
        </div>
        
        <div class="form-group">
          <label>í‰ê·  ì›” ì„ê¸ˆ (ë§Œì›) <span style="color: #FFB84D;">â˜…</span></label>
          <input type="number" id="avg-monthly-wage" placeholder="ì˜ˆ: 300">
          <span class="info-text">ìµœì €ì„ê¸ˆ ì´ìƒ í•„ìˆ˜</span>
        </div>
        
        <div class="form-group">
          <label>ëŒ€í‘œì ê°€ì¡± ê³ ìš© ì—¬ë¶€</label>
          <select id="family-employee">
            <option value="ì—†ìŒ">ì—†ìŒ</option>
            <option value="ë°°ìš°ì">ë°°ìš°ì ê³ ìš©</option>
            <option value="ì§ê³„ì¡´ë¹„ì†">ì§ê³„ ì¡´ë¹„ì† ê³ ìš©</option>
            <option value="ê¸°íƒ€ì¹œì¸ì²™">ê¸°íƒ€ ì¹œì¸ì²™</option>
          </select>
          <span class="info-text">ê°€ì¡± ê³ ìš© ì‹œ ì¼ë¶€ ì§€ì›ê¸ˆ ì œì™¸</span>
        </div>
        
        <div class="form-group">
          <label>ê²½ë ¥ë‹¨ì ˆ ì—¬ì„± ê³ ìš© (ëª…)</label>
          <input type="number" id="career-break-women" placeholder="ì¸ì›">
          <span class="info-text">ì›Œë¼ë°¸ ì¼ìë¦¬ ì§€ì›ê¸ˆ ê°€ì </span>
        </div>
        
        <div class="form-group">
          <label>íœ´ì—…/íœ´ì§ ì‹¤ì‹œ ì—¬ë¶€</label>
          <select id="leave-status">
            <option value="ì—†ìŒ">ì—†ìŒ</option>
            <option value="íœ´ì—…">íœ´ì—… ì‹¤ì‹œ ì¤‘</option>
            <option value="íœ´ì§">íœ´ì§ì ìˆìŒ</option>
          </select>
          <span class="info-text">ê³ ìš©ìœ ì§€ì§€ì›ê¸ˆ ì‹ ì²­ ê°€ëŠ¥</span>
        </div>
        
        <div class="form-group">
          <label>ì„ê¸ˆ ì²´ë¶ˆ ì—¬ë¶€ <span style="color: #ff6b6b;">âš ï¸</span></label>
          <select id="wage-unpaid">
            <option value="ì—†ìŒ">ì—†ìŒ</option>
            <option value="ìˆìŒ">ìˆìŒ</option>
          </select>
          <span class="info-text" style="color: #ff6b6b;">
            âš ï¸ ì²´ë¶ˆ ì‹œ ëª¨ë“  ì§€ì›ê¸ˆ ì œì™¸
          </span>
        </div>
      </div>
    </div>

    <!-- Section 5: ê¸°ìˆ  ë° ì¸ì¦ ì •ë³´ -->
    <div class="card">
      <h2>Section 5. ê¸°ìˆ  ë° ì¸ì¦ ì •ë³´</h2>
      
      <h3>5-1. ê¸°ì—… ì¸ì¦ (ìœ íš¨ê¸°ê°„ í™•ì¸ í•„ìˆ˜)</h3>
      <div class="form-grid">
        <div class="form-group">
          <label>ë²¤ì²˜ê¸°ì—… ì¸ì¦</label>
          <select id="cert-venture">
            <option value="N">ì—†ìŒ</option>
            <option value="Y">ìˆìŒ</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>ë²¤ì²˜ê¸°ì—… ë§Œë£Œì¼</label>
          <input type="date" id="cert-venture-expire">
        </div>
        
        <div class="form-group">
          <label>ì´ë…¸ë¹„ì¦ˆ(ê¸°ìˆ í˜ì‹ )</label>
          <select id="cert-innobiz">
            <option value="N">ì—†ìŒ</option>
            <option value="Y">ìˆìŒ</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>ì´ë…¸ë¹„ì¦ˆ ë§Œë£Œì¼</label>
          <input type="date" id="cert-innobiz-expire">
        </div>
        
        <div class="form-group">
          <label>ë©”ì¸ë¹„ì¦ˆ(ê²½ì˜í˜ì‹ )</label>
          <select id="cert-mainbiz">
            <option value="N">ì—†ìŒ</option>
            <option value="Y">ìˆìŒ</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>ë©”ì¸ë¹„ì¦ˆ ë§Œë£Œì¼</label>
          <input type="date" id="cert-mainbiz-expire">
        </div>
        
        <div class="form-group">
          <label>ë…¹ìƒ‰ì¸ì¦ê¸°ì—…</label>
          <select id="cert-green">
            <option value="N">ì—†ìŒ</option>
            <option value="Y">ìˆìŒ</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>ì†Œì¬ë¶€í’ˆì¥ë¹„ ì „ë¬¸ê¸°ì—…</label>
          <select id="cert-materials">
            <option value="N">ì—†ìŒ</option>
            <option value="Y">ìˆìŒ</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>ë¿Œë¦¬ê¸°ì—…</label>
          <select id="cert-root">
            <option value="N">ì—†ìŒ</option>
            <option value="Y">ìˆìŒ</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>World Class 300</label>
          <select id="cert-worldclass">
            <option value="N">ì—†ìŒ</option>
            <option value="Y">ìˆìŒ</option>
          </select>
        </div>
      </div>
      
      <h3>5-2. ì—°êµ¬ê°œë°œ ì—­ëŸ‰</h3>
      <div class="form-grid">
        <div class="form-group">
          <label>ì—°êµ¬ì¡°ì§</label>
          <select id="research-org">
            <option value="ì—†ìŒ">ì—†ìŒ</option>
            <option value="ê¸°ì—…ë¶€ì„¤ì—°êµ¬ì†Œ">ê¸°ì—…ë¶€ì„¤ì—°êµ¬ì†Œ</option>
            <option value="ì—°êµ¬ê°œë°œì „ë‹´ë¶€ì„œ">ì—°êµ¬ê°œë°œì „ë‹´ë¶€ì„œ</option>
          </select>
          <span class="info-text">ê¸°ìˆ ê°œë°œì‚¬ì—… í•„ìˆ˜</span>
        </div>
        
        <div class="form-group">
          <label>ì „ë‹´ ì—°êµ¬ì› (ëª…)</label>
          <input type="number" id="researchers" placeholder="ì—°êµ¬ì¸ë ¥">
        </div>
        
        <div class="form-group">
          <label>R&D íˆ¬ìì•¡ (ì–µì›)</label>
          <input type="number" id="rd-investment" placeholder="ìµœê·¼ë…„ë„">
        </div>
        
        <div class="form-group">
          <label>R&D íˆ¬ì ë¹„ìœ¨ (%)</label>
          <input type="number" id="rd-ratio" placeholder="ë§¤ì¶œ ëŒ€ë¹„">
        </div>
        
        <div class="form-group">
          <label>íŠ¹í—ˆ ë“±ë¡ (ê±´)</label>
          <input type="number" id="patents-registered" placeholder="ë“±ë¡">
        </div>
        
        <div class="form-group">
          <label>íŠ¹í—ˆ ì¶œì› (ê±´)</label>
          <input type="number" id="patents-applied" placeholder="ì¶œì›">
        </div>
        
        <div class="form-group">
          <label>ìƒí‘œê¶Œ ë“±ë¡ (ê±´)</label>
          <input type="number" id="trademarks" placeholder="ìƒí‘œê¶Œ">
        </div>
        
        <div class="form-group">
          <label>ê¸°ìˆ ì´ì „ ê²½í—˜</label>
          <select id="tech-transfer">
            <option value="N">ì—†ìŒ</option>
            <option value="Y">ìˆìŒ</option>
          </select>
        </div>
      </div>
      
      <h3>5-3. ìƒì‚° ë° í’ˆì§ˆ ì¸ì¦</h3>
      <div class="checkbox-grid">
        <div class="checkbox-item">
          <input type="checkbox" id="iso-9001" value="ISO9001">
          <label for="iso-9001">ISO 9001 (í’ˆì§ˆ)</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="iso-14001" value="ISO14001">
          <label for="iso-14001">ISO 14001 (í™˜ê²½)</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="iso-45001" value="ISO45001">
          <label for="iso-45001">ISO 45001 (ì•ˆì „)</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="cert-gmp" value="GMP">
          <label for="cert-gmp">GMP</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="cert-kc" value="KC/KS">
          <label for="cert-kc">KC/KS ì¸ì¦</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="cert-haccp" value="HACCP">
          <label for="cert-haccp">HACCP</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="cert-fda" value="FDA">
          <label for="cert-fda">FDA</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="cert-ce" value="CE">
          <label for="cert-ce">CE</label>
        </div>
      </div>
      
      <h3>5-4. ESG ë° ìŠ¤ë§ˆíŠ¸í™”</h3>
      <div class="form-grid">
        <div class="form-group">
          <label>ESG í‰ê°€ë“±ê¸‰</label>
          <select id="esg-rating">
            <option value="ë¯¸í‰ê°€">ë¯¸í‰ê°€</option>
            <option value="S">S</option>
            <option value="A">A</option>
            <option value="B">B</option>
            <option value="C">C</option>
            <option value="D">D</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>íƒ„ì†Œì¤‘ë¦½ ì„ ì–¸/ì´í–‰</label>
          <select id="carbon-neutral">
            <option value="N">ì•„ë‹ˆì˜¤</option>
            <option value="Y">ì˜ˆ</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>ìŠ¤ë§ˆíŠ¸ê³µì¥ ìˆ˜ì¤€</label>
          <select id="smart-factory">
            <option value="Level0">Level 0 (ë¯¸êµ¬ì¶•)</option>
            <option value="Level1">Level 1 (ê¸°ì´ˆ)</option>
            <option value="Level2">Level 2 (ì¤‘ê°„1)</option>
            <option value="Level3">Level 3 (ì¤‘ê°„2)</option>
            <option value="Level4">Level 4 (ê³ ë„í™”)</option>
            <option value="Level5">Level 5 (ìµœê³ )</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>ë””ì§€í„¸ì „í™˜(DX) ë‹¨ê³„</label>
          <select id="digital-transform">
            <option value="ê´€ì‹¬">ê´€ì‹¬</option>
            <option value="ë„ì…">ë„ì…</option>
            <option value="í™•ì‚°">í™•ì‚°</option>
            <option value="ê³ ë„í™”">ê³ ë„í™”</option>
          </select>
        </div>
      </div>
    </div>

    <!-- Section 6: ìˆ˜ì¶œ ë° í•´ì™¸ì§„ì¶œ -->
    <div class="card">
      <h2>Section 6. ìˆ˜ì¶œ ë° í•´ì™¸ì§„ì¶œ</h2>
      <div class="form-grid">
        <div class="form-group">
          <label>ìˆ˜ì¶œ ì‹¤ì  - ìµœê·¼ë…„ë„ ($)</label>
          <input type="number" id="export-recent" placeholder="ì˜ˆ: 100000">
        </div>
        
        <div class="form-group">
          <label>ìˆ˜ì¶œ ì‹¤ì  - ì „ë…„ë„ ($)</label>
          <input type="number" id="export-prev" placeholder="ì˜ˆ: 80000">
        </div>
        
        <div class="form-group full-width">
          <label>ì£¼ìš” ìˆ˜ì¶œêµ­</label>
          <input type="text" id="export-countries" placeholder="ë§¤ì¶œë¹„ì¤‘ ìƒìœ„ 3ê°œêµ­ (ì˜ˆ: ë¯¸êµ­, ì¤‘êµ­, ì¼ë³¸)">
        </div>
        
        <div class="form-group">
          <label>HS CODE (ì£¼ë ¥ ìˆ˜ì¶œí’ˆëª©)</label>
          <input type="text" id="hs-code" placeholder="6~10ìë¦¬">
        </div>
        
        <div class="form-group full-width">
          <label>í•´ì™¸ ì¸ì¦</label>
          <input type="text" id="overseas-cert" placeholder="ì˜ˆ: FDA, CE, UL, JIS">
        </div>
        
        <div class="form-group">
          <label>í•´ì™¸ ë²•ì¸/ì§€ì‚¬</label>
          <select id="overseas-office">
            <option value="N">ì—†ìŒ</option>
            <option value="Y">ìˆìŒ</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>í•´ì™¸ ë²•ì¸ êµ­ê°€</label>
          <input type="text" id="overseas-country" placeholder="êµ­ê°€ëª…">
        </div>
        
        <div class="form-group">
          <label>FTA í™œìš©</label>
          <select id="fta-use">
            <option value="N">ì•„ë‹ˆì˜¤</option>
            <option value="Y">ì˜ˆ</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>ìˆ˜ì¶œë°”ìš°ì²˜ ì´ìš© ê²½í—˜</label>
          <select id="export-voucher">
            <option value="N">ì—†ìŒ</option>
            <option value="Y">ìˆìŒ</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>í•´ì™¸ì „ì‹œíšŒ ì°¸ê°€ (ìµœê·¼ 3ë…„)</label>
          <input type="number" id="overseas-exhibition" placeholder="ì°¸ê°€ íšŸìˆ˜">
        </div>
      </div>
    </div>

    <!-- Section 7: ì •ë¶€ì§€ì› ì´ë ¥ -->
    <div class="card">
      <h2>Section 7. ì •ë¶€ì§€ì› ì´ë ¥</h2>
      
      <h3>7-1. ìµœê·¼ 3ë…„ ì§€ì›ì‚¬ì—… ì´ë ¥</h3>
      <div class="form-grid">
        <div class="form-group full-width">
          <label>2024ë…„ ì§€ì›ì‚¬ì—…</label>
          <textarea id="support-2024" placeholder="ì‚¬ì—…ëª…, ì§€ì›ê¸°ê´€, ê¸ˆì•¡ (ì˜ˆ: ê¸°ìˆ ê°œë°œì‚¬ì—…, ì¤‘ì†Œë²¤ì²˜ê¸°ì—…ë¶€, 5ì²œë§Œì›)"></textarea>
        </div>
        
        <div class="form-group full-width">
          <label>2023ë…„ ì§€ì›ì‚¬ì—…</label>
          <textarea id="support-2023" placeholder="ì‚¬ì—…ëª…, ì§€ì›ê¸°ê´€, ê¸ˆì•¡"></textarea>
        </div>
        
        <div class="form-group full-width">
          <label>2022ë…„ ì§€ì›ì‚¬ì—…</label>
          <textarea id="support-2022" placeholder="ì‚¬ì—…ëª…, ì§€ì›ê¸°ê´€, ê¸ˆì•¡"></textarea>
        </div>
      </div>
      
      <h3>7-2. ì œì¬/ë¶ˆì´ìµ ì´ë ¥</h3>
      <div class="form-grid">
        <div class="form-group">
          <label>ì •ë¶€ì‚¬ì—… ì¤‘ë„í¬ê¸°</label>
          <select id="project-abandon">
            <option value="N">ì—†ìŒ</option>
            <option value="Y">ìˆìŒ</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>ì •ë¶€ì‚¬ì—… í™˜ìˆ˜ ì¡°ì¹˜</label>
          <select id="subsidy-return">
            <option value="N">ì—†ìŒ</option>
            <option value="Y">ìˆìŒ</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>ì°¸ì—¬ì œí•œ ì¡°ì¹˜</label>
          <select id="participation-ban">
            <option value="N">ì—†ìŒ</option>
            <option value="Y">ìˆìŒ</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>ë¶€ì •ìˆ˜ê¸‰ ì´ë ¥</label>
          <select id="fraud-history">
            <option value="N">ì—†ìŒ</option>
            <option value="Y">ìˆìŒ</option>
          </select>
        </div>
      </div>
    </div>

    <!-- Section 8: íŠ¹í™” ê¸°ì—… ë¶„ë¥˜ -->
    <div class="card">
      <h2>Section 8. íŠ¹í™” ê¸°ì—… ë¶„ë¥˜</h2>
      <div class="checkbox-grid">
        <div class="checkbox-item">
          <input type="checkbox" id="social-enterprise" value="ì‚¬íšŒì ê¸°ì—…">
          <label for="social-enterprise">ì‚¬íšŒì ê¸°ì—…</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="social-venture" value="ì†Œì…œë²¤ì²˜">
          <label for="social-venture">ì†Œì…œë²¤ì²˜</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="preliminary-social" value="ì˜ˆë¹„ì‚¬íšŒì ê¸°ì—…">
          <label for="preliminary-social">ì˜ˆë¹„ì‚¬íšŒì ê¸°ì—…</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="village-enterprise" value="ë§ˆì„ê¸°ì—…">
          <label for="village-enterprise">ë§ˆì„ê¸°ì—…</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="cooperative" value="í˜‘ë™ì¡°í•©">
          <label for="cooperative">í˜‘ë™ì¡°í•©</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="agri-enterprise" value="ë†ê³µìƒìœµí•©">
          <label for="agri-enterprise">ë†ê³µìƒìœµí•©ê¸°ì—…</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="strong-small" value="ê°•ì†Œê¸°ì—…">
          <label for="strong-small">ê°•ì†Œê¸°ì—…</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="hidden-champion" value="íˆë“ ì±”í”¼ì–¸">
          <label for="hidden-champion">íˆë“ ì±”í”¼ì–¸</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="family-friendly" value="ê°€ì¡±ì¹œí™”ê¸°ì—…">
          <label for="family-friendly">ê°€ì¡±ì¹œí™” ì¸ì¦ê¸°ì—…</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="youth-friendly" value="ì²­ë…„ì¹œí™”ê°•ì†Œê¸°ì—…">
          <label for="youth-friendly">ì²­ë…„ì¹œí™” ê°•ì†Œê¸°ì—…</label>
        </div>
      </div>
    </div>

    <!-- Section 9: í¬ë§ ì§€ì›ë¶„ì•¼ -->
    <div class="card">
      <h2>Section 9. í¬ë§ ì§€ì›ë¶„ì•¼ <span class="required">*</span></h2>
      
      <h3>9-1. ì§€ì› í•„ìš” ë¶„ì•¼ (ì¤‘ë³µì„ íƒ ê°€ëŠ¥)</h3>
      <div class="checkbox-grid">
        <div class="checkbox-item">
          <input type="checkbox" id="support-funding" value="ì •ì±…ìê¸ˆ">
          <label for="support-funding">ì •ì±…ìê¸ˆ</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="support-rd" value="ê¸°ìˆ ê°œë°œ">
          <label for="support-rd">ê¸°ìˆ ê°œë°œ(R&D)</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="support-commercialize" value="ì‚¬ì—…í™”">
          <label for="support-commercialize">ì‚¬ì—…í™”</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="support-marketing" value="íŒë¡œë§ˆì¼€íŒ…">
          <label for="support-marketing">íŒë¡œ/ë§ˆì¼€íŒ…</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="support-export" value="ìˆ˜ì¶œì§€ì›">
          <label for="support-export">ìˆ˜ì¶œì§€ì›</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="support-hr" value="ì¸ë ¥êµìœ¡">
          <label for="support-hr">ì¸ë ¥/êµìœ¡</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="support-facility" value="ì‹œì„¤ê³µê°„">
          <label for="support-facility">ì‹œì„¤/ê³µê°„</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="support-consulting" value="ì»¨ì„¤íŒ…">
          <label for="support-consulting">ì»¨ì„¤íŒ…</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="support-startup" value="ì°½ì—…">
          <label for="support-startup">ì°½ì—…</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="support-esg" value="ESGíƒ„ì†Œì¤‘ë¦½">
          <label for="support-esg">ESG/íƒ„ì†Œì¤‘ë¦½</label>
        </div>
      </div>
      
      <h3>9-2. í˜„ì¬ ê¸°ì—… ë°œì „ ë‹¨ê³„ <span class="required">*</span></h3>
      <div class="checkbox-grid">
        <div class="checkbox-item">
          <input type="radio" name="stage" id="stage-idea" value="ì•„ì´í…œêµ¬ìƒ">
          <label for="stage-idea">ì•„ì´í…œ êµ¬ìƒ/ê²€ì¦</label>
        </div>
        <div class="checkbox-item">
          <input type="radio" name="stage" id="stage-prototype" value="ì‹œì œí’ˆê°œë°œ">
          <label for="stage-prototype">ì‹œì œí’ˆ ê°œë°œ</label>
        </div>
        <div class="checkbox-item">
          <input type="radio" name="stage" id="stage-production" value="ì–‘ì‚°ì¤€ë¹„">
          <label for="stage-production">ì–‘ì‚° ì¤€ë¹„/ì´ˆê¸°</label>
        </div>
        <div class="checkbox-item">
          <input type="radio" name="stage" id="stage-growth" value="ì„±ì¥ë‹¨ê³„">
          <label for="stage-growth">ì„±ì¥ ë‹¨ê³„</label>
        </div>
        <div class="checkbox-item">
          <input type="radio" name="stage" id="stage-leap" value="ë„ì•½ë‹¨ê³„">
          <label for="stage-leap">ë„ì•½ ë‹¨ê³„</label>
        </div>
      </div>
      
      <h3>9-3. ì‹œê¸‰ë„ <span class="required">*</span></h3>
      <div class="checkbox-grid">
        <div class="checkbox-item">
          <input type="radio" name="urgency" id="urgent-high" value="ê¸´ê¸‰">
          <label for="urgent-high">ê¸´ê¸‰ (1ê°œì›” ë‚´)</label>
        </div>
        <div class="checkbox-item">
          <input type="radio" name="urgency" id="urgent-normal" value="ë³´í†µ">
          <label for="urgent-normal">ë³´í†µ (3ê°œì›” ë‚´)</label>
        </div>
        <div class="checkbox-item">
          <input type="radio" name="urgency" id="urgent-long" value="ì¥ê¸°">
          <label for="urgent-long">ì¥ê¸° (6ê°œì›”~1ë…„)</label>
        </div>
      </div>
    </div>

    <!-- Section 10: ì¶”ê°€ íŠ¹ì´ì‚¬í•­ -->
    <div class="card">
      <h2>Section 10. ì¶”ê°€ íŠ¹ì´ì‚¬í•­</h2>
      
      <h3>10-1. ìƒìƒí˜‘ë ¥ ê´€ë ¨</h3>
      <div class="form-grid">
        <div class="form-group">
          <label>ëŒ€ê¸°ì—… í˜‘ë ¥ì‚¬</label>
          <select id="large-partner">
            <option value="N">ì•„ë‹ˆì˜¤</option>
            <option value="Y">ì˜ˆ</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>ì£¼ìš” ê±°ë˜ì²˜ëª…</label>
          <input type="text" id="main-client" placeholder="ëŒ€ê¸°ì—…ëª…">
        </div>
        
        <div class="form-group">
          <label>ì¤‘ì†Œê¸°ì—… ê°„ í˜‘ì—…</label>
          <select id="sme-cooperation">
            <option value="N">ì•„ë‹ˆì˜¤</option>
            <option value="Y">ì˜ˆ</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>ì‚°í•™ì—° í˜‘ë ¥</label>
          <select id="industry-academia">
            <option value="N">ì•„ë‹ˆì˜¤</option>
            <option value="Y">ì˜ˆ</option>
          </select>
        </div>
        
        <div class="form-group full-width">
          <label>í˜‘ë ¥ ëŒ€í•™/ì—°êµ¬ì†Œ</label>
          <input type="text" id="partner-institute" placeholder="ì˜ˆ: ì„œìš¸ëŒ€, í•œêµ­ì „ìí†µì‹ ì—°êµ¬ì›">
        </div>
      </div>
      
      <h3>10-2. íŠ¹ìˆ˜ ìƒí™©</h3>
      <div class="form-grid">
        <div class="form-group">
          <label>íì—… í›„ ì¬ì°½ì—…</label>
          <select id="reopen-after-close">
            <option value="N">ì•„ë‹ˆì˜¤</option>
            <option value="Y">ì˜ˆ</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>íì—…ì¼ì</label>
          <input type="date" id="close-date">
        </div>
        
        <div class="form-group">
          <label>ê°€ì—…ìŠ¹ê³„</label>
          <select id="family-succession">
            <option value="N">ì•„ë‹ˆì˜¤</option>
            <option value="Y">ì˜ˆ</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>ìŠ¹ê³„ì—°ë„</label>
          <input type="number" id="succession-year" placeholder="YYYY">
        </div>
        
        <div class="form-group">
          <label>M&A/ì¸ìˆ˜í•©ë³‘</label>
          <select id="merger">
            <option value="N">ì•„ë‹ˆì˜¤</option>
            <option value="Y">ì˜ˆ</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>í•©ë³‘ì¼ì</label>
          <input type="date" id="merger-date">
        </div>
      </div>
      
      <h3>10-3. ììœ  ê¸°ìˆ  í•­ëª©</h3>
      <div class="form-grid">
        <div class="form-group full-width">
          <label>ê¸°ì—… íŠ¹ì¥ì  (100ì ì´ë‚´)</label>
          <textarea id="company-strength" maxlength="100" placeholder="ìš°ë¦¬ ê¸°ì—…ë§Œì˜ ê°•ì , íŠ¹í™” ê¸°ìˆ  ë“±"></textarea>
        </div>
        
        <div class="form-group full-width">
          <label>ì£¼ìš” ì• ë¡œì‚¬í•­</label>
          <textarea id="main-difficulty" placeholder="í˜„ì¬ ê²ªê³  ìˆëŠ” ì£¼ìš” ì–´ë ¤ì›€"></textarea>
        </div>
        
        <div class="form-group full-width">
          <label>ê´€ì‹¬ ì •ì±… í‚¤ì›Œë“œ</label>
          <input type="text" id="policy-keywords" placeholder="ì˜ˆ: ì²­ë…„ê³ ìš©, ìŠ¤ë§ˆíŠ¸ê³µì¥, ìˆ˜ì¶œë§ˆì¼€íŒ…">
        </div>
      </div>
    </div>

    <!-- ì‹¤í–‰ ë²„íŠ¼ -->
    <div class="card">
      <button class="btn btn-primary" onclick="analyzePrograms()" style="width: 100%; font-size: 1.1rem; padding: 1rem; margin-bottom: 0.75rem;">
        ğŸ” ë§ì¶¤ ì§€ì›ì‚¬ì—… ì°¾ê¸°
      </button>
      <button class="btn btn-secondary" onclick="saveCompany()" style="width: 100%;">
        ğŸ’¾ ì €ì¥
      </button>
    </div>

    <!-- ê²°ê³¼ í‘œì‹œ ì˜ì—­ -->
    <div id="results-section" style="display: none;"></div>
  </div>

  <script>
    // ==================== Firebase & Google Drive ì„¤ì • ====================
    
    // Firebase ì„¤ì •
    const firebaseConfig = {
      apiKey: "AIzaSyDjS3bsIsl3uDtyQIrzpZTO3IigLmLNG1E",
      authDomain: "kfpc-company-support-project.firebaseapp.com",
      databaseURL: "https://kfpc-company-support-project-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "kfpc-company-support-project",
      storageBucket: "kfpc-company-support-project.firebasestorage.app",
      messagingSenderId: "1012609333373",
      appId: "1:1012609333373:web:5453ab357b06015d56d914",
      measurementId: "G-5BDZFX0SC6"
    };
    
    // Firebase ì´ˆê¸°í™”
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    
    // Google API í´ë¼ì´ì–¸íŠ¸ ì´ˆê¸°í™”
    let gapiInited = false;
    let gisInited = false;
    let tokenClient;
    let accessToken = null;
    
    const DISCOVERY_DOC = 'https://www.googleapis.com/discovery/v1/apis/drive/v3/rest';
    const SCOPES = 'https://www.googleapis.com/auth/drive.file https://www.googleapis.com/auth/drive.appdata';
    
    // ==================== ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ ====================
    
    /**
     * ìˆ«ìë§Œ ì…ë ¥ í—ˆìš©
     */
    function allowOnlyNumbers(input) {
      input.value = input.value.replace(/[^0-9]/g, '');
    }
    
    /**
     * ìˆ«ì í¬ë§·íŒ… (ì²œë‹¨ìœ„ ì‰¼í‘œ)
     */
    function formatNumber(num) {
      if (!num) return '';
      return parseInt(num).toLocaleString('ko-KR');
    }
    
    /**
     * ìµœëŒ€ ê¸¸ì´ ë„ë‹¬ ì‹œ ìë™ í¬ì»¤ìŠ¤ ì´ë™
     */
    function moveFocusOnMaxLength(current, nextId, maxLength) {
      if (current.value.length >= maxLength) {
        const nextElement = document.getElementById(nextId);
        if (nextElement) nextElement.focus();
      }
    }
    
    // ==================== í…ŒìŠ¤íŠ¸ ë°ì´í„° (Phase 1) ====================
    const MOCK_COMPANIES = [
      {
        name: 'ì‚¼ì„±ì „ì(ì£¼)',
        businessNumber: '124-81-00998',
        ceo: 'í•œì¢…í¬',
        openingDate: '1969-01-13',
        industryCode: 'C26',
        companySize: 'ëŒ€ê¸°ì—…',
        companyType: 'ë²•ì¸',
        locationSido: 'ê²½ê¸°',
        locationSigungu: 'ìˆ˜ì›ì‹œ',
        revenue: '300000000000',
        employeeCount: '120000'
      },
      {
        name: 'LGì „ì(ì£¼)',
        businessNumber: '107-86-14075',
        ceo: 'ì¡°ì£¼ì™„',
        openingDate: '1958-10-01',
        industryCode: 'C26',
        companySize: 'ëŒ€ê¸°ì—…',
        companyType: 'ë²•ì¸',
        locationSido: 'ì„œìš¸',
        locationSigungu: 'ì˜ë“±í¬êµ¬',
        revenue: '70000000000',
        employeeCount: '70000'
      },
      {
        name: 'í˜„ëŒ€ìë™ì°¨(ì£¼)',
        businessNumber: '101-81-42555',
        ceo: 'ì¥ì¬í›ˆ',
        openingDate: '1967-12-29',
        industryCode: 'C30',
        companySize: 'ëŒ€ê¸°ì—…',
        companyType: 'ë²•ì¸',
        locationSido: 'ì„œìš¸',
        locationSigungu: 'ì„œì´ˆêµ¬',
        revenue: '130000000000',
        employeeCount: '75000'
      },
      {
        name: 'SKí•˜ì´ë‹‰ìŠ¤(ì£¼)',
        businessNumber: '120-81-62902',
        ceo: 'ê³½ë…¸ì •',
        openingDate: '1983-02-15',
        industryCode: 'C26',
        companySize: 'ëŒ€ê¸°ì—…',
        companyType: 'ë²•ì¸',
        locationSido: 'ê²½ê¸°',
        locationSigungu: 'ì´ì²œì‹œ',
        revenue: '40000000000',
        employeeCount: '35000'
      },
      {
        name: 'ë„¤ì´ë²„(ì£¼)',
        businessNumber: '220-81-62517',
        ceo: 'ìµœìˆ˜ì—°',
        openingDate: '1999-06-02',
        industryCode: 'J63',
        companySize: 'ëŒ€ê¸°ì—…',
        companyType: 'ë²•ì¸',
        locationSido: 'ê²½ê¸°',
        locationSigungu: 'ì„±ë‚¨ì‹œ',
        revenue: '8000000000',
        employeeCount: '4000'
      },
      {
        name: 'ì¹´ì¹´ì˜¤(ì£¼)',
        businessNumber: '120-81-47521',
        ceo: 'í™ì€íƒ',
        openingDate: '2006-02-16',
        industryCode: 'J63',
        companySize: 'ëŒ€ê¸°ì—…',
        companyType: 'ë²•ì¸',
        locationSido: 'ê²½ê¸°',
        locationSigungu: 'ì„±ë‚¨ì‹œ',
        revenue: '6000000000',
        employeeCount: '3500'
      }
    ];
    
    // ==================== í…ŒìŠ¤íŠ¸ ì§€ì›ì‚¬ì—… ë°ì´í„° ====================
    /**
     * ì‹¤ì œ ì§€ì›ì‚¬ì—… ë°ì´í„° (2025ë…„ ê¸°ì¤€)
     * í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ ë§¤ì¹­ì— ì‚¬ìš©
     */
    const MOCK_PROGRAMS = [
      // 1. ì°½ì—… ì§€ì›
      {
        id: 'startup-001',
        name: 'ì˜ˆë¹„ì°½ì—…íŒ¨í‚¤ì§€',
        organization: 'ì¤‘ì†Œë²¤ì²˜ê¸°ì—…ë¶€',
        category: 'ì°½ì—…',
        budget: 'ìµœëŒ€ 1ì–µì›',
        description: 'ìš°ìˆ˜í•œ ì‚¬ì—… ì•„ì´ë””ì–´ë¥¼ ë³´ìœ í•œ ì˜ˆë¹„ì°½ì—…ìì—ê²Œ ì‚¬ì—…í™” ìê¸ˆ, ë©˜í† ë§, êµìœ¡ ë“±ì„ ì¢…í•© ì§€ì›',
        
        // ìê²© ì¡°ê±´
        requiresNoArrears: true,
        minBusinessAge: null,
        maxBusinessAge: 0, // ì°½ì—… ì „
        targetCompanySize: [],
        maxCeoAge: 39,
        
        // ì„ í˜¸ ì¡°ê±´
        targetIndustry: [], // ì „ ì—…ì¢…
        targetRegion: [],
        prefersYouthEmployment: true,
        
        website: 'https://www.k-startup.go.kr'
      },
      
      {
        id: 'startup-002',
        name: 'ì´ˆê¸°ì°½ì—…íŒ¨í‚¤ì§€',
        organization: 'ì¤‘ì†Œë²¤ì²˜ê¸°ì—…ë¶€',
        category: 'ì°½ì—…',
        budget: 'ìµœëŒ€ 1ì–µì›',
        description: 'ì—…ë ¥ 3ë…„ ì´í•˜ ì´ˆê¸°ì°½ì—…ê¸°ì—…ì˜ ì„±ì¥ ì§€ì› (ì‚¬ì—…í™” ìê¸ˆ, ë©˜í† ë§, ë§ˆì¼€íŒ… ë“±)',
        
        requiresNoArrears: true,
        minBusinessAge: 0,
        maxBusinessAge: 3,
        targetCompanySize: ['ì†Œê¸°ì—…', 'ì¤‘ì†Œê¸°ì—…'],
        maxCeoAge: null,
        
        targetIndustry: [],
        targetRegion: [],
        
        website: 'https://www.k-startup.go.kr'
      },
      
      {
        id: 'startup-003',
        name: 'ì²­ë…„ì°½ì—…ì‚¬ê´€í•™êµ',
        organization: 'ì¤‘ì†Œë²¤ì²˜ê¸°ì—…ë¶€',
        category: 'ì°½ì—…',
        budget: 'ìµœëŒ€ 1ì–µì› + ì…ì£¼ê³µê°„',
        description: 'ë§Œ 39ì„¸ ì´í•˜ ì²­ë…„ ì°½ì—…ì ëŒ€ìƒ ì°½ì—… êµìœ¡, ìê¸ˆ, ê³µê°„ ì§€ì›',
        
        requiresNoArrears: true,
        minBusinessAge: 0,
        maxBusinessAge: 3,
        targetCompanySize: ['ì†Œê¸°ì—…', 'ì¤‘ì†Œê¸°ì—…'],
        maxCeoAge: 39,
        
        targetIndustry: [],
        targetRegion: [],
        prefersYouthEmployment: true,
        
        website: 'https://www.k-startup.go.kr'
      },
      
      // 2. R&D ì§€ì›
      {
        id: 'rnd-001',
        name: 'ì¤‘ì†Œê¸°ì—… ê¸°ìˆ ê°œë°œì‚¬ì—…',
        organization: 'ì¤‘ì†Œë²¤ì²˜ê¸°ì—…ë¶€',
        category: 'R&D',
        budget: 'ìµœëŒ€ 5ì–µì›',
        description: 'ì¤‘ì†Œê¸°ì—…ì˜ ê¸°ìˆ ê²½ìŸë ¥ ê°•í™”ë¥¼ ìœ„í•œ R&D ê³¼ì œ ì§€ì› (ì œí’ˆê°œë°œ, ê³µì •ê°œì„  ë“±)',
        
        requiresNoArrears: true,
        minBusinessAge: 0,
        maxBusinessAge: null,
        targetCompanySize: ['ì†Œê¸°ì—…', 'ì¤‘ì†Œê¸°ì—…'],
        
        targetIndustry: ['10', '20', '21', '26', '27', '28', '29', '62', '70'],
        targetRegion: [],
        
        prefersPatent: true,
        prefersRnD: true,
        prefersVenture: true,
        prefersInnobiz: true,
        
        website: 'https://www.smtech.go.kr'
      },
      
      {
        id: 'rnd-002',
        name: 'ì‚°ì—…ê¸°ìˆ  R&D (ì•Œí‚¤ë¯¸ìŠ¤íŠ¸)',
        organization: 'ì‚°ì—…í†µìƒìì›ë¶€',
        category: 'R&D',
        budget: 'ìµœëŒ€ 20ì–µì›',
        description: 'ì†Œì¬Â·ë¶€í’ˆÂ·ì¥ë¹„(ì†Œë¶€ì¥) í•µì‹¬ê¸°ìˆ  ê°œë°œ ì§€ì›',
        
        requiresNoArrears: true,
        minBusinessAge: 3,
        maxBusinessAge: null,
        targetCompanySize: ['ì¤‘ì†Œê¸°ì—…', 'ì¤‘ê²¬ê¸°ì—…'],
        
        targetIndustry: ['20', '21', '26', '27', '28'], // í™”í•™, ì „ìë¶€í’ˆ, ë°˜ë„ì²´
        targetRegion: [],
        
        prefersPatent: true,
        prefersRnD: true,
        prefersVenture: true,
        
        website: 'https://www.motie.go.kr'
      },
      
      {
        id: 'rnd-003',
        name: 'ì‚°í•™ì—°í˜‘ë ¥ ê¸°ìˆ ê°œë°œ',
        organization: 'ì¤‘ì†Œë²¤ì²˜ê¸°ì—…ë¶€',
        category: 'R&D',
        budget: 'ìµœëŒ€ 3ì–µì›',
        description: 'ì¤‘ì†Œê¸°ì—…ê³¼ ëŒ€í•™/ì—°êµ¬ì†Œ ê°„ ê³µë™ R&D ì§€ì›',
        
        requiresNoArrears: true,
        minBusinessAge: 0,
        maxBusinessAge: null,
        targetCompanySize: ['ì†Œê¸°ì—…', 'ì¤‘ì†Œê¸°ì—…'],
        
        targetIndustry: [],
        targetRegion: [],
        
        prefersPatent: true,
        prefersRnD: true,
        
        website: 'https://www.smtech.go.kr'
      },
      
      // 3. ê¸ˆìœµ ì§€ì›
      {
        id: 'finance-001',
        name: 'ì •ì±…ìê¸ˆìœµì',
        organization: 'ì¤‘ì†Œë²¤ì²˜ê¸°ì—…ì§„í¥ê³µë‹¨',
        category: 'ê¸ˆìœµ',
        budget: 'ìµœëŒ€ 30ì–µì›',
        description: 'ì¤‘ì†Œê¸°ì—… ìš´ì˜ìê¸ˆ ë° ì‹œì„¤ìê¸ˆ ì €ë¦¬ ìœµì (ì—° 2~3% ê¸ˆë¦¬)',
        
        requiresNoArrears: true,
        minBusinessAge: 0,
        maxBusinessAge: null,
        targetCompanySize: ['ì†Œê¸°ì—…', 'ì¤‘ì†Œê¸°ì—…'],
        
        targetIndustry: [],
        targetRegion: [],
        
        website: 'https://www.kosmes.or.kr'
      },
      
      {
        id: 'finance-002',
        name: 'ë²¤ì²˜ê¸°ì—… íˆ¬ìœµì',
        organization: 'ì¤‘ì†Œë²¤ì²˜ê¸°ì—…ì§„í¥ê³µë‹¨',
        category: 'ê¸ˆìœµ',
        budget: 'ìµœëŒ€ 50ì–µì›',
        description: 'ë²¤ì²˜ê¸°ì—… ì„±ì¥ ì§€ì› íˆ¬ìœµì (íˆ¬ì+ìœµì íŒ¨í‚¤ì§€)',
        
        requiresNoArrears: true,
        minBusinessAge: 0,
        maxBusinessAge: 7,
        targetCompanySize: ['ì†Œê¸°ì—…', 'ì¤‘ì†Œê¸°ì—…'],
        
        targetIndustry: [],
        targetRegion: [],
        
        prefersVenture: true,
        prefersPatent: true,
        
        website: 'https://www.kosmes.or.kr'
      },
      
      {
        id: 'finance-003',
        name: 'ì†Œìƒê³µì¸ ì •ì±…ìê¸ˆ',
        organization: 'ì†Œìƒê³µì¸ì‹œì¥ì§„í¥ê³µë‹¨',
        category: 'ê¸ˆìœµ',
        budget: 'ìµœëŒ€ 7ì²œë§Œì›',
        description: 'ì†Œìƒê³µì¸ ìš´ì˜ìê¸ˆ ë° ì‹œì„¤ê°œì„  ìê¸ˆ ì§€ì›',
        
        requiresNoArrears: true,
        minBusinessAge: 0,
        maxBusinessAge: null,
        targetCompanySize: ['ì†Œê¸°ì—…'],
        
        targetIndustry: ['46', '47', '56'], // ë„ì†Œë§¤, ìŒì‹ì 
        targetRegion: [],
        
        website: 'https://www.semas.or.kr'
      },
      
      // 4. ìˆ˜ì¶œ ì§€ì›
      {
        id: 'export-001',
        name: 'ìˆ˜ì¶œë°”ìš°ì²˜',
        organization: 'ì¤‘ì†Œë²¤ì²˜ê¸°ì—…ë¶€',
        category: 'ìˆ˜ì¶œ',
        budget: 'ìµœëŒ€ 2ì²œë§Œì›',
        description: 'ì¤‘ì†Œê¸°ì—… í•´ì™¸ ì „ì‹œíšŒ ì°¸ê°€, ë§ˆì¼€íŒ…, ì¸ì¦íšë“ ë“± ìˆ˜ì¶œ ì—­ëŸ‰ ê°•í™” ì§€ì›',
        
        requiresNoArrears: true,
        minBusinessAge: 0,
        maxBusinessAge: null,
        targetCompanySize: ['ì†Œê¸°ì—…', 'ì¤‘ì†Œê¸°ì—…'],
        
        targetIndustry: [],
        targetRegion: [],
        
        prefersExport: true,
        
        website: 'https://www.exportvoucher.com'
      },
      
      {
        id: 'export-002',
        name: 'K-ìŠ¤íƒ€íŠ¸ì—… ê¸€ë¡œë²Œ ì§„ì¶œ',
        organization: 'ì¤‘ì†Œë²¤ì²˜ê¸°ì—…ë¶€',
        category: 'ìˆ˜ì¶œ',
        budget: 'ìµœëŒ€ 5ì²œë§Œì›',
        description: 'ìœ ë§ ìŠ¤íƒ€íŠ¸ì—… í•´ì™¸ì‹œì¥ ì§„ì¶œ ì§€ì› (í˜„ì§€í™”, ë§ˆì¼€íŒ…, IR ë“±)',
        
        requiresNoArrears: true,
        minBusinessAge: 0,
        maxBusinessAge: 7,
        targetCompanySize: ['ì†Œê¸°ì—…', 'ì¤‘ì†Œê¸°ì—…'],
        
        targetIndustry: ['58', '62', '63', '70'],
        targetRegion: [],
        
        prefersVenture: true,
        prefersPatent: true,
        
        website: 'https://www.k-startup.go.kr'
      },
      
      {
        id: 'export-003',
        name: 'ê¸€ë¡œë²Œ ê°•ì†Œê¸°ì—… ìœ¡ì„±',
        organization: 'ì‚°ì—…í†µìƒìì›ë¶€',
        category: 'ìˆ˜ì¶œ',
        budget: 'ìµœëŒ€ 10ì–µì›',
        description: 'ìˆ˜ì¶œ ìœ ë§ ì¤‘ì†Œê¸°ì—…ì˜ ê¸€ë¡œë²Œ ì‹œì¥ ì§„ì¶œ ì¢…í•© ì§€ì›',
        
        requiresNoArrears: true,
        minBusinessAge: 3,
        maxBusinessAge: null,
        targetCompanySize: ['ì¤‘ì†Œê¸°ì—…', 'ì¤‘ê²¬ê¸°ì—…'],
        
        targetIndustry: [],
        targetRegion: [],
        
        prefersExport: true,
        prefersPatent: true,
        
        website: 'https://www.motie.go.kr'
      },
      
      // 5. ê³ ìš© ì§€ì›
      {
        id: 'employment-001',
        name: 'ì²­ë…„ì¶”ê°€ê³ ìš©ì¥ë ¤ê¸ˆ',
        organization: 'ê³ ìš©ë…¸ë™ë¶€',
        category: 'ê³ ìš©',
        budget: '1ì¸ë‹¹ ìµœëŒ€ 900ë§Œì›',
        description: 'ë§Œ 15~34ì„¸ ì²­ë…„ ì •ê·œì§ ì‹ ê·œ ì±„ìš© ì‹œ ì¸ê±´ë¹„ ì§€ì› (3ë…„ê°„)',
        
        requiresNoArrears: false,
        minBusinessAge: 0,
        maxBusinessAge: null,
        targetCompanySize: ['ì†Œê¸°ì—…', 'ì¤‘ì†Œê¸°ì—…', 'ì¤‘ê²¬ê¸°ì—…'],
        
        targetIndustry: [],
        targetRegion: [],
        
        prefersYouthEmployment: true,
        
        website: 'https://www.work.go.kr'
      },
      
      {
        id: 'employment-002',
        name: 'ì¼ìë¦¬ ì•ˆì •ìê¸ˆ',
        organization: 'ê³ ìš©ë…¸ë™ë¶€',
        category: 'ê³ ìš©',
        budget: '1ì¸ë‹¹ ì›” ìµœëŒ€ 9ë§Œì›',
        description: 'ìµœì €ì„ê¸ˆ ì¸ìƒì— ë”°ë¥¸ ì†Œìƒê³µì¸Â·ì˜ì„¸ì¤‘ì†Œê¸°ì—… ì§€ì›',
        
        requiresNoArrears: false,
        minBusinessAge: 0,
        maxBusinessAge: null,
        targetCompanySize: ['ì†Œê¸°ì—…'],
        
        targetIndustry: [],
        targetRegion: [],
        
        website: 'https://www.work.go.kr'
      },
      
      {
        id: 'employment-003',
        name: 'ì—¬ì„±ê³ ìš© ìš°ìˆ˜ê¸°ì—… ì§€ì›',
        organization: 'ì—¬ì„±ê°€ì¡±ë¶€',
        category: 'ê³ ìš©',
        budget: 'ìµœëŒ€ 5ì²œë§Œì›',
        description: 'ì—¬ì„± ê³ ìš© ë¹„ìœ¨ì´ ë†’ì€ ê¸°ì—…ì— ëŒ€í•œ ì¸ì„¼í‹°ë¸Œ ë° ì§€ì›',
        
        requiresNoArrears: false,
        minBusinessAge: 0,
        maxBusinessAge: null,
        targetCompanySize: ['ì†Œê¸°ì—…', 'ì¤‘ì†Œê¸°ì—…'],
        
        targetIndustry: [],
        targetRegion: [],
        
        prefersFemaleEmployment: true,
        
        website: 'https://www.mogef.go.kr'
      },
      
      // 6. ì§€ì—­ íŠ¹í™”
      {
        id: 'region-001',
        name: 'ì§€ì—­ì£¼ë ¥ì‚°ì—… ìœ¡ì„±ì‚¬ì—…',
        organization: 'ì‚°ì—…í†µìƒìì›ë¶€',
        category: 'ì§€ì—­íŠ¹í™”',
        budget: 'ìµœëŒ€ 10ì–µì›',
        description: 'ì§€ì—­ë³„ ì£¼ë ¥ì‚°ì—…(ìë™ì°¨, ì¡°ì„ , ì„¬ìœ  ë“±) ìœ¡ì„± ì§€ì›',
        
        requiresNoArrears: true,
        minBusinessAge: 0,
        maxBusinessAge: null,
        targetCompanySize: ['ì†Œê¸°ì—…', 'ì¤‘ì†Œê¸°ì—…'],
        
        targetIndustry: [],
        targetRegion: ['ë¶€ì‚°', 'ëŒ€êµ¬', 'ìš¸ì‚°', 'ê²½ë¶', 'ê²½ë‚¨', 'ì „ë¶', 'ì „ë‚¨'],
        
        preferNonCapital: true,
        
        website: 'https://www.motie.go.kr'
      },
      
      {
        id: 'region-002',
        name: 'ì§€ì—­ì‚°ì—… ë§ì¶¤í˜• ì¼ìë¦¬ì°½ì¶œ',
        organization: 'ê³ ìš©ë…¸ë™ë¶€',
        category: 'ì§€ì—­íŠ¹í™”',
        budget: 'ìµœëŒ€ 3ì–µì›',
        description: 'ì§€ì—­ íŠ¹ì„±ì— ë§ëŠ” ì¼ìë¦¬ ì°½ì¶œ ê¸°ì—… ì§€ì›',
        
        requiresNoArrears: false,
        minBusinessAge: 0,
        maxBusinessAge: null,
        targetCompanySize: ['ì†Œê¸°ì—…', 'ì¤‘ì†Œê¸°ì—…'],
        
        targetIndustry: [],
        targetRegion: ['ê°•ì›', 'ì¶©ë¶', 'ì¶©ë‚¨', 'ì „ë¶', 'ì „ë‚¨', 'ê²½ë¶', 'ê²½ë‚¨', 'ì œì£¼'],
        
        preferNonCapital: true,
        
        website: 'https://www.work.go.kr'
      },
      
      // 7. ë””ì§€í„¸ì „í™˜
      {
        id: 'digital-001',
        name: 'ìŠ¤ë§ˆíŠ¸ê³µì¥ êµ¬ì¶• ì§€ì›',
        organization: 'ì¤‘ì†Œë²¤ì²˜ê¸°ì—…ë¶€',
        category: 'ë””ì§€í„¸ì „í™˜',
        budget: 'ìµœëŒ€ 1ì–µì›',
        description: 'ì œì¡°ì—… ìŠ¤ë§ˆíŠ¸ê³µì¥ êµ¬ì¶• ë° ê³ ë„í™” ì§€ì› (ì„¤ë¹„, SW, ì»¨ì„¤íŒ…)',
        
        requiresNoArrears: true,
        minBusinessAge: 0,
        maxBusinessAge: null,
        targetCompanySize: ['ì†Œê¸°ì—…', 'ì¤‘ì†Œê¸°ì—…'],
        
        targetIndustry: ['10', '11', '13', '14', '20', '21', '22', '23', '24', '25', '26', '27', '28', '29', '30', '31'],
        targetRegion: [],
        
        website: 'https://www.smart-factory.kr'
      },
      
      {
        id: 'digital-002',
        name: 'ì¤‘ì†Œê¸°ì—… AIÂ·ë¹…ë°ì´í„° ë°”ìš°ì²˜',
        organization: 'ê³¼í•™ê¸°ìˆ ì •ë³´í†µì‹ ë¶€',
        category: 'ë””ì§€í„¸ì „í™˜',
        budget: 'ìµœëŒ€ 7ì²œë§Œì›',
        description: 'AIÂ·ë¹…ë°ì´í„° ê¸°ìˆ  ë„ì… ë° í™œìš© ì§€ì›',
        
        requiresNoArrears: true,
        minBusinessAge: 0,
        maxBusinessAge: null,
        targetCompanySize: ['ì†Œê¸°ì—…', 'ì¤‘ì†Œê¸°ì—…'],
        
        targetIndustry: [],
        targetRegion: [],
        
        prefersRnD: true,
        
        website: 'https://www.msit.go.kr'
      },
      
      // 8. ê¸°íƒ€
      {
        id: 'etc-001',
        name: 'ì†Œìƒê³µì¸ í¬ë§ë¦¬í„´íŒ¨í‚¤ì§€',
        organization: 'ì†Œìƒê³µì¸ì‹œì¥ì§„í¥ê³µë‹¨',
        category: 'ì¬ê¸°ì§€ì›',
        budget: 'ìµœëŒ€ 5ì²œë§Œì›',
        description: 'íì—… í›„ ì¬ì°½ì—…í•˜ëŠ” ì†Œìƒê³µì¸ ì§€ì› (êµìœ¡, ìê¸ˆ, ì»¨ì„¤íŒ…)',
        
        requiresNoArrears: true,
        minBusinessAge: 0,
        maxBusinessAge: 1,
        targetCompanySize: ['ì†Œê¸°ì—…'],
        
        targetIndustry: [],
        targetRegion: [],
        
        website: 'https://www.semas.or.kr'
      },
      
      {
        id: 'etc-002',
        name: 'ì—¬ì„±ê¸°ì—… ì§€ì›ì‚¬ì—…',
        organization: 'ì¤‘ì†Œë²¤ì²˜ê¸°ì—…ë¶€',
        category: 'ì—¬ì„±ê¸°ì—…',
        budget: 'ìµœëŒ€ 3ì–µì›',
        description: 'ì—¬ì„±ê¸°ì—… ë° ì—¬ì„± CEO ê¸°ì—… ëŒ€ìƒ ìê¸ˆ, íŒë¡œ, êµìœ¡ ì§€ì›',
        
        requiresNoArrears: true,
        minBusinessAge: 0,
        maxBusinessAge: null,
        targetCompanySize: ['ì†Œê¸°ì—…', 'ì¤‘ì†Œê¸°ì—…'],
        
        targetIndustry: [],
        targetRegion: [],
        
        prefersFemaleEmployment: true,
        
        website: 'https://www.smba.go.kr'
      }
    ];
    
    // ==================== Google API ì´ˆê¸°í™” ====================
    function gapiLoaded() {
      gapi.load('client', initializeGapiClient);
    }
    
    async function initializeGapiClient() {
      await gapi.client.init({
        discoveryDocs: [DISCOVERY_DOC],
      });
      gapiInited = true;
    }
    
    // Google ë¡œê·¸ì¸
    async function signInWithGoogle() {
      try {
        console.log('ğŸ” Google ë¡œê·¸ì¸ ì‹œì‘...');
        
        const provider = new firebase.auth.GoogleAuthProvider();
        provider.addScope('https://www.googleapis.com/auth/drive.file');
        provider.addScope('https://www.googleapis.com/auth/drive.appdata');
        
        const result = await auth.signInWithPopup(provider);
        const credential = result.credential;
        accessToken = credential.accessToken;
        
        console.log('âœ… ë¡œê·¸ì¸ ì„±ê³µ:', result.user.email);
        
        // Google API í´ë¼ì´ì–¸íŠ¸ ì„¤ì •
        gapi.client.setToken({ access_token: accessToken });
        
        // ë¡œê·¸ì¸ í™”ë©´ ìˆ¨ê¸°ê³  ë©”ì¸ í™”ë©´ í‘œì‹œ
        document.getElementById('login-screen').style.display = 'none';
        document.getElementById('main-content').style.display = 'block';
        
        // Google Driveì—ì„œ ë°ì´í„° ë¡œë“œ
        await loadFromDrive();
        
      } catch (error) {
        console.error('âŒ ë¡œê·¸ì¸ ì‹¤íŒ¨:', error);
        alert('ë¡œê·¸ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
      }
    }
    
    // Google ë¡œê·¸ì•„ì›ƒ
    async function signOut() {
      try {
        await auth.signOut();
        accessToken = null;
        savedCompanies = {};
        
        document.getElementById('main-content').style.display = 'none';
        document.getElementById('login-screen').style.display = 'flex';
        
        console.log('âœ… ë¡œê·¸ì•„ì›ƒ ì™„ë£Œ');
      } catch (error) {
        console.error('âŒ ë¡œê·¸ì•„ì›ƒ ì‹¤íŒ¨:', error);
      }
    }
    
    // Google Driveì— ì €ì¥
    async function saveToDrive(data) {
      try {
        if (!accessToken) {
          console.error('âŒ Access tokenì´ ì—†ìŠµë‹ˆë‹¤');
          return false;
        }
        
        console.log('ğŸ’¾ Google Driveì— ì €ì¥ ì¤‘...');
        
        // ë°ì´í„° ì•”í˜¸í™”
        const encryptedData = encryptData(data);
        
        // ê¸°ì¡´ íŒŒì¼ ê²€ìƒ‰
        const searchResponse = await gapi.client.drive.files.list({
          q: "name='kfpc-bizinfo-data.json' and trashed=false",
          spaces: 'appDataFolder',
          fields: 'files(id, name)',
        });
        
        const files = searchResponse.result.files;
        const fileContent = JSON.stringify({ encryptedData, timestamp: new Date().toISOString() });
        const file = new Blob([fileContent], { type: 'application/json' });
        
        if (files && files.length > 0) {
          // ê¸°ì¡´ íŒŒì¼ ì—…ë°ì´íŠ¸
          const fileId = files[0].id;
          const form = new FormData();
          form.append('metadata', new Blob([JSON.stringify({})], { type: 'application/json' }));
          form.append('file', file);
          
          const updateResponse = await fetch(
            `https://www.googleapis.com/upload/drive/v3/files/${fileId}?uploadType=multipart`,
            {
              method: 'PATCH',
              headers: { Authorization: `Bearer ${accessToken}` },
              body: form,
            }
          );
          
          if (updateResponse.ok) {
            console.log('âœ… Drive ì—…ë°ì´íŠ¸ ì™„ë£Œ');
            return true;
          }
        } else {
          // ìƒˆ íŒŒì¼ ìƒì„±
          const metadata = {
            name: 'kfpc-bizinfo-data.json',
            mimeType: 'application/json',
            parents: ['appDataFolder'],
          };
          
          const form = new FormData();
          form.append('metadata', new Blob([JSON.stringify(metadata)], { type: 'application/json' }));
          form.append('file', file);
          
          const createResponse = await fetch(
            'https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart',
            {
              method: 'POST',
              headers: { Authorization: `Bearer ${accessToken}` },
              body: form,
            }
          );
          
          if (createResponse.ok) {
            console.log('âœ… Drive ì €ì¥ ì™„ë£Œ');
            return true;
          }
        }
        
        return false;
      } catch (error) {
        console.error('âŒ Drive ì €ì¥ ì‹¤íŒ¨:', error);
        return false;
      }
    }
    
    // Google Driveì—ì„œ ë¶ˆëŸ¬ì˜¤ê¸°
    async function loadFromDrive() {
      try {
        if (!accessToken) {
          console.error('âŒ Access tokenì´ ì—†ìŠµë‹ˆë‹¤');
          return false;
        }
        
        console.log('ğŸ“¥ Google Driveì—ì„œ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...');
        
        const searchResponse = await gapi.client.drive.files.list({
          q: "name='kfpc-bizinfo-data.json' and trashed=false",
          spaces: 'appDataFolder',
          fields: 'files(id, name)',
        });
        
        const files = searchResponse.result.files;
        if (!files || files.length === 0) {
          console.log('ğŸ“ ì €ì¥ëœ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤');
          return false;
        }
        
        const fileId = files[0].id;
        const getResponse = await fetch(
          `https://www.googleapis.com/drive/v3/files/${fileId}?alt=media`,
          {
            headers: { Authorization: `Bearer ${accessToken}` },
          }
        );
        
        if (getResponse.ok) {
          const fileData = await getResponse.json();
          const decryptedData = decryptData(fileData.encryptedData);
          
          if (decryptedData) {
            savedCompanies = decryptedData;
            updateCompanySelect();
            console.log('âœ… Drive ë¡œë“œ ì™„ë£Œ:', Object.keys(savedCompanies).length, 'ê°œ ê³ ê°ì‚¬');
            return true;
          }
        }
        
        return false;
      } catch (error) {
        console.error('âŒ Drive ë¡œë“œ ì‹¤íŒ¨:', error);
        return false;
      }
    }
    
    // ==================== AES-256 ì•”í˜¸í™” ====================
    
    // AES-256 ì•”í˜¸í™” í‚¤ (ì•± ê³ ìœ  í‚¤)
    const ENCRYPTION_KEY = 'KFPC-BizInfo-2025-AES256-SecureKey';
    
    let savedCompanies = {};

    // ì•”í˜¸í™” í•¨ìˆ˜
    function encryptData(data) {
      return CryptoJS.AES.encrypt(JSON.stringify(data), ENCRYPTION_KEY).toString();
    }
    
    // ë³µí˜¸í™” í•¨ìˆ˜
    function decryptData(encryptedData) {
      try {
        const bytes = CryptoJS.AES.decrypt(encryptedData, ENCRYPTION_KEY);
        return JSON.parse(bytes.toString(CryptoJS.enc.Utf8));
      } catch (e) {
        console.error('ë³µí˜¸í™” ì‹¤íŒ¨:', e);
        return null;
      }
    }
    
    // ==================== ë“±ë¡ë²ˆí˜¸ ì…ë ¥ ìë™ í¬ì»¤ìŠ¤ ====================
    function moveFocusOnMaxLength(currentInput, nextInputId, maxLength) {
      // ìˆ«ìë§Œ ì…ë ¥ë˜ë„ë¡ í•„í„°ë§
      currentInput.value = currentInput.value.replace(/[^\d]/g, '');
      
      // ìµœëŒ€ ê¸¸ì´ì— ë„ë‹¬í•˜ë©´ ë‹¤ìŒ inputìœ¼ë¡œ í¬ì»¤ìŠ¤ ì´ë™
      if (currentInput.value.length >= maxLength) {
        const nextInput = document.getElementById(nextInputId);
        if (nextInput) {
          nextInput.focus();
        }
      }
    }
    
    // ==================== ìˆ«ì í¬ë§·íŒ… ====================
    function formatNumber(value) {
      if (!value) return '';
      // ìˆ«ìê°€ ì•„ë‹Œ ë¬¸ì ì œê±°
      const numStr = String(value).replace(/[^\d]/g, '');
      if (!numStr) return '';
      
      // ìˆ«ìë¥¼ ì²œ ë‹¨ìœ„ë¡œ ì½¤ë§ˆ ì¶”ê°€
      return numStr.replace(/\B(?=(\d{3})+(?!\d))/g, ',');
    }
    
    function unformatNumber(value) {
      if (!value) return '';
      // ì½¤ë§ˆ ì œê±°í•˜ê³  ìˆœìˆ˜ ìˆ«ìë§Œ ë°˜í™˜
      return String(value).replace(/,/g, '');
    }
    
    function attachNumberFormatting() {
      // ëª¨ë“  ìˆ«ì ì…ë ¥ í•„ë“œ ID ëª©ë¡
      const numberFields = [
        // Section 3: ì¬ë¬´ ì •ë³´
        'revenue-recent', 'revenue-prev1', 'revenue-prev2',
        'profit-recent', 'capital', 'total-equity', 'total-debt', 'debt-ratio',
        'tax-arrears', 'local-tax-arrears', 'insurance-arrears',
        // Section 4: ê³ ìš© ì •ë³´
        'employees-total', 'employees-prev', 'employees-youth', 
        'employees-female', 'employees-disabled', 'employees-senior',
        'irregular-ratio', 'hiring-plan',
        // Section 5: ê¸°ìˆ  ì •ë³´
        'researchers', 'rd-investment', 'rd-ratio',
        'patents-registered', 'patents-applied', 'trademarks',
        // Section 6: ìˆ˜ì¶œ ì •ë³´
        'export-recent', 'export-prev'
      ];
      
      numberFields.forEach(fieldId => {
        const field = document.getElementById(fieldId);
        if (field) {
          // typeì„ textë¡œ ë³€ê²½í•˜ê³  inputmode ì¶”ê°€
          field.type = 'text';
          field.setAttribute('inputmode', 'numeric');
          
          // input ì´ë²¤íŠ¸ë¡œ ì‹¤ì‹œê°„ í¬ë§·íŒ…
          field.addEventListener('input', function(e) {
            const cursorPos = this.selectionStart;
            const oldLength = this.value.length;
            
            // í¬ë§·íŒ… ì ìš©
            const formatted = formatNumber(this.value);
            this.value = formatted;
            
            // ì»¤ì„œ ìœ„ì¹˜ ì¡°ì •
            const newLength = formatted.length;
            const lengthDiff = newLength - oldLength;
            
            // ìˆ«ì ì…ë ¥ ì¤‘ ì½¤ë§ˆê°€ ì¶”ê°€ë˜ë©´ ì»¤ì„œ ìœ„ì¹˜ ì¡°ì •
            if (lengthDiff > 0 && cursorPos < newLength) {
              this.setSelectionRange(cursorPos + lengthDiff, cursorPos + lengthDiff);
            } else {
              this.setSelectionRange(cursorPos, cursorPos);
            }
          });
          
          // blur ì´ë²¤íŠ¸ë¡œ ìµœì¢… í¬ë§·íŒ…
          field.addEventListener('blur', function() {
            this.value = formatNumber(this.value);
          });
        }
      });
      
      console.log('âœ… ìˆ«ì í•„ë“œ ì‹¤ì‹œê°„ ì½¤ë§ˆ í¬ë§·íŒ… í™œì„±í™” (' + numberFields.length + 'ê°œ í•„ë“œ)');
    }

    async function initializeApp() {
      try {
        console.log('ğŸš€ ì•± ì´ˆê¸°í™”');
        
        // Google API ë¡œë“œ
        gapi.load('client', gapiLoaded);
        
        // Firebase ì¸ì¦ ìƒíƒœ í™•ì¸
        auth.onAuthStateChanged(async (user) => {
          if (user) {
            console.log('âœ… ë¡œê·¸ì¸ ìƒíƒœ:', user.email);
            
            // ì‚¬ìš©ì ì •ë³´ í‘œì‹œ
            document.getElementById('user-info').textContent = user.email;
            
            // í† í° ê°±ì‹ 
            const credential = await user.getIdTokenResult();
            accessToken = credential.token;
            
            // Google API í´ë¼ì´ì–¸íŠ¸ ì„¤ì •
            if (gapiInited) {
              gapi.client.setToken({ access_token: accessToken });
            }
            
            // ë¡œê·¸ì¸ í™”ë©´ ìˆ¨ê¸°ê³  ë©”ì¸ í™”ë©´ í‘œì‹œ
            document.getElementById('login-screen').style.display = 'none';
            document.getElementById('main-content').style.display = 'block';
            
            // Google Driveì—ì„œ ë°ì´í„° ë¡œë“œ
            await loadFromDrive();
            
            // ìˆ«ì í¬ë§·íŒ… í™œì„±í™”
            attachNumberFormatting();
            
            hideLoading();
          } else {
            console.log('âš ï¸ ë¡œê·¸ì¸ í•„ìš”');
            // ë¡œê·¸ì¸ í™”ë©´ í‘œì‹œ
            document.getElementById('login-screen').style.display = 'flex';
            hideLoading();
          }
        });
        
      } catch (error) {
        console.error('âŒ ì´ˆê¸°í™” ì‹¤íŒ¨:', error);
        hideLoading();
      }
    }
    
    function hideLoading() {
      const loading = document.getElementById('loading-screen');
      loading.classList.add('hide');
      setTimeout(() => loading.style.display = 'none', 300);
    }
    
    function collectFormData() {
      // ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸ 3ê°œ input í•©ì¹˜ê¸°
      const bizNum1 = document.getElementById('business-number-1').value;
      const bizNum2 = document.getElementById('business-number-2').value;
      const bizNum3 = document.getElementById('business-number-3').value;
      const businessNumber = bizNum1 && bizNum2 && bizNum3 ? `${bizNum1}-${bizNum2}-${bizNum3}` : '';
      
      // ë²•ì¸ë“±ë¡ë²ˆí˜¸ 2ê°œ input í•©ì¹˜ê¸°
      const corpNum1 = document.getElementById('corp-number-1').value;
      const corpNum2 = document.getElementById('corp-number-2').value;
      const corpNumber = corpNum1 && corpNum2 ? `${corpNum1}-${corpNum2}` : '';
      
      // ëª¨ë“  ì…ë ¥ í•„ë“œ ë°ì´í„° ìˆ˜ì§‘
      const data = {
        // Section 1
        companyName: document.getElementById('company-name').value,
        businessNumber: businessNumber,
        corpNumber: corpNumber,
        establishDate: document.getElementById('establish-date').value,
        businessAge: document.getElementById('business-age')?.value || '',
        companySize: document.getElementById('company-size').value,
        companyType: document.getElementById('company-type').value,
        ksicCode: document.getElementById('ksic-code').value,
        productKeywords: document.getElementById('product-keywords').value,
        locationSido: document.getElementById('location-sido').value,
        locationSigungu: document.getElementById('location-sigungu').value,
        industrialComplex: document.getElementById('industrial-complex').value,
        capitalArea: document.getElementById('capital-area').value,
        
        // Section 2
        ceoName: document.getElementById('ceo-name').value,
        ceoBirth: document.getElementById('ceo-birth').value,
        ceoGender: document.getElementById('ceo-gender').value,
        ceoDisabled: document.getElementById('ceo-disabled').value,
        ceoVeteran: document.getElementById('ceo-veteran').value,
        ceoDefector: document.getElementById('ceo-defector').value,
        ceoRestart: document.getElementById('ceo-restart').value,
        guaranteeExempt: document.getElementById('guarantee-exempt').value,
        
        // Section 3 (ìˆ«ì í•„ë“œëŠ” ì½¤ë§ˆ ì œê±°)
        revenueRecent: unformatNumber(document.getElementById('revenue-recent').value),
        revenuePrev1: unformatNumber(document.getElementById('revenue-prev1').value),
        revenuePrev2: unformatNumber(document.getElementById('revenue-prev2').value),
        profitRecent: unformatNumber(document.getElementById('profit-recent').value),
        capital: unformatNumber(document.getElementById('capital').value),
        totalEquity: unformatNumber(document.getElementById('total-equity').value),
        totalDebt: unformatNumber(document.getElementById('total-debt').value),
        debtRatio: unformatNumber(document.getElementById('debt-ratio').value),
        taxArrears: unformatNumber(document.getElementById('tax-arrears').value),
        localTaxArrears: unformatNumber(document.getElementById('local-tax-arrears').value),
        insuranceArrears: unformatNumber(document.getElementById('insurance-arrears').value),
        capitalErosion: document.getElementById('capital-erosion').value,
        bankruptcyHistory: document.getElementById('bankruptcy-history').value,
        creditRating: document.getElementById('credit-rating').value,
        tcbRating: document.getElementById('tcb-rating').value,
        
        // Section 4 (ìˆ«ì í•„ë“œëŠ” ì½¤ë§ˆ ì œê±°)
        employeesTotal: unformatNumber(document.getElementById('employees-total').value),
        employeesPrev: unformatNumber(document.getElementById('employees-prev').value),
        employeesYouth: unformatNumber(document.getElementById('employees-youth').value),
        employeesFemale: unformatNumber(document.getElementById('employees-female').value),
        employeesDisabled: unformatNumber(document.getElementById('employees-disabled').value),
        employeesSenior: unformatNumber(document.getElementById('employees-senior').value),
        irregularRatio: unformatNumber(document.getElementById('irregular-ratio').value),
        hiringPlan: unformatNumber(document.getElementById('hiring-plan').value),
        hiringField: document.getElementById('hiring-field').value,
        
        // Section 5
        certVenture: document.getElementById('cert-venture').value,
        certVentureExpire: document.getElementById('cert-venture-expire').value,
        certInnobiz: document.getElementById('cert-innobiz').value,
        certInnobizExpire: document.getElementById('cert-innobiz-expire').value,
        certMainbiz: document.getElementById('cert-mainbiz').value,
        certMainbizExpire: document.getElementById('cert-mainbiz-expire').value,
        certGreen: document.getElementById('cert-green').value,
        certMaterials: document.getElementById('cert-materials').value,
        certRoot: document.getElementById('cert-root').value,
        certWorldclass: document.getElementById('cert-worldclass').value,
        researchOrg: document.getElementById('research-org').value,
        researchers: unformatNumber(document.getElementById('researchers').value),
        rdInvestment: unformatNumber(document.getElementById('rd-investment').value),
        rdRatio: unformatNumber(document.getElementById('rd-ratio').value),
        patentsRegistered: unformatNumber(document.getElementById('patents-registered').value),
        patentsApplied: unformatNumber(document.getElementById('patents-applied').value),
        trademarks: unformatNumber(document.getElementById('trademarks').value),
        techTransfer: document.getElementById('tech-transfer').value,
        qualityCerts: Array.from(document.querySelectorAll('#iso-9001, #iso-14001, #iso-45001, #cert-gmp, #cert-kc, #cert-haccp, #cert-fda, #cert-ce')).filter(el => el.checked).map(el => el.value),
        esgRating: document.getElementById('esg-rating').value,
        carbonNeutral: document.getElementById('carbon-neutral').value,
        smartFactory: document.getElementById('smart-factory').value,
        digitalTransform: document.getElementById('digital-transform').value,
        
        // Section 6
        exportRecent: unformatNumber(document.getElementById('export-recent').value),
        exportPrev: unformatNumber(document.getElementById('export-prev').value),
        exportCountries: document.getElementById('export-countries').value,
        hsCode: document.getElementById('hs-code').value,
        overseasCert: document.getElementById('overseas-cert').value,
        overseasOffice: document.getElementById('overseas-office').value,
        overseasCountry: document.getElementById('overseas-country').value,
        ftaUse: document.getElementById('fta-use').value,
        exportVoucher: document.getElementById('export-voucher').value,
        overseasExhibition: document.getElementById('overseas-exhibition').value,
        
        // Section 7
        support2024: document.getElementById('support-2024').value,
        support2023: document.getElementById('support-2023').value,
        support2022: document.getElementById('support-2022').value,
        projectAbandon: document.getElementById('project-abandon').value,
        subsidyReturn: document.getElementById('subsidy-return').value,
        participationBan: document.getElementById('participation-ban').value,
        fraudHistory: document.getElementById('fraud-history').value,
        
        // Section 8
        specialTypes: Array.from(document.querySelectorAll('#social-enterprise, #social-venture, #preliminary-social, #village-enterprise, #cooperative, #agri-enterprise, #strong-small, #hidden-champion, #family-friendly, #youth-friendly')).filter(el => el.checked).map(el => el.value),
        
        // Section 9
        supportNeeds: Array.from(document.querySelectorAll('#support-funding, #support-rd, #support-commercialize, #support-marketing, #support-export, #support-hr, #support-facility, #support-consulting, #support-startup, #support-esg')).filter(el => el.checked).map(el => el.value),
        companyStage: document.querySelector('input[name="stage"]:checked')?.value || '',
        urgency: document.querySelector('input[name="urgency"]:checked')?.value || '',
        
        // Section 10
        largePartner: document.getElementById('large-partner').value,
        mainClient: document.getElementById('main-client').value,
        smeCooperation: document.getElementById('sme-cooperation').value,
        industryAcademia: document.getElementById('industry-academia').value,
        partnerInstitute: document.getElementById('partner-institute').value,
        reopenAfterClose: document.getElementById('reopen-after-close').value,
        closeDate: document.getElementById('close-date').value,
        familySuccession: document.getElementById('family-succession').value,
        successionYear: document.getElementById('succession-year').value,
        merger: document.getElementById('merger').value,
        mergerDate: document.getElementById('merger-date').value,
        companyStrength: document.getElementById('company-strength').value,
        mainDifficulty: document.getElementById('main-difficulty').value,
        policyKeywords: document.getElementById('policy-keywords').value
      };
      
      return data;
    }
    
    function updateCompanySelect() {
      const select = document.getElementById('company-select');
      select.innerHTML = '<option value="">-- ìƒˆë¡œ ì…ë ¥ --</option>';
      
      Object.keys(savedCompanies).forEach(id => {
        const company = savedCompanies[id];
        const option = document.createElement('option');
        option.value = id;
        option.textContent = `${company.companyName} (${company.companySize})`;
        select.appendChild(option);
      });
    }
    
    function loadSelectedCompany() {
      const select = document.getElementById('company-select');
      const companyId = select.value;
      
      if (!companyId) {
        clearForm();
        return;
      }
      
      const company = savedCompanies[companyId];
      if (!company) return;
      
      // ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸ ë¶„ë¦¬ (123-45-67890 â†’ 3ê°œ input)
      if (company.businessNumber) {
        const bizParts = company.businessNumber.split('-');
        if (bizParts.length === 3) {
          document.getElementById('business-number-1').value = bizParts[0];
          document.getElementById('business-number-2').value = bizParts[1];
          document.getElementById('business-number-3').value = bizParts[2];
        }
      }
      
      // ë²•ì¸ë“±ë¡ë²ˆí˜¸ ë¶„ë¦¬ (123456-1234567 â†’ 2ê°œ input)
      if (company.corpNumber) {
        const corpParts = company.corpNumber.split('-');
        if (corpParts.length === 2) {
          document.getElementById('corp-number-1').value = corpParts[0];
          document.getElementById('corp-number-2').value = corpParts[1];
        }
      }
      
      // ìˆ«ì í•„ë“œ ëª©ë¡
      const numberFieldKeys = [
        'revenueRecent', 'revenuePrev1', 'revenuePrev2', 'profitRecent',
        'capital', 'totalEquity', 'totalDebt', 'debtRatio',
        'taxArrears', 'localTaxArrears', 'insuranceArrears',
        'employeesTotal', 'employeesPrev', 'employeesYouth', 
        'employeesFemale', 'employeesDisabled', 'employeesSenior',
        'irregularRatio', 'hiringPlan',
        'researchers', 'rdInvestment', 'rdRatio',
        'patentsRegistered', 'patentsApplied', 'trademarks',
        'exportRecent', 'exportPrev'
      ];
      
      // ëª¨ë“  í•„ë“œì— ë°ì´í„° ë¡œë“œ
      Object.keys(company).forEach(key => {
        // businessNumber, corpNumberëŠ” ì´ë¯¸ ì²˜ë¦¬í–ˆìœ¼ë¯€ë¡œ ìŠ¤í‚µ
        if (key === 'businessNumber' || key === 'corpNumber') return;
        
        const element = document.getElementById(key.replace(/([A-Z])/g, '-$1').toLowerCase());
        if (element) {
          if (element.type === 'checkbox') {
            element.checked = company[key].includes(element.value);
          } else if (element.type === 'radio') {
            if (element.value === company[key]) element.checked = true;
          } else {
            // ìˆ«ì í•„ë“œëŠ” ì½¤ë§ˆ ì¶”ê°€
            if (numberFieldKeys.includes(key)) {
              element.value = formatNumber(company[key]);
            } else {
              element.value = company[key];
            }
          }
        }
      });
      
      console.log('âœ… ê³ ê°ì‚¬ ì •ë³´ ë¡œë“œ:', company.companyName);
    }
    
    async function saveCompany() {
      const companyData = collectFormData();
      
      if (!companyData.companyName) {
        alert('íšŒì‚¬ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        return;
      }
      
      if (!companyData.businessNumber) {
        alert('ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        return;
      }
      
      const companyId = Date.now().toString();
      savedCompanies[companyId] = {
        ...companyData,
        savedAt: new Date().toISOString()
      };
      
      // Google Driveì— ì•”í˜¸í™”í•˜ì—¬ ì €ì¥
      const success = await saveToDrive(savedCompanies);
      
      if (success) {
        updateCompanySelect();
        alert(`âœ… "${companyData.companyName}" ì €ì¥ ì™„ë£Œ!\n\nğŸ” êµ¬ê¸€ ë“œë¼ì´ë¸Œì— AES-256 ì•”í˜¸í™”ë¡œ ì•ˆì „í•˜ê²Œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.`);
        console.log('ğŸ’¾ ê³ ê°ì‚¬ ì €ì¥ ì™„ë£Œ (Google Drive + ì•”í˜¸í™”)');
      } else {
        alert('âŒ ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
      }
    }
    
    function clearForm() {
      document.querySelectorAll('input, select, textarea').forEach(el => {
        if (el.type === 'checkbox' || el.type === 'radio') {
          el.checked = false;
        } else {
          el.value = '';
        }
      });
      document.getElementById('company-select').value = '';
    }
    
    // ==================== í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ ë§¤ì¹­ ì—”ì§„ ====================
    
    /**
     * ì—…ë ¥ ê³„ì‚° (ë…„)
     */
    function calculateBusinessAge(establishDate) {
      if (!establishDate) return 0;
      const today = new Date();
      const established = new Date(establishDate);
      const years = (today - established) / (365.25 * 24 * 60 * 60 * 1000);
      return Math.floor(years);
    }
    
    /**
     * ë‚˜ì´ ê³„ì‚°
     */
    function calculateAge(birthDate) {
      if (!birthDate) return 0;
      const today = new Date();
      const birth = new Date(birthDate);
      const age = (today - birth) / (365.25 * 24 * 60 * 60 * 1000);
      return Math.floor(age);
    }
    
    /**
     * í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ ë§¤ì¹­ ì—”ì§„
     * ë°±ì—”ë“œ ì—†ì´ ì‘ë™í•˜ëŠ” ì§€ì›ì‚¬ì—… ì¶”ì²œ ì•Œê³ ë¦¬ì¦˜
     */
    function clientSideMatching(companyData) {
      console.log('ğŸ¯ í´ë¼ì´ì–¸íŠ¸ ë§¤ì¹­ ì‹œì‘:', companyData.companyName);
      
      const businessAge = calculateBusinessAge(companyData.establishDate);
      const ceoAge = calculateAge(companyData.ceoBirth);
      
      console.log(`ğŸ“Š ê¸°ì—… ì •ë³´ - ì—…ë ¥: ${businessAge}ë…„, CEO ë‚˜ì´: ${ceoAge}ì„¸`);
      
      // Step 1: Kill-Out í•„í„° (ì¦‰ì‹œ íƒˆë½)
      let eligiblePrograms = MOCK_PROGRAMS.filter(program => {
        // ì²´ë‚© ì²´í¬
        if (program.requiresNoArrears) {
          if (companyData.taxArrears === 'Y' || companyData.localTaxArrears === 'Y') {
            console.log(`âŒ ${program.name}: ì²´ë‚©ìœ¼ë¡œ ì œì™¸`);
            return false;
          }
        }
        
        // ì—…ë ¥ ìµœì†Œ ìš”ê±´
        if (program.minBusinessAge !== null && program.minBusinessAge !== undefined) {
          if (businessAge < program.minBusinessAge) {
            console.log(`âŒ ${program.name}: ìµœì†Œ ì—…ë ¥ ë¯¸ë‹¬ (í•„ìš”: ${program.minBusinessAge}ë…„, í˜„ì¬: ${businessAge}ë…„)`);
            return false;
          }
        }
        
        // ì—…ë ¥ ìµœëŒ€ ì œí•œ
        if (program.maxBusinessAge !== null && program.maxBusinessAge !== undefined) {
          if (businessAge > program.maxBusinessAge) {
            console.log(`âŒ ${program.name}: ì—…ë ¥ ì´ˆê³¼ (ìµœëŒ€: ${program.maxBusinessAge}ë…„, í˜„ì¬: ${businessAge}ë…„)`);
            return false;
          }
        }
        
        // ê¸°ì—…ê·œëª¨ ì²´í¬
        if (program.targetCompanySize && program.targetCompanySize.length > 0) {
          if (!program.targetCompanySize.includes(companyData.companySize)) {
            console.log(`âŒ ${program.name}: ê¸°ì—…ê·œëª¨ ë¶ˆì¼ì¹˜`);
            return false;
          }
        }
        
        // CEO ë‚˜ì´ ì œí•œ
        if (program.maxCeoAge !== null && program.maxCeoAge !== undefined) {
          if (ceoAge > program.maxCeoAge) {
            console.log(`âŒ ${program.name}: CEO ë‚˜ì´ ì´ˆê³¼ (ìµœëŒ€: ${program.maxCeoAge}ì„¸, í˜„ì¬: ${ceoAge}ì„¸)`);
            return false;
          }
        }
        
        return true;
      });
      
      console.log(`âœ… Kill-Out í†µê³¼: ${eligiblePrograms.length}ê°œ í”„ë¡œê·¸ë¨`);
      
      // Step 2: ë§¤ì¹­ ì ìˆ˜ ê³„ì‚° (Scoring)
      const scoredPrograms = eligiblePrograms.map(program => {
        let score = 50; // ê¸°ë³¸ ì ìˆ˜
        let reasons = [];
        
        // ì—…ì¢… ë§¤ì¹­ (ìµœëŒ€ +30ì )
        if (program.targetIndustry && program.targetIndustry.length > 0) {
          if (program.targetIndustry.includes(companyData.ksicCode)) {
            score += 30;
            reasons.push('âœ… ì—…ì¢…ì´ ì •í™•íˆ ì¼ì¹˜í•©ë‹ˆë‹¤');
          } else if (program.targetIndustry.some(code => 
            companyData.ksicCode.startsWith(code.substring(0, 2)))) {
            score += 15;
            reasons.push('âœ… ê´€ë ¨ ì—…ì¢…ì…ë‹ˆë‹¤');
          }
        } else {
          // ì „ ì—…ì¢… ëŒ€ìƒ
          score += 10;
          reasons.push('âœ… ëª¨ë“  ì—…ì¢… ì§€ì› ê°€ëŠ¥');
        }
        
        // ì¸ì¦ ê°€ì‚°ì  (ìµœëŒ€ +20ì )
        if (program.prefersVenture && companyData.certVenture === 'Y') {
          score += 10;
          reasons.push('ğŸš€ ë²¤ì²˜ê¸°ì—… ì¸ì¦ ë³´ìœ ');
        }
        if (program.prefersInnobiz && companyData.certInnobiz === 'Y') {
          score += 8;
          reasons.push('ğŸ’¡ ì´ë…¸ë¹„ì¦ˆ ì¸ì¦ ë³´ìœ ');
        }
        if (program.prefersMainbiz && companyData.certMainbiz === 'Y') {
          score += 5;
          reasons.push('â­ ë©”ì¸ë¹„ì¦ˆ ì¸ì¦ ë³´ìœ ');
        }
        
        // íŠ¹í—ˆ ê°€ì‚°ì  (ìµœëŒ€ +15ì )
        if (program.prefersPatent) {
          const patents = parseInt(companyData.patentRegistered) || 0;
          if (patents >= 10) {
            score += 15;
            reasons.push(`ğŸ“œ íŠ¹í—ˆ ${patents}ê±´ ë³´ìœ  (ê¸°ìˆ ë ¥ ìš°ìˆ˜)`);
          } else if (patents >= 5) {
            score += 10;
            reasons.push(`ğŸ“œ íŠ¹í—ˆ ${patents}ê±´ ë³´ìœ `);
          } else if (patents >= 1) {
            score += 5;
            reasons.push(`ğŸ“œ íŠ¹í—ˆ ${patents}ê±´ ë³´ìœ `);
          }
        }
        
        // ê³ ìš© ê°€ì‚°ì  (ìµœëŒ€ +20ì )
        if (program.prefersYouthEmployment && companyData.employeesTotal > 0) {
          const youthRatio = companyData.employeesYouth / companyData.employeesTotal;
          if (youthRatio >= 0.3) {
            score += 10;
            reasons.push(`ğŸ‘¥ ì²­ë…„ê³ ìš© ë¹„ìœ¨ ${Math.round(youthRatio * 100)}%`);
          } else if (youthRatio >= 0.2) {
            score += 5;
            reasons.push(`ğŸ‘¥ ì²­ë…„ê³ ìš© ë¹„ìœ¨ ${Math.round(youthRatio * 100)}%`);
          }
        }
        
        if (program.prefersFemaleEmployment && companyData.employeesTotal > 0) {
          const femaleRatio = companyData.employeesFemale / companyData.employeesTotal;
          if (femaleRatio >= 0.3) {
            score += 8;
            reasons.push(`ğŸ‘© ì—¬ì„±ê³ ìš© ë¹„ìœ¨ ${Math.round(femaleRatio * 100)}%`);
          }
        }
        
        if (companyData.employeesDisabled > 0) {
          score += 12;
          reasons.push(`â™¿ ì¥ì• ì¸ ê³ ìš© ${companyData.employeesDisabled}ëª…`);
        }
        
        // ìˆ˜ì¶œ ê°€ì‚°ì  (ìµœëŒ€ +10ì )
        if (program.prefersExport && companyData.exportRecent > 0) {
          score += 10;
          reasons.push(`ğŸŒ ìˆ˜ì¶œì‹¤ì  $${companyData.exportRecent.toLocaleString()}`);
        }
        
        // R&D íˆ¬ì ê°€ì‚°ì  (ìµœëŒ€ +10ì )
        if (program.prefersRnD && companyData.rdInvestment > 0) {
          score += 8;
          reasons.push(`ğŸ”¬ R&D íˆ¬ì ${companyData.rdInvestment.toLocaleString()}ë°±ë§Œì›`);
        }
        
        // ì§€ì—­ ê°€ì‚°ì  (ìµœëŒ€ +10ì )
        if (program.targetRegion && program.targetRegion.length > 0) {
          if (program.targetRegion.includes(companyData.locationSido)) {
            score += 10;
            reasons.push(`ğŸ“ ${companyData.locationSido} ì§€ì—­ ìš°ëŒ€`);
          }
        }
        
        // ìˆ˜ë„ê¶Œ ì—¬ë¶€
        if (program.preferNonCapital && companyData.capitalArea === 'N') {
          score += 8;
          reasons.push('ğŸï¸ ë¹„ìˆ˜ë„ê¶Œ ìš°ëŒ€ì‚¬ì—…');
        }
        
        // ê¸°ì—… ë‹¨ê³„ë³„ ê°€ì‚°ì 
        if (companyData.companyStage === 'ì°½ì—…ì¤€ë¹„' && program.maxBusinessAge === 0) {
          score += 15;
          reasons.push('ğŸŒ± ì˜ˆë¹„ì°½ì—…ì ëŒ€ìƒ ì‚¬ì—…');
        }
        
        // ê¸´ê¸‰ë„ ë°˜ì˜
        if (companyData.urgency === 'urgent' && program.category === 'ê¸ˆìœµ') {
          score += 5;
          reasons.push('âš¡ ê¸´ê¸‰ ìê¸ˆ í•„ìš”ì— ì í•©');
        }
        
        return {
          ...program,
          matchScore: Math.min(score, 100), // ìµœëŒ€ 100ì 
          matchReasons: reasons.length > 0 ? reasons : ['ê¸°ë³¸ ìš”ê±´ ì¶©ì¡±']
        };
      });
      
      // Step 3: ì ìˆ˜ìˆœ ì •ë ¬
      const sortedPrograms = scoredPrograms.sort((a, b) => b.matchScore - a.matchScore);
      
      console.log(`ğŸ¯ ìµœì¢… ì¶”ì²œ: ${sortedPrograms.length}ê°œ í”„ë¡œê·¸ë¨`);
      sortedPrograms.slice(0, 5).forEach((p, i) => {
        console.log(`  ${i + 1}ìœ„. ${p.name} (${p.matchScore}ì )`);
      });
      
      return sortedPrograms;
    }
    
    async function analyzePrograms() {
      const companyData = collectFormData();
      
      // í•„ìˆ˜ í•„ë“œ ê²€ì¦
      if (!companyData.companyName || !companyData.businessNumber || !companyData.establishDate ||
          !companyData.companySize || !companyData.companyType || !companyData.ksicCode ||
          !companyData.locationSido || !companyData.capitalArea || !companyData.ceoName ||
          !companyData.ceoBirth || !companyData.ceoGender || !companyData.revenueRecent ||
          !companyData.taxArrears || !companyData.localTaxArrears || !companyData.employeesTotal ||
          !companyData.supportNeeds.length || !companyData.companyStage || !companyData.urgency) {
        alert('í•„ìˆ˜ í•­ëª©(*)ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        return;
      }
      
      try {
        showLoadingOverlay('AI ë¶„ì„ ì¤‘...', 'ë§ì¶¤í˜• ì§€ì›ì‚¬ì—… ì¶”ì²œ ì¤‘');
        
        // í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ ë§¤ì¹­ ì‹¤í–‰
        const results = clientSideMatching(companyData);
        
        // ì•½ê°„ì˜ ëŒ€ê¸° ì‹œê°„ (ë¡œë”© íš¨ê³¼)
        await new Promise(resolve => setTimeout(resolve, 800));
        
        hideLoadingOverlay();
        displayResults({ recommendations: results });
        
      } catch (error) {
        hideLoadingOverlay();
        console.error('âŒ ë¶„ì„ ì‹¤íŒ¨:', error);
        alert('ë¶„ì„ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\n\n' + error.message);
      }
    }
    
    function showLoadingOverlay(title, subtitle) {
      const overlay = document.createElement('div');
      overlay.className = 'loading-overlay';
      overlay.id = 'loading-overlay';
      overlay.innerHTML = `
        <div class="loader"></div>
        <h2>${title}</h2>
        <p>${subtitle}</p>
      `;
      document.body.appendChild(overlay);
    }
    
    function hideLoadingOverlay() {
      const overlay = document.getElementById('loading-overlay');
      if (overlay) overlay.remove();
    }
    
    function displayResults(result) {
      const section = document.getElementById('results-section');
      
      if (!result.recommendations || result.recommendations.length === 0) {
        section.innerHTML = `
          <div class="card">
            <h2>ğŸ“Š ë¶„ì„ ê²°ê³¼</h2>
            <div style="text-align: center; padding: 3rem; color: #666;">
              <p style="font-size: 1.2rem; margin-bottom: 1rem;">í˜„ì¬ ì¡°ê±´ì— ë§ëŠ” ì§€ì›ì‚¬ì—…ì„ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.</p>
              <p>â€¢ ì…ë ¥ ì •ë³´ë¥¼ ë‹¤ì‹œ í™•ì¸í•´ì£¼ì„¸ìš”</p>
              <p>â€¢ ë˜ëŠ” ë‹´ë‹¹ìì—ê²Œ ë¬¸ì˜í•˜ì„¸ìš” (1357-1357)</p>
            </div>
          </div>
        `;
        section.style.display = 'block';
        section.scrollIntoView({ behavior: 'smooth' });
        return;
      }
      
      let html = `
        <div class="card">
          <h2>ğŸ“Š ë§ì¶¤í˜• ì§€ì›ì‚¬ì—… ì¶”ì²œ ê²°ê³¼</h2>
          <p style="color: #666; margin-top: 0.5rem;">
            ì´ <strong style="color: #FF8802;">${result.recommendations.length}ê°œ</strong>ì˜ ì§€ì›ì‚¬ì—…ì´ ê·€ì‚¬ì— ì í•©í•©ë‹ˆë‹¤.
          </p>
        </div>
      `;
      
      result.recommendations.forEach((rec, index) => {
        const rankClass = index === 0 ? 'rank-1' : index === 1 ? 'rank-2' : index === 2 ? 'rank-3' : '';
        const rankEmoji = index === 0 ? 'ğŸ¥‡' : index === 1 ? 'ğŸ¥ˆ' : index === 2 ? 'ğŸ¥‰' : '';
        
        html += `
          <div class="result-card ${rankClass}">
            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 1rem;">
              <span class="rank">${rankEmoji} ${index + 1}ìœ„</span>
              <span class="match-score" style="font-size: 1.1rem; font-weight: bold;">ë§¤ì¹­ë„: ${rec.matchScore}ì </span>
            </div>
            
            <h3 style="color: #0c2c54; margin-bottom: 0.5rem;">${rec.name}</h3>
            <p style="color:#666;font-size:0.9rem;margin-bottom:0.75rem;">
              <strong>ì£¼ê´€:</strong> ${rec.organization} | 
              <strong>ë¶„ì•¼:</strong> ${rec.category}
            </p>
            
            <div style="margin-top:1rem;padding-top:1rem;border-top:2px solid #e0e0e0;">
              <h4 style="color:#0c2c54;margin-bottom:0.75rem;font-size:1.05rem;">ğŸ¯ ì¶”ì²œ ì´ìœ </h4>
              <ul style="color:#555;line-height:1.8;padding-left:1.5rem;margin-bottom:1.5rem;">
                ${rec.matchReasons.map(reason => `<li>${reason}</li>`).join('')}
              </ul>
              
              <h4 style="color:#0c2c54;margin-bottom:0.75rem;font-size:1.05rem;">ğŸ’° ì§€ì› ë‚´ìš©</h4>
              <div style="background: #f8f9fa; padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
                <p style="color:#333;margin-bottom:0.5rem;"><strong>ì§€ì› ê·œëª¨:</strong> ${rec.budget}</p>
                <p style="color:#555;line-height:1.6;margin:0;">${rec.description}</p>
              </div>
              
              <div style="display:flex;gap:0.75rem;margin-top:1rem;">
                <a href="${rec.website}" target="_blank" 
                   style="display:inline-block;padding:0.7rem 1.5rem;background:#FF8802;color:white;text-decoration:none;border-radius:8px;font-weight:600;font-size:0.95rem;transition:all 0.3s;">
                  ğŸ“‹ ìƒì„¸ë³´ê¸° â†’
                </a>
                <button onclick="alert('ìƒë‹´ ì˜ˆì•½ ê¸°ëŠ¥ì€ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.')"
                        style="display:inline-block;padding:0.7rem 1.5rem;background:#fff;color:#0c2c54;border:2px solid #0c2c54;border-radius:8px;font-weight:600;font-size:0.95rem;cursor:pointer;transition:all 0.3s;">
                  ğŸ“ ìƒë‹´ ì˜ˆì•½
                </button>
              </div>
            </div>
          </div>
        `;
      });
      
      section.innerHTML = html;
      section.style.display = 'block';
      section.scrollIntoView({ behavior: 'smooth' });
    }
    
    function goHome() {
      window.location.href = 'index.html';
    }
    
    // ==================== íšŒì‚¬ëª… ê²€ìƒ‰ ê¸°ëŠ¥ ====================
    let searchTimeout;
    
    function setupCompanySearch() {
      const searchBtn = document.getElementById('search-company-btn');
      const searchInput = document.getElementById('company-search-input');
      const searchBiz1 = document.getElementById('search-biz-1');
      const searchBiz2 = document.getElementById('search-biz-2');
      const searchBiz3 = document.getElementById('search-biz-3');
      const searchResults = document.getElementById('search-results');
      
      if (!searchBtn) return;
      
      // ì¡°íšŒ ë²„íŠ¼ í´ë¦­
      searchBtn.addEventListener('click', () => {
        const companyName = searchInput.value.trim();
        const bizNum = `${searchBiz1.value}-${searchBiz2.value}-${searchBiz3.value}`;
        
        // íšŒì‚¬ëª… ë˜ëŠ” ì‚¬ì—…ìë²ˆí˜¸ ì…ë ¥ í™•ì¸
        if (!companyName && bizNum.length < 12) {
          alert('âŒ íšŒì‚¬ëª… ë˜ëŠ” ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”');
          return;
        }
        
        // ê²€ìƒ‰ ì‹¤í–‰
        if (companyName) {
          searchCompanies(companyName, 'name');
        } else {
          searchCompanies(bizNum, 'biznum');
        }
      });
      
      // Enter í‚¤ ê²€ìƒ‰
      [searchInput, searchBiz1, searchBiz2, searchBiz3].forEach(input => {
        if (input) {
          input.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
              searchBtn.click();
            }
          });
        }
      });
      
      // ì™¸ë¶€ í´ë¦­ ì‹œ ê²€ìƒ‰ ê²°ê³¼ ìˆ¨ê¸°ê¸°
      document.addEventListener('click', (e) => {
        if (!searchResults.contains(e.target) && 
            !searchBtn.contains(e.target) &&
            !searchInput.contains(e.target)) {
          hideSearchResults();
        }
      });
    }
    
    function searchCompanies(query, type) {
      const searchResults = document.getElementById('search-results');
      
      // ë¡œë”© í‘œì‹œ
      searchResults.innerHTML = `
        <div class="search-loading" style="padding: 2rem; text-align: center; background: white; border-radius: 10px;">
          <div style="display: inline-block; width: 40px; height: 40px; border: 4px solid #f3f3f3; border-top: 4px solid #FF8802; border-radius: 50%; animation: spin 1s linear infinite;"></div>
          <div style="margin-top: 1rem; color: #666; font-size: 1rem;">ê²€ìƒ‰ ì¤‘...</div>
        </div>
      `;
      searchResults.style.display = 'block';
      
      // ê²€ìƒ‰ ì‹¤í–‰
      setTimeout(() => {
        let results;
        if (type === 'name') {
          results = MOCK_COMPANIES.filter(c => 
            c.name.toLowerCase().includes(query.toLowerCase())
          );
        } else {
          results = MOCK_COMPANIES.filter(c => 
            c.businessNumber === query
          );
        }
        
        displaySearchResults(results);
      }, 300);
    }
    
    function displaySearchResults(companies) {
      const searchResults = document.getElementById('search-results');
      
      if (companies.length === 0) {
        searchResults.innerHTML = `
          <div style="padding: 2rem; text-align: center; background: white; border-radius: 10px; color: #999;">
            âŒ ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤
          </div>
        `;
        searchResults.style.display = 'block';
        return;
      }
      
      searchResults.innerHTML = companies.map(company => `
        <div class="search-result-item" onclick="selectCompanyAndFill('${company.businessNumber}')" style="padding: 1.5rem; border-bottom: 1px solid #eee; cursor: pointer; transition: all 0.2s; background: white;" onmouseover="this.style.background='#f8f9fa'" onmouseout="this.style.background='white'">
          <div style="font-weight: 700; color: #333; margin-bottom: 0.5rem; font-size: 1.1rem;">${company.name}</div>
          <div style="display: flex; gap: 1.5rem; color: #666; font-size: 0.9rem;">
            <span>ğŸ“‹ ${company.businessNumber}</span>
            <span>ğŸ‘¤ ${company.ceo}</span>
          </div>
        </div>
      `).join('');
      searchResults.style.display = 'block';
    }
    
    function hideSearchResults() {
      const searchResults = document.getElementById('search-results');
      if (searchResults) {
        searchResults.style.display = 'none';
      }
    }
    
    // íšŒì‚¬ ì„ íƒ í›„ ë°”ë¡œ ìë™ì…ë ¥
    async function selectCompanyAndFill(businessNumber) {
      // ì‚¬ì—…ìë²ˆí˜¸ ì…ë ¥
      const parts = businessNumber.split('-');
      const bn1 = document.getElementById('business-number-1');
      const bn2 = document.getElementById('business-number-2');
      const bn3 = document.getElementById('business-number-3');
      
      if (bn1) bn1.value = parts[0];
      if (bn2) bn2.value = parts[1];
      if (bn3) bn3.value = parts[2];
      
      // ê²€ìƒ‰ ê²°ê³¼ ìˆ¨ê¸°ê¸°
      hideSearchResults();
      
      // ê²€ìƒ‰ ì…ë ¥ì°½ ì´ˆê¸°í™”
      const searchInput = document.getElementById('company-search-input');
      const searchBiz1 = document.getElementById('search-biz-1');
      const searchBiz2 = document.getElementById('search-biz-2');
      const searchBiz3 = document.getElementById('search-biz-3');
      if (searchInput) searchInput.value = '';
      if (searchBiz1) searchBiz1.value = '';
      if (searchBiz2) searchBiz2.value = '';
      if (searchBiz3) searchBiz3.value = '';
      
      // ë¡œë”© í‘œì‹œ
      const loadingOverlay = document.createElement('div');
      loadingOverlay.id = 'auto-fill-loading';
      loadingOverlay.style.cssText = 'position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(12, 44, 84, 0.95); z-index: 10000; display: flex; flex-direction: column; align-items: center; justify-content: center; color: white;';
      loadingOverlay.innerHTML = `
        <div style="text-align: center; width: 90%; max-width: 500px;">
          <div style="width: 60px; height: 60px; border: 5px solid rgba(255,255,255,0.3); border-top: 5px solid #FF8802; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 2rem;"></div>
          <h2 style="font-size: 1.5rem; margin-bottom: 1rem;">ğŸ” ê¸°ì—…ì •ë³´ ì¡°íšŒ ì¤‘...</h2>
          <p id="loading-message" style="font-size: 1.1rem; color: rgba(255,255,255,0.8); margin-bottom: 2rem;">êµ­ì„¸ì²­ API í˜¸ì¶œ ì¤‘...</p>
          
          <!-- ì§„í–‰ë¥  ë°” -->
          <div style="width: 100%; background: rgba(255,255,255,0.2); height: 30px; border-radius: 15px; overflow: hidden; margin-bottom: 1rem;">
            <div id="progress-bar" style="width: 0%; height: 100%; background: linear-gradient(90deg, #4CAF50 0%, #8BC34A 100%); transition: width 0.3s ease; display: flex; align-items: center; justify-content: center;">
              <span id="progress-text" style="font-weight: bold; font-size: 0.9rem; color: white; text-shadow: 0 1px 2px rgba(0,0,0,0.3);"></span>
            </div>
          </div>
          
          <p style="font-size: 0.9rem; color: rgba(255,255,255,0.6);">ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”...</p>
        </div>
      `;
      document.body.appendChild(loadingOverlay);
      
      // ì§„í–‰ë¥  ì—…ë°ì´íŠ¸ í•¨ìˆ˜
      let progress = 0;
      const progressBar = document.getElementById('progress-bar');
      const progressText = document.getElementById('progress-text');
      
      const progressInterval = setInterval(() => {
        if (progress < 95) {
          progress += Math.random() * 10;
          if (progress > 95) progress = 95;
          
          if (progressBar) {
            progressBar.style.width = progress + '%';
          }
          if (progressText) {
            progressText.textContent = Math.floor(progress) + '%';
          }
        }
      }, 300);
      
      // ìë™ì…ë ¥ ì‹¤í–‰
      try {
        const result = await autoFillCompanyInfo(businessNumber);
        
        // ì§„í–‰ë¥  100% ì™„ë£Œ
        clearInterval(progressInterval);
        if (progressBar) progressBar.style.width = '100%';
        if (progressText) progressText.textContent = '100%';
        
        // ì ê¹ ëŒ€ê¸° (100% ë³´ì—¬ì£¼ê¸°)
        await new Promise(resolve => setTimeout(resolve, 300));
        
        // ë¡œë”© ì œê±°
        document.body.removeChild(loadingOverlay);
        
        // ì„±ê³µ íŒì—… í‘œì‹œ
        showSuccessPopup(result);
        
      } catch (error) {
        clearInterval(progressInterval);
        document.body.removeChild(loadingOverlay);
        console.error('ìë™ì…ë ¥ ì˜¤ë¥˜:', error);
        alert('âŒ ìë™ì…ë ¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\n\n' + error.message + '\n\nìˆ˜ë™ìœ¼ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.');
      }
    }
    
    // ìë™ì…ë ¥ ì„±ê³µ íŒì—…
    function showSuccessPopup(data) {
      const popup = document.createElement('div');
      popup.style.cssText = 'position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 10001; display: flex; align-items: center; justify-content: center; padding: 2rem;';
      
      popup.innerHTML = `
        <div style="background: white; border-radius: 20px; max-width: 600px; width: 100%; max-height: 80vh; overflow-y: auto; box-shadow: 0 20px 60px rgba(0,0,0,0.3);">
          <div style="background: linear-gradient(135deg, #0c2c54 0%, #2a5a8a 100%); color: white; padding: 2rem; border-radius: 20px 20px 0 0;">
            <h2 style="font-size: 1.8rem; margin-bottom: 0.5rem;">âœ… ìë™ì…ë ¥ ì™„ë£Œ!</h2>
            <p style="opacity: 0.9; font-size: 1rem;">ê¸°ì—…ì •ë³´ê°€ ì„±ê³µì ìœ¼ë¡œ ì…ë ¥ë˜ì—ˆìŠµë‹ˆë‹¤</p>
          </div>
          
          <div style="padding: 2rem;">
            <div style="margin-bottom: 1.5rem; padding-bottom: 1.5rem; border-bottom: 2px solid #f0f0f0;">
              <h3 style="color: #0c2c54; font-size: 1.3rem; margin-bottom: 1rem;">ğŸ“Š ì…ë ¥ëœ ì •ë³´</h3>
              
              <div style="display: grid; gap: 1rem;">
                ${data.companyName ? `
                  <div style="display: flex; padding: 0.75rem; background: #f8f9fa; border-radius: 8px;">
                    <div style="font-weight: 600; color: #666; width: 120px;">ê¸°ì—…ëª…</div>
                    <div style="color: #333; font-weight: 500;">${data.companyName}</div>
                  </div>
                ` : ''}
                
                ${data.ceo ? `
                  <div style="display: flex; padding: 0.75rem; background: #f8f9fa; border-radius: 8px;">
                    <div style="font-weight: 600; color: #666; width: 120px;">ëŒ€í‘œì</div>
                    <div style="color: #333; font-weight: 500;">${data.ceo}</div>
                  </div>
                ` : ''}
                
                ${data.startDate ? `
                  <div style="display: flex; padding: 0.75rem; background: #f8f9fa; border-radius: 8px;">
                    <div style="font-weight: 600; color: #666; width: 120px;">ê°œì—…ì¼</div>
                    <div style="color: #333; font-weight: 500;">${data.startDate}</div>
                  </div>
                ` : ''}
                
                ${data.businessStatus ? `
                  <div style="display: flex; padding: 0.75rem; background: #f8f9fa; border-radius: 8px;">
                    <div style="font-weight: 600; color: #666; width: 120px;">ì‚¬ì—…ììƒíƒœ</div>
                    <div style="color: ${data.businessStatus === 'ê³„ì†ì‚¬ì—…ì' ? '#10b981' : '#f59e0b'}; font-weight: 700;">${data.businessStatus}</div>
                  </div>
                ` : ''}
                
                ${data.capital ? `
                  <div style="display: flex; padding: 0.75rem; background: #f8f9fa; border-radius: 8px;">
                    <div style="font-weight: 600; color: #666; width: 120px;">ìë³¸ê¸ˆ</div>
                    <div style="color: #333; font-weight: 500;">${formatNumber(data.capital)}ì›</div>
                  </div>
                ` : ''}
                
                ${data.industry ? `
                  <div style="display: flex; padding: 0.75rem; background: #f8f9fa; border-radius: 8px;">
                    <div style="font-weight: 600; color: #666; width: 120px;">ì—…ì¢…</div>
                    <div style="color: #333; font-weight: 500;">${data.industry}</div>
                  </div>
                ` : ''}
                
                ${data.patents ? `
                  <div style="display: flex; padding: 0.75rem; background: #f8f9fa; border-radius: 8px;">
                    <div style="font-weight: 600; color: #666; width: 120px;">íŠ¹í—ˆ</div>
                    <div style="color: #333; font-weight: 500;">${data.patents}ê±´</div>
                  </div>
                ` : ''}
                
                ${data.venture ? `
                  <div style="display: flex; padding: 0.75rem; background: #f8f9fa; border-radius: 8px;">
                    <div style="font-weight: 600; color: #666; width: 120px;">ë²¤ì²˜ì¸ì¦</div>
                    <div style="color: ${data.venture === 'ìˆìŒ' ? '#10b981' : '#999'}; font-weight: 700;">${data.venture}</div>
                  </div>
                ` : ''}
                
                ${data.innobiz ? `
                  <div style="display: flex; padding: 0.75rem; background: #f8f9fa; border-radius: 8px;">
                    <div style="font-weight: 600; color: #666; width: 120px;">ì´ë…¸ë¹„ì¦ˆ</div>
                    <div style="color: ${data.innobiz === 'ìˆìŒ' ? '#10b981' : '#999'}; font-weight: 700;">${data.innobiz}</div>
                  </div>
                ` : ''}
              </div>
            </div>
            
            <button onclick="this.parentElement.parentElement.parentElement.remove()" style="width: 100%; padding: 1rem; background: linear-gradient(135deg, #FF8802 0%, #FF6B02 100%); color: white; border: none; border-radius: 10px; font-size: 1.1rem; font-weight: 700; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.transform='scale(1.02)'" onmouseout="this.style.transform='scale(1)'">
              í™•ì¸
            </button>
          </div>
        </div>
      `;
      
      document.body.appendChild(popup);
      
      // í´ë¦­ ì‹œ ë‹«ê¸°
      popup.addEventListener('click', (e) => {
        if (e.target === popup) {
          popup.remove();
        }
      });
    }
    
    function selectCompany(businessNumber) {
      // ì‚¬ì—…ìë²ˆí˜¸ ìë™ì…ë ¥
      const parts = businessNumber.split('-');
      const bn1 = document.getElementById('business-number-1');
      const bn2 = document.getElementById('business-number-2');
      const bn3 = document.getElementById('business-number-3');
      
      if (bn1) bn1.value = parts[0];
      if (bn2) bn2.value = parts[1];
      if (bn3) bn3.value = parts[2];
      
      // ê²€ìƒ‰ ê²°ê³¼ ìˆ¨ê¸°ê¸°
      hideSearchResults();
      
      // ê²€ìƒ‰ ì…ë ¥ì°½ ì´ˆê¸°í™”
      const searchInput = document.getElementById('company-search-input');
      if (searchInput) {
        searchInput.value = '';
      }
      
      // ìë™ìœ¼ë¡œ API í˜¸ì¶œ (íŒì—… ì—†ì´!)
      setTimeout(async () => {
        try {
          await autoFillCompanyInfo(businessNumber);
        } catch (error) {
          console.error('ìë™ì…ë ¥ ì˜¤ë¥˜:', error);
          alert('âŒ ìë™ì…ë ¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\nìˆ˜ë™ìœ¼ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        }
      }, 300);
    }
    
    // ==================== ê¸°ì—…ì •ë³´ ìë™ì…ë ¥ ====================
    function setupAutoFill() {
      const autoFillBtn = document.getElementById('auto-fill-btn');
      if (!autoFillBtn) return;
      
      const businessNum1 = document.getElementById('business-number-1');
      const businessNum2 = document.getElementById('business-number-2');
      const businessNum3 = document.getElementById('business-number-3');
      
      // ì‚¬ì—…ìë²ˆí˜¸ ì…ë ¥ ì‹œ ìë™ì…ë ¥ ë²„íŠ¼ í™œì„±í™”
      [businessNum1, businessNum2, businessNum3].forEach(input => {
        if (input) {
          input.addEventListener('input', () => {
            const hasAllNumbers = 
              businessNum1 && businessNum1.value.length === 3 &&
              businessNum2 && businessNum2.value.length === 2 &&
              businessNum3 && businessNum3.value.length === 5;
            
            if (autoFillBtn) {
              autoFillBtn.disabled = !hasAllNumbers;
            }
          });
        }
      });
      
      // ìë™ì…ë ¥ ë²„íŠ¼ í´ë¦­
      autoFillBtn.addEventListener('click', async () => {
        const businessNumber = `${businessNum1.value}-${businessNum2.value}-${businessNum3.value}`;
        
        autoFillBtn.disabled = true;
        autoFillBtn.innerHTML = '<span>â³</span><span>ì¡°íšŒ ì¤‘...</span>';
        
        try {
          await autoFillCompanyInfo(businessNumber);
        } catch (error) {
          console.error('ìë™ì…ë ¥ ì˜¤ë¥˜:', error);
          
          // ì—ëŸ¬ ìœ í˜•ì— ë”°ë¥¸ ëª…í™•í•œ ì•ˆë‚´
          let errorMsg = 'âŒ ê¸°ì—…ì •ë³´ ìë™ì…ë ¥ ì‹¤íŒ¨\n\n';
          
          if (error.message.includes('API') || error.message.includes('Failed to fetch')) {
            errorMsg += 'ğŸ“¡ API ì—°ê²° ì˜¤ë¥˜\n';
            errorMsg += 'â€¢ ë„¤íŠ¸ì›Œí¬ ì—°ê²°ì„ í™•ì¸í•´ì£¼ì„¸ìš”\n';
            errorMsg += 'â€¢ ë°©í™”ë²½ ì„¤ì •ì„ í™•ì¸í•´ì£¼ì„¸ìš”\n';
            errorMsg += 'â€¢ HTTPSë¡œ ì ‘ì†í–ˆëŠ”ì§€ í™•ì¸í•´ì£¼ì„¸ìš”\n\n';
          } else if (error.message.includes('ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤')) {
            errorMsg += 'ğŸ” ì‚¬ì—…ì ì •ë³´ ì—†ìŒ\n';
            errorMsg += 'â€¢ ì‚¬ì—…ìë²ˆí˜¸ë¥¼ ë‹¤ì‹œ í™•ì¸í•´ì£¼ì„¸ìš”\n';
            errorMsg += 'â€¢ íì—…ëœ ì‚¬ì—…ìì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤\n\n';
          } else {
            errorMsg += 'âš ï¸ ' + error.message + '\n\n';
          }
          
          errorMsg += 'ğŸ’¡ ìˆ˜ë™ìœ¼ë¡œ ì…ë ¥ì„ ì§„í–‰í•´ì£¼ì„¸ìš”';
          
          alert(errorMsg);
        } finally {
          autoFillBtn.disabled = false;
          autoFillBtn.innerHTML = '<span>ğŸ¤–</span><span>ê°€ì ¸ì˜¤ê¸°</span>';
        }
      });
    }
    
    // ============================================
    // ğŸ”¥ ì‹¤ì œ API ì„¤ì • ë° í˜¸ì¶œ í•¨ìˆ˜ë“¤
    // ============================================
    
    // âš ï¸ ë³´ì•ˆìƒì˜ ì´ìœ ë¡œ API Keyë¥¼ ì œê±°í–ˆìŠµë‹ˆë‹¤.
    // Phase 2ì—ì„œ ë°±ì—”ë“œ ì„œë²„(Netlify Functions)ë¡œ ì´ë™ ì˜ˆì •
    /*
    const API_CONFIG = {
      // ê³µí†µ ì¸ì¦í‚¤ (ëª¨ë“  API ì‚¬ìš©)
      API_KEY: '76d690873af0a9d983453b22529a6e313625867da9f460d7cb72f7ab9e654de1',
      
      // API ì—”ë“œí¬ì¸íŠ¸
      NTS_BASE_URL: 'https://api.odcloud.kr/api/nts-businessman/v1',
      FSC_BASE_URL: 'https://apis.data.go.kr/1160100/service/GetCorpBasicInfoService_V2',
      PATENT_BASE_URL: 'https://kipo-api.kipi.or.kr/openapi/service/patUtiModInfoSearchSevice',
      
      // 3ëŒ€ ì¸ì¦ API
      VENTURE_BASE_URL: 'https://api.odcloud.kr/api/15084581/v1/uddi:41944402-8249-4e45-9e9d-a03027ccf595',
      INNOBIZ_BASE_URL: 'https://api.odcloud.kr/api/15134641/v1/uddi:56633b5d-548b-45e5-a295-f0b0b1933c0f'
    };
    */
    
    /**
     * ğŸ¢ êµ­ì„¸ì²­ API - ì‚¬ì—…ìë“±ë¡ ìƒíƒœì¡°íšŒ
     */
    async function getNTSInfo(businessNumber) {
      try {
        console.log(`ğŸ” êµ­ì„¸ì²­ ì¡°íšŒ ì‹œì‘: ${businessNumber}`);
        
        // Netlify Function í˜¸ì¶œ
        const response = await fetch('/.netlify/functions/getNTS', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({
            businessNumber: businessNumber
          })
        });
        
        const result = await response.json();
        
        if (result.success) {
          console.log(`âœ… êµ­ì„¸ì²­ ì¡°íšŒ ì„±ê³µ: ${result.companyName}`);
        } else {
          console.log(`âŒ êµ­ì„¸ì²­ ì¡°íšŒ ì‹¤íŒ¨: ${result.message}`);
        }
        
        return result;
        
      } catch (error) {
        console.error('âŒ êµ­ì„¸ì²­ API ì˜¤ë¥˜:', error);
        return { success: false, message: 'API í˜¸ì¶œ ì‹¤íŒ¨: ' + error.message };
      }
    }
    
    /**
     * ğŸ›ï¸ ê¸ˆìœµìœ„ì›íšŒ API - ê¸°ì—…ê°œìš”ì¡°íšŒ
     */
    async function getFSCInfo(corpNumber) {
      try {
        console.log(`ğŸ›ï¸ ê¸ˆìœµìœ„ ì¡°íšŒ ì‹œì‘: ${corpNumber}`);
        
        // Netlify Function í˜¸ì¶œ
        const response = await fetch('/.netlify/functions/getFSC', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({
            corpNumber: corpNumber
          })
        });
        
        const result = await response.json();
        
        if (result.success) {
          console.log(`âœ… ê¸ˆìœµìœ„ ì¡°íšŒ ì„±ê³µ: ${result.companyName}`);
        } else {
          console.log(`âŒ ê¸ˆìœµìœ„ ì¡°íšŒ ì‹¤íŒ¨: ${result.message}`);
        }
        
        return result;
        
      } catch (error) {
        console.error('âŒ ê¸ˆìœµìœ„ API ì˜¤ë¥˜:', error);
        return { success: false, message: 'API í˜¸ì¶œ ì‹¤íŒ¨: ' + error.message };
      }
    }
    
    /**
     * ğŸ“œ íŠ¹í—ˆì²­ API - íŠ¹í—ˆ ê²€ìƒ‰
     */
    async function getPatentInfo(companyName) {
      try {
        const response = await fetch(
          `${API_CONFIG.PATENT_BASE_URL}/getWordSearch?` +
          `serviceKey=${encodeURIComponent(API_CONFIG.API_KEY)}&` +
          `word=${encodeURIComponent(companyName)}&` +
          `docsStart=1&` +
          `docsCount=10`
        );
        
        const text = await response.text();
        
        // XML íŒŒì‹±
        const parser = new DOMParser();
        const xmlDoc = parser.parseFromString(text, 'text/xml');
        
        const resultCode = xmlDoc.querySelector('resultCode')?.textContent;
        
        if (resultCode === '00') {
          const items = xmlDoc.querySelectorAll('item');
          const patents = [];
          
          items.forEach(item => {
            patents.push({
              title: item.querySelector('inventionTitle')?.textContent || '',
              applicationNumber: item.querySelector('applicationNumber')?.textContent || '',
              registrationNumber: item.querySelector('registrationNumber')?.textContent || '',
              applicant: item.querySelector('applicantName')?.textContent || '',
              applicationDate: item.querySelector('applicationDate')?.textContent || ''
            });
          });
          
          return {
            success: true,
            totalCount: patents.length,
            patents: patents
          };
        }
        return { success: false, message: 'íŠ¹í—ˆ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.' };
      } catch (error) {
        console.error('íŠ¹í—ˆì²­ API ì˜¤ë¥˜:', error);
        return { success: false, message: 'API í˜¸ì¶œ ì‹¤íŒ¨: ' + error.message };
      }
    }
    
    /**
     * ğŸš€ ë²¤ì²˜ê¸°ì—… ì¸ì¦ ì¡°íšŒ
     */
    async function getVentureInfo(companyName, businessNumber) {
      try {
        console.log(`ğŸš€ ë²¤ì²˜ì¸ì¦ ì¡°íšŒ ì‹œì‘: ${companyName}`);
        
        // Netlify Function í˜¸ì¶œ
        const response = await fetch('/.netlify/functions/getVenture', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({
            companyName: companyName,
            businessNumber: businessNumber
          })
        });
        
        const result = await response.json();
        
        if (result.success) {
          console.log(`âœ… ë²¤ì²˜ì¸ì¦ ì¡°íšŒ ì„±ê³µ: ${result.companyName}`);
        } else {
          console.log(`âŒ ë²¤ì²˜ì¸ì¦ ì¡°íšŒ ì‹¤íŒ¨: ${result.message}`);
        }
        
        return result;
        
      } catch (error) {
        console.error('âŒ ë²¤ì²˜ê¸°ì—… API ì˜¤ë¥˜:', error);
        return { success: false, message: 'API í˜¸ì¶œ ì‹¤íŒ¨: ' + error.message };
      }
    }
    
    /**
     * ğŸ’¡ ì´ë…¸ë¹„ì¦ˆ ì¸ì¦ ì¡°íšŒ
     */
    async function getInnobizInfo(companyName) {
      try {
        console.log(`ğŸ’¡ ì´ë…¸ë¹„ì¦ˆ ì¡°íšŒ ì‹œì‘: ${companyName}`);
        
        // Netlify Function í˜¸ì¶œ
        const response = await fetch('/.netlify/functions/getInnobiz', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({
            companyName: companyName
          })
        });
        
        const result = await response.json();
        
        if (result.success) {
          console.log(`âœ… ì´ë…¸ë¹„ì¦ˆ ì¡°íšŒ ì„±ê³µ: ${result.companyName}`);
        } else {
          console.log(`âŒ ì´ë…¸ë¹„ì¦ˆ ì¡°íšŒ ì‹¤íŒ¨: ${result.message}`);
        }
        
        return result;
        
      } catch (error) {
        console.error('âŒ ì´ë…¸ë¹„ì¦ˆ API ì˜¤ë¥˜:', error);
        return { success: false, message: 'API í˜¸ì¶œ ì‹¤íŒ¨: ' + error.message };
      }
    }
    
    /**
     * ğŸ¤– í†µí•© ìë™ì…ë ¥ í•¨ìˆ˜ (ì‹¤ì œ API í˜¸ì¶œ)
     */
    async function autoFillCompanyInfo(businessNumber) {
      const loadingMessages = [
        'ğŸ” êµ­ì„¸ì²­ì—ì„œ ê¸°ì—…ì •ë³´ ì¡°íšŒ ì¤‘...',
        'ğŸ›ï¸ ê¸ˆìœµìœ„ì›íšŒì—ì„œ ë²•ì¸ì •ë³´ í™•ì¸ ì¤‘...',
        'ğŸ“œ íŠ¹í—ˆì²­ì—ì„œ íŠ¹í—ˆì •ë³´ ê²€ìƒ‰ ì¤‘...',
        'ğŸš€ ë²¤ì²˜ê¸°ì—… ì¸ì¦ í™•ì¸ ì¤‘...',
        'ğŸ’¡ ì´ë…¸ë¹„ì¦ˆ ì¸ì¦ í™•ì¸ ì¤‘...',
        'âœ¨ ë°ì´í„° í†µí•© ì¤‘...'
      ];
      
      let messageIndex = 0;
      let fscData = null;
      let patentData = null;
      let ventureData = null;
      let innobizData = null;
      
      const messageInterval = setInterval(() => {
        const loadingMsg = document.getElementById('loading-message');
        if (loadingMsg && messageIndex < loadingMessages.length) {
          loadingMsg.textContent = loadingMessages[messageIndex];
          messageIndex++;
        }
      }, 800);
      
      try {
        // ê¸°ì¡´ ê¸°ì—…ëª… ì €ì¥ (ë¬¸ì œ 1 í•´ê²°)
        const companyNameElem = document.getElementById('company-name');
        const existingCompanyName = companyNameElem ? companyNameElem.value.trim() : '';
        
        // 1ë‹¨ê³„: êµ­ì„¸ì²­ APIë¡œ ê¸°ë³¸ ì •ë³´ ì¡°íšŒ
        let ntsData = await getNTSInfo(businessNumber);
        
        // API ì‹¤íŒ¨ ì‹œ MOCK ë°ì´í„°ë¡œ fallback (ë¬¸ì œ 2 í•´ê²°)
        if (!ntsData.success) {
          console.log('âš ï¸ API í˜¸ì¶œ ì‹¤íŒ¨, MOCK ë°ì´í„° ì‚¬ìš©');
          const cleanBN = businessNumber.replace(/-/g, '');
          const mockCompany = MOCK_COMPANIES.find(c => c.businessNumber.replace(/-/g, '') === cleanBN);
          
          if (mockCompany) {
            ntsData = {
              success: true,
              companyName: mockCompany.name,
              ceo: mockCompany.ceo,
              startDate: mockCompany.openingDate ? mockCompany.openingDate.replace(/-/g, '') : '',
              businessStatus: 'ê³„ì†ì‚¬ì—…ì',
              taxType: '',
              address: '',
              rbfTaxType: '',
              rbfTaxTypeCd: ''
            };
          } else {
            clearInterval(messageInterval);
            throw new Error('í•´ë‹¹ ì‚¬ì—…ìë²ˆí˜¸ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. (API ë° í…ŒìŠ¤íŠ¸ ë°ì´í„° ì—†ìŒ)');
          }
        }
        
        // ê¸°ë³¸ ì •ë³´ ì…ë ¥
        // ê¸°ì—…ëª…: ê¸°ì¡´ ê°’ì´ ìˆìœ¼ë©´ ìœ ì§€, ì—†ìœ¼ë©´ API ê°’ ì‚¬ìš© (ë¬¸ì œ 1 í•´ê²°)
        if (companyNameElem) {
          if (!existingCompanyName && ntsData.companyName) {
            companyNameElem.value = ntsData.companyName;
          } else if (existingCompanyName) {
            companyNameElem.value = existingCompanyName;
          }
        }
        
        const ceoNameElem = document.getElementById('ceo-name');
        if (ceoNameElem) ceoNameElem.value = ntsData.ceo;
        
        const establishDateElem = document.getElementById('establish-date');
        if (establishDateElem && ntsData.startDate) {
          const dateStr = ntsData.startDate;
          const formattedDate = `${dateStr.slice(0, 4)}-${dateStr.slice(4, 6)}-${dateStr.slice(6, 8)}`;
          establishDateElem.value = formattedDate;
        }
        
        // 2ë‹¨ê³„: ë²•ì¸ë²ˆí˜¸ê°€ ìˆìœ¼ë©´ ê¸ˆìœµìœ„ì›íšŒ API í˜¸ì¶œ
        const corpNum1 = document.getElementById('corp-number-1')?.value || '';
        const corpNum2 = document.getElementById('corp-number-2')?.value || '';
        
        if (corpNum1 && corpNum2) {
          const corpNumber = `${corpNum1}-${corpNum2}`;
          fscData = await getFSCInfo(corpNumber);
          
          if (fscData.success) {
            // ìë³¸ê¸ˆ
            const capitalElem = document.getElementById('capital');
            if (capitalElem && fscData.capital) {
              capitalElem.value = formatNumber(fscData.capital);
            }
            
            // ì—…ì¢…
            const industryElem = document.getElementById('industry');
            if (industryElem && fscData.industry) {
              industryElem.value = fscData.industry;
            }
            
            // ìƒì¥ì—¬ë¶€
            if (fscData.listed === 'Y') {
              const listedElem = document.getElementById('listed-yes');
              if (listedElem) listedElem.checked = true;
            }
          }
        }
        
        // 3ë‹¨ê³„: íŠ¹í—ˆ ì •ë³´ ì¡°íšŒ
        patentData = await getPatentInfo(ntsData.companyName);
        
        if (patentData.success && patentData.totalCount > 0) {
          const patentsElem = document.getElementById('patents-registered');
          if (patentsElem) {
            patentsElem.value = patentData.totalCount.toString();
          }
        }
        
        // 4ë‹¨ê³„: ë²¤ì²˜ê¸°ì—… ì¸ì¦ ì¡°íšŒ
        ventureData = await getVentureInfo(ntsData.companyName, businessNumber);
        
        if (ventureData.success) {
          const certVentureElem = document.getElementById('cert-venture');
          const certVentureExpireElem = document.getElementById('cert-venture-expire');
          
          if (certVentureElem) {
            certVentureElem.value = ventureData.isValid ? 'ìˆìŒ' : 'ë§Œë£Œ';
          }
          
          if (certVentureExpireElem && ventureData.endDate) {
            certVentureExpireElem.value = ventureData.endDate;
          }
        }
        
        // 5ë‹¨ê³„: ì´ë…¸ë¹„ì¦ˆ ì¸ì¦ ì¡°íšŒ
        innobizData = await getInnobizInfo(ntsData.companyName);
        
        if (innobizData.success) {
          const certInnobizElem = document.getElementById('cert-innobiz');
          const certInnobizExpireElem = document.getElementById('cert-innobiz-expire');
          
          if (certInnobizElem) {
            certInnobizElem.value = innobizData.isValid ? 'ìˆìŒ' : 'ë§Œë£Œ';
          }
          
          if (certInnobizExpireElem && innobizData.endDate) {
            certInnobizExpireElem.value = innobizData.endDate;
          }
        }
        
        clearInterval(messageInterval);
        
        // 3ëŒ€ ì¸ì¦ ì •ë³´ ì¶”ê°€
        let successMsg = `âœ… ê¸°ì—…ì •ë³´ ìë™ì…ë ¥ ì™„ë£Œ!\n\n`;
        successMsg += `ğŸ“Œ ${ntsData.companyName}\n`;
        successMsg += `ğŸ‘¤ ëŒ€í‘œì: ${ntsData.ceo}\n`;
        successMsg += `ğŸ“Š ì‚¬ì—…ììƒíƒœ: ${ntsData.businessStatus}\n`;
        
        if (patentData.success && patentData.totalCount > 0) {
          successMsg += `ğŸ“œ íŠ¹í—ˆ ë³´ìœ : ${patentData.totalCount}ê±´\n`;
        }
        
        // 3ëŒ€ ì¸ì¦ ì •ë³´ ì¶”ê°€
        if (ventureData.success || innobizData.success) {
          successMsg += `\nğŸ¯ 3ëŒ€ ì¸ì¦ í˜„í™©:\n`;
          
          if (ventureData.success) {
            successMsg += `ğŸš€ ë²¤ì²˜ê¸°ì—…: ${ventureData.isValid ? 'âœ… ìœ íš¨' : 'âŒ ë§Œë£Œ'} (${ventureData.endDate}ê¹Œì§€)\n`;
          }
          
          if (innobizData.success) {
            successMsg += `ğŸ’¡ ì´ë…¸ë¹„ì¦ˆ: ${innobizData.isValid ? 'âœ… ìœ íš¨' : 'âŒ ë§Œë£Œ'} (${innobizData.endDate}ê¹Œì§€)\n`;
          }
        }
        
        successMsg += `\në‚˜ë¨¸ì§€ í•­ëª©ì€ ìˆ˜ë™ìœ¼ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.`;
        
        // ê²°ê³¼ ë°˜í™˜
        clearInterval(messageInterval);
        return {
          success: true,
          companyName: ntsData.companyName,
          ceo: ntsData.ceo,
          startDate: ntsData.startDate ? `${ntsData.startDate.slice(0, 4)}-${ntsData.startDate.slice(4, 6)}-${ntsData.startDate.slice(6, 8)}` : null,
          businessStatus: ntsData.businessStatus,
          capital: fscData?.capital || null,
          industry: fscData?.industry || null,
          patents: patentData?.totalCount || null,
          venture: ventureData?.isValid ? 'ìˆìŒ' : ventureData?.success ? 'ë§Œë£Œ' : null,
          innobiz: innobizData?.isValid ? 'ìˆìŒ' : innobizData?.success ? 'ë§Œë£Œ' : null
        };
        
      } catch (error) {
        clearInterval(messageInterval);
        console.error('ìë™ì…ë ¥ ì˜¤ë¥˜:', error);
        throw error;
      }
    }
    
    function fillCompanyData(data) {
      // ê¸°ì—…ëª…
      const companyName = document.getElementById('company-name');
      if (companyName) companyName.value = data.name;
      
      // ëŒ€í‘œìëª…
      const ceoName = document.getElementById('ceo-name');
      if (ceoName && data.ceo) ceoName.value = data.ceo;
      
      // ê°œì—…ì¼
      const openingDate = document.getElementById('opening-date');
      if (openingDate && data.openingDate) openingDate.value = data.openingDate;
      
      // ê¸°ì—…ê·œëª¨
      const companySize = document.getElementById('company-size');
      if (companySize && data.companySize) companySize.value = data.companySize;
      
      // ê¸°ì—…í˜•íƒœ
      const companyType = document.getElementById('company-type');
      if (companyType && data.companyType) companyType.value = data.companyType;
      
      // ë§¤ì¶œì•¡
      const revenue = document.getElementById('revenue');
      if (revenue && data.revenue) {
        revenue.value = parseInt(data.revenue).toLocaleString('ko-KR');
      }
      
      // ì§ì›ìˆ˜
      const employeeCount = document.getElementById('total-employees');
      if (employeeCount && data.employeeCount) employeeCount.value = data.employeeCount;
      
      // ì²´ë‚© ì •ë³´ ì´ˆê¸°í™” (ì¼ë°˜ì ìœ¼ë¡œ 0)
      const taxArrears = document.getElementById('tax-arrears');
      if (taxArrears) taxArrears.value = '0';
      
      const localTaxArrears = document.getElementById('local-tax-arrears');
      if (localTaxArrears) localTaxArrears.value = '0';
      
      // ì—…ì¢…ì½”ë“œ (KSIC ì½”ë“œ)
      const ksicCode = document.getElementById('ksic-code');
      if (ksicCode && data.industryCode) {
        ksicCode.value = data.industryCode;
      }
      
      // ì†Œì¬ì§€ (ì‹œë„ + ì‹œêµ°êµ¬)
      const locationSido = document.getElementById('location-sido');
      if (locationSido && data.locationSido) {
        locationSido.value = data.locationSido;
        // ì‹œêµ°êµ¬ ì˜µì…˜ ì—…ë°ì´íŠ¸ (ìˆ˜ë„ê¶Œ ì—¬ë¶€ë„ ìë™ ì„¤ì •ë¨)
        updateSigunguOptions();
        
        // ì‹œêµ°êµ¬ ì„¤ì • (DOM ì—…ë°ì´íŠ¸ ëŒ€ê¸°)
        setTimeout(() => {
          const locationSigungu = document.getElementById('location-sigungu');
          if (locationSigungu && data.locationSigungu) {
            locationSigungu.value = data.locationSigungu;
          }
        }, 100);
      }
      
      console.log('âœ… ìë™ì…ë ¥ ì™„ë£Œ:', data.name);
    }
    
    // ==================== ì‹œêµ°êµ¬ ë° ìˆ˜ë„ê¶Œ ìë™ ì„¤ì • ====================
    
    // ì‹œë„ë³„ ì‹œêµ°êµ¬ ë°ì´í„°
    const SIGUNGU_DATA = {
      'ì„œìš¸': ['ì¢…ë¡œêµ¬', 'ì¤‘êµ¬', 'ìš©ì‚°êµ¬', 'ì„±ë™êµ¬', 'ê´‘ì§„êµ¬', 'ë™ëŒ€ë¬¸êµ¬', 'ì¤‘ë‘êµ¬', 'ì„±ë¶êµ¬', 'ê°•ë¶êµ¬', 'ë„ë´‰êµ¬', 'ë…¸ì›êµ¬', 'ì€í‰êµ¬', 'ì„œëŒ€ë¬¸êµ¬', 'ë§ˆí¬êµ¬', 'ì–‘ì²œêµ¬', 'ê°•ì„œêµ¬', 'êµ¬ë¡œêµ¬', 'ê¸ˆì²œêµ¬', 'ì˜ë“±í¬êµ¬', 'ë™ì‘êµ¬', 'ê´€ì•…êµ¬', 'ì„œì´ˆêµ¬', 'ê°•ë‚¨êµ¬', 'ì†¡íŒŒêµ¬', 'ê°•ë™êµ¬'],
      'ê²½ê¸°': ['ìˆ˜ì›ì‹œ', 'ì„±ë‚¨ì‹œ', 'ê³ ì–‘ì‹œ', 'ìš©ì¸ì‹œ', 'ë¶€ì²œì‹œ', 'ì•ˆì‚°ì‹œ', 'ì•ˆì–‘ì‹œ', 'ë‚¨ì–‘ì£¼ì‹œ', 'í™”ì„±ì‹œ', 'í‰íƒì‹œ', 'ì˜ì •ë¶€ì‹œ', 'ì‹œí¥ì‹œ', 'íŒŒì£¼ì‹œ', 'ê¹€í¬ì‹œ', 'ê´‘ëª…ì‹œ', 'ê´‘ì£¼ì‹œ', 'êµ°í¬ì‹œ', 'í•˜ë‚¨ì‹œ', 'ì˜¤ì‚°ì‹œ', 'ì–‘ì£¼ì‹œ', 'ì´ì²œì‹œ', 'êµ¬ë¦¬ì‹œ', 'ì•ˆì„±ì‹œ', 'í¬ì²œì‹œ', 'ì˜ì™•ì‹œ', 'ì–‘í‰êµ°', 'ì—¬ì£¼ì‹œ', 'ë™ë‘ì²œì‹œ', 'ê³¼ì²œì‹œ', 'ê°€í‰êµ°', 'ì—°ì²œêµ°'],
      'ì¸ì²œ': ['ì¤‘êµ¬', 'ë™êµ¬', 'ë¯¸ì¶”í™€êµ¬', 'ì—°ìˆ˜êµ¬', 'ë‚¨ë™êµ¬', 'ë¶€í‰êµ¬', 'ê³„ì–‘êµ¬', 'ì„œêµ¬', 'ê°•í™”êµ°', 'ì˜¹ì§„êµ°'],
      'ë¶€ì‚°': ['ì¤‘êµ¬', 'ì„œêµ¬', 'ë™êµ¬', 'ì˜ë„êµ¬', 'ë¶€ì‚°ì§„êµ¬', 'ë™ë˜êµ¬', 'ë‚¨êµ¬', 'ë¶êµ¬', 'í•´ìš´ëŒ€êµ¬', 'ì‚¬í•˜êµ¬', 'ê¸ˆì •êµ¬', 'ê°•ì„œêµ¬', 'ì—°ì œêµ¬', 'ìˆ˜ì˜êµ¬', 'ì‚¬ìƒêµ¬', 'ê¸°ì¥êµ°'],
      'ëŒ€êµ¬': ['ì¤‘êµ¬', 'ë™êµ¬', 'ì„œêµ¬', 'ë‚¨êµ¬', 'ë¶êµ¬', 'ìˆ˜ì„±êµ¬', 'ë‹¬ì„œêµ¬', 'ë‹¬ì„±êµ°'],
      'ëŒ€ì „': ['ë™êµ¬', 'ì¤‘êµ¬', 'ì„œêµ¬', 'ìœ ì„±êµ¬', 'ëŒ€ë•êµ¬'],
      'ê´‘ì£¼': ['ë™êµ¬', 'ì„œêµ¬', 'ë‚¨êµ¬', 'ë¶êµ¬', 'ê´‘ì‚°êµ¬'],
      'ìš¸ì‚°': ['ì¤‘êµ¬', 'ë‚¨êµ¬', 'ë™êµ¬', 'ë¶êµ¬', 'ìš¸ì£¼êµ°'],
      'ì„¸ì¢…': ['ì„¸ì¢…ì‹œ'],
      'ê°•ì›': ['ì¶˜ì²œì‹œ', 'ì›ì£¼ì‹œ', 'ê°•ë¦‰ì‹œ', 'ë™í•´ì‹œ', 'íƒœë°±ì‹œ', 'ì†ì´ˆì‹œ', 'ì‚¼ì²™ì‹œ', 'í™ì²œêµ°', 'íš¡ì„±êµ°', 'ì˜ì›”êµ°', 'í‰ì°½êµ°', 'ì •ì„ êµ°', 'ì² ì›êµ°', 'í™”ì²œêµ°', 'ì–‘êµ¬êµ°', 'ì¸ì œêµ°', 'ê³ ì„±êµ°', 'ì–‘ì–‘êµ°'],
      'ì¶©ë¶': ['ì²­ì£¼ì‹œ', 'ì¶©ì£¼ì‹œ', 'ì œì²œì‹œ', 'ë³´ì€êµ°', 'ì˜¥ì²œêµ°', 'ì˜ë™êµ°', 'ì¦í‰êµ°', 'ì§„ì²œêµ°', 'ê´´ì‚°êµ°', 'ìŒì„±êµ°', 'ë‹¨ì–‘êµ°'],
      'ì¶©ë‚¨': ['ì²œì•ˆì‹œ', 'ê³µì£¼ì‹œ', 'ë³´ë ¹ì‹œ', 'ì•„ì‚°ì‹œ', 'ì„œì‚°ì‹œ', 'ë…¼ì‚°ì‹œ', 'ê³„ë£¡ì‹œ', 'ë‹¹ì§„ì‹œ', 'ê¸ˆì‚°êµ°', 'ë¶€ì—¬êµ°', 'ì„œì²œêµ°', 'ì²­ì–‘êµ°', 'í™ì„±êµ°', 'ì˜ˆì‚°êµ°', 'íƒœì•ˆêµ°'],
      'ì „ë¶': ['ì „ì£¼ì‹œ', 'êµ°ì‚°ì‹œ', 'ìµì‚°ì‹œ', 'ì •ìì‹œ', 'ë‚¨ì›ì‹œ', 'ê¹€ì œì‹œ', 'ì™„ì£¼êµ°', 'ì§„ì•ˆêµ°', 'ë¬´ì£¼êµ°', 'ì¥ìˆ˜êµ°', 'ì„ì‹¤êµ°', 'ìˆœì°½êµ°', 'ê³ ì°½êµ°', 'ë¶€ì•ˆêµ°'],
      'ì „ë‚¨': ['ëª©í¬ì‹œ', 'ì—¬ìˆ˜ì‹œ', 'ìˆœì²œì‹œ', 'ë‚˜ì£¼ì‹œ', 'ê´‘ì–‘ì‹œ', 'ë‹´ì–‘êµ°', 'ê³¡ì„±êµ°', 'êµ¬ë¡€êµ°', 'ê³ í¥êµ°', 'ë³´ì„±êµ°', 'í™”ìˆœêµ°', 'ì¥í¥êµ°', 'ê°•ì§„êµ°', 'í•´ë‚¨êµ°', 'ì˜ì•”êµ°', 'ë¬´ì•ˆêµ°', 'í•¨í‰êµ°', 'ì˜ê´‘êµ°', 'ì¥ì„±êµ°', 'ì™„ë„êµ°', 'ì§„ë„êµ°', 'ì‹ ì•ˆêµ°'],
      'ê²½ë¶': ['í¬í•­ì‹œ', 'ê²½ì£¼ì‹œ', 'ê¹€ì²œì‹œ', 'ì•ˆë™ì‹œ', 'êµ¬ë¯¸ì‹œ', 'ì˜ì£¼ì‹œ', 'ì˜ì²œì‹œ', 'ìƒì£¼ì‹œ', 'ë¬¸ê²½ì‹œ', 'ê²½ì‚°ì‹œ', 'êµ°ìœ„êµ°', 'ì˜ì„±êµ°', 'ì²­ì†¡êµ°', 'ì˜ì–‘êµ°', 'ì˜ë•êµ°', 'ì²­ë„êµ°', 'ê³ ë ¹êµ°', 'ì„±ì£¼êµ°', 'ì¹ ê³¡êµ°', 'ì˜ˆì²œêµ°', 'ë´‰í™”êµ°', 'ìš¸ì§„êµ°', 'ìš¸ë¦‰êµ°'],
      'ê²½ë‚¨': ['ì°½ì›ì‹œ', 'ì§„ì£¼ì‹œ', 'í†µì˜ì‹œ', 'ì‚¬ì²œì‹œ', 'ê¹€í•´ì‹œ', 'ë°€ì–‘ì‹œ', 'ê±°ì œì‹œ', 'ì–‘ì‚°ì‹œ', 'ì˜ë ¹êµ°', 'í•¨ì•ˆêµ°', 'ì°½ë…•êµ°', 'ê³ ì„±êµ°', 'ë‚¨í•´êµ°', 'í•˜ë™êµ°', 'ì‚°ì²­êµ°', 'í•¨ì–‘êµ°', 'ê±°ì°½êµ°', 'í•©ì²œêµ°'],
      'ì œì£¼': ['ì œì£¼ì‹œ', 'ì„œê·€í¬ì‹œ']
    };
    
    // ì‹œë„ ì„ íƒ ì‹œ ì‹œêµ°êµ¬ ì˜µì…˜ ì—…ë°ì´íŠ¸ ë° ìˆ˜ë„ê¶Œ ìë™ ì„¤ì •
    function updateSigunguOptions() {
      const sidoSelect = document.getElementById('location-sido');
      const sigunguSelect = document.getElementById('location-sigungu');
      const capitalAreaSelect = document.getElementById('capital-area');
      
      const selectedSido = sidoSelect.value;
      
      // ì‹œêµ°êµ¬ ì´ˆê¸°í™”
      sigunguSelect.innerHTML = '<option value="">ì„ íƒí•˜ì„¸ìš”</option>';
      
      if (selectedSido && SIGUNGU_DATA[selectedSido]) {
        // ì‹œêµ°êµ¬ ì˜µì…˜ ì¶”ê°€
        SIGUNGU_DATA[selectedSido].forEach(sigungu => {
          const option = document.createElement('option');
          option.value = sigungu;
          option.textContent = sigungu;
          sigunguSelect.appendChild(option);
        });
        sigunguSelect.disabled = false;
        
        // ìˆ˜ë„ê¶Œ ì—¬ë¶€ ìë™ ì„¤ì •
        if (selectedSido === 'ì„œìš¸' || selectedSido === 'ê²½ê¸°' || selectedSido === 'ì¸ì²œ') {
          capitalAreaSelect.value = 'Y';
        } else {
          capitalAreaSelect.value = 'N';
        }
        capitalAreaSelect.disabled = true; // ìë™ ì„¤ì •ì´ë¯€ë¡œ ë¹„í™œì„±í™”
      } else {
        sigunguSelect.innerHTML = '<option value="">ì‹œë„ë¥¼ ë¨¼ì € ì„ íƒí•˜ì„¸ìš”</option>';
        sigunguSelect.disabled = true;
        capitalAreaSelect.value = '';
        capitalAreaSelect.disabled = true;
      }
    }
    
    // ì´ˆê¸°í™” í•¨ìˆ˜ ìˆ˜ì •
    const originalInit = window.addEventListener;
    window.addEventListener('load', function(event) {
      initializeApp();
      // setupCompanySearch(); // ìƒë‹¨ ê²€ìƒ‰ ê¸°ëŠ¥ ì œê±°ë¨
      setupAutoFill();
    });
    

    // ==================== ì™„ì „í•œ ìë™ì™„ì„± + ì§„í–‰ë¥  + API ì—°ë™ ====================
    
    window.addEventListener('load', function() {
      initCompanyAutocomplete();
      enhanceAutoFillButton();
    });
    
    // ==================== 1. ê¸°ì—…ëª… ìë™ì™„ì„± ====================
    
    function initCompanyAutocomplete() {
      console.log('ğŸ” ìë™ì™„ì„± ì´ˆê¸°í™”...');
      
      let companySearchTimeout = null;
      const searchInput = document.getElementById('company-search-input');
      const searchResults = document.getElementById('search-results');
      const searchBtn = document.getElementById('search-company-btn');
      
      if (!searchInput || !searchResults) {
        console.error('âŒ ê²€ìƒ‰ ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
        return;
      }
      
      // ê¸°ì—…ëª… ì…ë ¥ ì‹œ ìë™ ê²€ìƒ‰
      searchInput.addEventListener('input', function(e) {
        const query = e.target.value.trim();
        
        if (query.length < 2) {
          searchResults.style.display = 'none';
          return;
        }
        
        clearTimeout(companySearchTimeout);
        companySearchTimeout = setTimeout(() => {
          searchCompaniesByName(query);
        }, 500);
      });
      
      // ê²€ìƒ‰ ë²„íŠ¼
      if (searchBtn) {
        searchBtn.addEventListener('click', function() {
          const query = searchInput.value.trim();
          if (query.length >= 2) searchCompaniesByName(query);
        });
      }
      
      // ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°
      document.addEventListener('click', function(e) {
        if (!e.target.closest('.company-search-section')) {
          searchResults.style.display = 'none';
        }
      });
      
      async function searchCompaniesByName(query) {
        try {
          searchResults.innerHTML = '<div class="search-loading"><div class="spinner"></div><div>ê²€ìƒ‰ ì¤‘...</div></div>';
          searchResults.style.display = 'block';
          
          const response = await fetch('/.netlify/functions/searchCompanyByName', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ companyName: query })
          });
          
          if (!response.ok) throw new Error('ê²€ìƒ‰ ì‹¤íŒ¨');
          
          const data = await response.json();
          
          if (data.success && data.companies && data.companies.length > 0) {
            displayResults(data.companies);
          } else {
            searchResults.innerHTML = '<div class="no-results">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
          }
        } catch (error) {
          console.error('ê²€ìƒ‰ ì˜¤ë¥˜:', error);
          searchResults.innerHTML = '<div class="search-error">ê²€ìƒ‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</div>';
        }
      }
      
      function displayResults(companies) {
        searchResults.innerHTML = companies.map((company, index) => {
          const bizNo = formatBizNo(company.bizNo);
          return `
            <div class="search-result-item" data-index="${index}" style="cursor: pointer;">
              <div class="company-name">${escapeHtml(company.name)}</div>
              <div class="company-info">
                <span style="font-family: monospace; font-weight: 500;">${bizNo}</span>
                <span style="padding: 2px 8px; border-radius: 12px; font-size: 0.85rem; font-weight: 600; ${company.status === 'ê³„ì†ì‚¬ì—…ì' ? 'background: #d4edda; color: #155724;' : 'background: #f8d7da; color: #721c24;'}">
                  ${company.status}
                </span>
                ${company.address ? `<span>ğŸ“ ${escapeHtml(company.address)}</span>` : ''}
              </div>
            </div>
          `;
        }).join('');
        
        const items = searchResults.querySelectorAll('.search-result-item');
        items.forEach((item, index) => {
          item.addEventListener('click', function() {
            selectCompany(companies[index]);
          });
        });
        
        searchResults.style.display = 'block';
      }
      
      function selectCompany(company) {
        console.log('âœ… ì„ íƒ:', company.name);
        
        // ê²€ìƒ‰ë€ì— ì…ë ¥
        searchInput.value = company.name;
        
        const cleaned = company.bizNo.replace(/[^0-9]/g, '');
        
        // ê²€ìƒ‰ ì„¹ì…˜ ì‚¬ì—…ìë²ˆí˜¸
        if (cleaned.length === 10) {
          const b1 = document.getElementById('search-biz-1');
          const b2 = document.getElementById('search-biz-2');
          const b3 = document.getElementById('search-biz-3');
          if (b1) b1.value = cleaned.substring(0, 3);
          if (b2) b2.value = cleaned.substring(3, 5);
          if (b3) b3.value = cleaned.substring(5, 10);
        }
        
        // Section 1 ê¸°ì—…ëª…
        const companyName = document.getElementById('company-name');
        if (companyName) companyName.value = company.name;
        
        // Section 1 ì‚¬ì—…ìë²ˆí˜¸
        if (cleaned.length === 10) {
          const bn1 = document.getElementById('business-number-1');
          const bn2 = document.getElementById('business-number-2');
          const bn3 = document.getElementById('business-number-3');
          if (bn1) bn1.value = cleaned.substring(0, 3);
          if (bn2) bn2.value = cleaned.substring(3, 5);
          if (bn3) bn3.value = cleaned.substring(5, 10);
        }
        
        searchResults.style.display = 'none';
        
        alert(`âœ… ${company.name} ì„ íƒë¨!\n\nì‚¬ì—…ìë²ˆí˜¸: ${formatBizNo(company.bizNo)}\n\nì•„ë˜ì—ì„œ ë‚˜ë¨¸ì§€ ì •ë³´ë¥¼ ì…ë ¥í•˜ì„¸ìš”.`);
        
        const section1 = document.querySelector('.card h2');
        if (section1) section1.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
      
      function formatBizNo(bizNo) {
        const cleaned = bizNo.replace(/[^0-9]/g, '');
        return cleaned.length === 10 ? cleaned.replace(/(\d{3})(\d{2})(\d{5})/, '$1-$2-$3') : bizNo;
      }
      
      function escapeHtml(text) {
        const map = {'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#039;'};
        return text.replace(/[&<>"']/g, m => map[m]);
      }
      
      console.log('âœ… ìë™ì™„ì„± í™œì„±í™” ì™„ë£Œ');
    }
    
    // ==================== 2. ê°€ì ¸ì˜¤ê¸° ë²„íŠ¼ + ì§„í–‰ë¥  + API ì—°ë™ ====================
    
    function enhanceAutoFillButton() {
      console.log('ğŸ¤– ê°€ì ¸ì˜¤ê¸° ë²„íŠ¼ ê°•í™”...');
      
      const autoFillBtn = document.getElementById('auto-fill-btn');
      if (!autoFillBtn) {
        console.error('âŒ ê°€ì ¸ì˜¤ê¸° ë²„íŠ¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
        return;
      }
      
      // ì§„í–‰ë¥  HTML ì¶”ê°€
      const progressHTML = `
        <div id="progress-container" style="display: none; margin: 2rem 0; padding: 2rem; background: rgba(255,255,255,0.1); border-radius: 12px; border: 2px solid rgba(255,255,255,0.2);">
          <div style="background: rgba(255,255,255,0.2); border-radius: 20px; height: 10px; overflow: hidden; margin-bottom: 1rem;">
            <div id="progress-bar" style="height: 100%; background: linear-gradient(90deg, #4CAF50 0%, #45a049 100%); border-radius: 20px; width: 0%; transition: width 0.4s;"></div>
          </div>
          <div id="progress-text" style="text-align: center; color: #FFD700; font-weight: 600; font-size: 1.1rem; margin-bottom: 1.5rem;">ì¤€ë¹„ ì¤‘...</div>
          <div style="display: flex; justify-content: space-between; gap: 1rem;">
            <div id="step1" class="progress-step" style="flex: 1; text-align: center; padding: 1rem; border-radius: 8px; background: rgba(255,255,255,0.1); color: rgba(255,255,255,0.5);">
              <div style="font-size: 2rem; margin-bottom: 0.5rem;">ğŸ”</div>
              <div style="font-size: 0.9rem;">ê¸°ì—… ê²€ì¦</div>
            </div>
            <div id="step2" class="progress-step" style="flex: 1; text-align: center; padding: 1rem; border-radius: 8px; background: rgba(255,255,255,0.1); color: rgba(255,255,255,0.5);">
              <div style="font-size: 2rem; margin-bottom: 0.5rem;">ğŸ“Š</div>
              <div style="font-size: 0.9rem;">êµ­ì„¸ì²­ ì¡°íšŒ</div>
            </div>
            <div id="step3" class="progress-step" style="flex: 1; text-align: center; padding: 1rem; border-radius: 8px; background: rgba(255,255,255,0.1); color: rgba(255,255,255,0.5);">
              <div style="font-size: 2rem; margin-bottom: 0.5rem;">ğŸ“ˆ</div>
              <div style="font-size: 0.9rem;">ê³µì‹œì •ë³´</div>
            </div>
            <div id="step4" class="progress-step" style="flex: 1; text-align: center; padding: 1rem; border-radius: 8px; background: rgba(255,255,255,0.1); color: rgba(255,255,255,0.5);">
              <div style="font-size: 2rem; margin-bottom: 0.5rem;">âœ…</div>
              <div style="font-size: 0.9rem;">ë¶„ì„ ì™„ë£Œ</div>
            </div>
          </div>
        </div>
        
        <div id="api-results" style="display: none; margin: 2rem 0;"></div>
      `;
      
      // ê°€ì ¸ì˜¤ê¸° ë²„íŠ¼ ì•„ë˜ì— ì§„í–‰ë¥  ì¶”ê°€
      autoFillBtn.parentElement.insertAdjacentHTML('afterend', progressHTML);
      
      // ê¸°ì¡´ í´ë¦­ ì´ë²¤íŠ¸ ì œê±°í•˜ê³  ìƒˆë¡œ ì¶”ê°€
      const newBtn = autoFillBtn.cloneNode(true);
      autoFillBtn.parentNode.replaceChild(newBtn, autoFillBtn);
      
      newBtn.addEventListener('click', async function() {
        await fetchCompanyData();
      });
      
      async function fetchCompanyData() {
        try {
          // ì‚¬ì—…ìë²ˆí˜¸ ê°€ì ¸ì˜¤ê¸°
          const bn1 = document.getElementById('business-number-1')?.value || '';
          const bn2 = document.getElementById('business-number-2')?.value || '';
          const bn3 = document.getElementById('business-number-3')?.value || '';
          const bizNo = bn1 + bn2 + bn3;
          
          if (bizNo.length !== 10) {
            alert('âš ï¸ ì‚¬ì—…ìë²ˆí˜¸ë¥¼ ì •í™•íˆ ì…ë ¥í•´ì£¼ì„¸ìš”.');
            return;
          }
          
          // ë²„íŠ¼ ë¹„í™œì„±í™”
          newBtn.disabled = true;
          newBtn.innerHTML = '<span>â³</span><span>ì¡°íšŒ ì¤‘...</span>';
          
          // ì§„í–‰ë¥  í‘œì‹œ
          const progressContainer = document.getElementById('progress-container');
          const progressBar = document.getElementById('progress-bar');
          const progressText = document.getElementById('progress-text');
          progressContainer.style.display = 'block';
          
          // Step 1: ê¸°ì—… ê²€ì¦ (25%)
          updateProgress(25, 'ğŸ” ê¸°ì—… ì •ë³´ ê²€ì¦ ì¤‘...', 1);
          await sleep(800);
          
          // Step 2: êµ­ì„¸ì²­ ì¡°íšŒ (50%)
          updateProgress(50, 'ğŸ“Š êµ­ì„¸ì²­ ë°ì´í„° ì¡°íšŒ ì¤‘...', 2);
          const ntsData = await callNTSAPI(bizNo);
          await sleep(1000);
          
          // Step 3: ê³µì‹œì •ë³´ ìˆ˜ì§‘ (75%)
          updateProgress(75, 'ğŸ“ˆ ê³µì‹œì •ë³´ ìˆ˜ì§‘ ì¤‘...', 3);
          const publicData = await callAnalyzeBizInfoAPI(bizNo);
          await sleep(1000);
          
          // Step 4: ì™„ë£Œ (100%)
          updateProgress(100, 'âœ… ë¶„ì„ ì™„ë£Œ!', 4);
          await sleep(500);
          
          // ê²°ê³¼ í‘œì‹œ
          displayAPIResults(ntsData, publicData);
          
          alert('âœ… ê¸°ì—… ì •ë³´ë¥¼ ì„±ê³µì ìœ¼ë¡œ ê°€ì ¸ì™”ìŠµë‹ˆë‹¤!');
          
        } catch (error) {
          console.error('âŒ ì˜¤ë¥˜:', error);
          alert('âŒ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤:\n' + error.message);
        } finally {
          newBtn.disabled = false;
          newBtn.innerHTML = '<span>ğŸ¤–</span><span>ê°€ì ¸ì˜¤ê¸°</span>';
          
          setTimeout(() => {
            document.getElementById('progress-container').style.display = 'none';
          }, 2000);
        }
      }
      
      function updateProgress(percent, text, step) {
        document.getElementById('progress-bar').style.width = percent + '%';
        document.getElementById('progress-text').textContent = text;
        
        for (let i = 1; i <= 4; i++) {
          const stepEl = document.getElementById('step' + i);
          if (i < step) {
            stepEl.style.background = 'rgba(76, 175, 80, 0.3)';
            stepEl.style.color = '#4CAF50';
          } else if (i === step) {
            stepEl.style.background = 'rgba(255, 215, 0, 0.3)';
            stepEl.style.color = '#FFD700';
          }
        }
      }
      
      async function callNTSAPI(bizNo) {
        const response = await fetch('/.netlify/functions/getNTS', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ businessNumber: bizNo })
        });
        
        if (!response.ok) throw new Error('êµ­ì„¸ì²­ API í˜¸ì¶œ ì‹¤íŒ¨');
        return await response.json();
      }
      
      async function callAnalyzeBizInfoAPI(bizNo) {
        const response = await fetch('/.netlify/functions/analyzeBizInfo', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ businessNumber: bizNo })
        });
        
        if (!response.ok) throw new Error('ê³µì‹œì •ë³´ API í˜¸ì¶œ ì‹¤íŒ¨');
        return await response.json();
      }
      
      function displayAPIResults(ntsData, publicData) {
        const resultsDiv = document.getElementById('api-results');
        
        resultsDiv.innerHTML = `
          <div style="background: rgba(255,255,255,0.95); border-radius: 12px; padding: 2rem; color: #333;">
            <h3 style="color: #0c2c54; margin-bottom: 1.5rem; font-size: 1.5rem;">ğŸ“Š ì¡°íšŒ ê²°ê³¼</h3>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
              <div style="background: #f8f9fa; padding: 1rem; border-radius: 8px; border-left: 4px solid #4CAF50;">
                <div style="font-size: 0.85rem; color: #666; margin-bottom: 0.5rem;">êµ­ì„¸ì²­ ìƒíƒœ</div>
                <div style="font-size: 1.2rem; font-weight: 600; color: #333;">${ntsData?.status || ntsData?.taxType || 'í™•ì¸ í•„ìš”'}</div>
              </div>
              
              <div style="background: #f8f9fa; padding: 1rem; border-radius: 8px; border-left: 4px solid #2196F3;">
                <div style="font-size: 0.85rem; color: #666; margin-bottom: 0.5rem;">ì—…ì¢…</div>
                <div style="font-size: 1.2rem; font-weight: 600; color: #333;">${ntsData?.type || publicData?.industry || '-'}</div>
              </div>
              
              <div style="background: #f8f9fa; padding: 1rem; border-radius: 8px; border-left: 4px solid #FF9800;">
                <div style="font-size: 0.85rem; color: #666; margin-bottom: 0.5rem;">ë§¤ì¶œì•¡</div>
                <div style="font-size: 1.2rem; font-weight: 600; color: #333;">${publicData?.revenue || publicData?.sales || '-'}</div>
              </div>
              
              <div style="background: #f8f9fa; padding: 1rem; border-radius: 8px; border-left: 4px solid #9C27B0;">
                <div style="font-size: 0.85rem; color: #666; margin-bottom: 0.5rem;">ì§ì› ìˆ˜</div>
                <div style="font-size: 1.2rem; font-weight: 600; color: #333;">${publicData?.employees || publicData?.employeeCount || '-'}</div>
              </div>
            </div>
            
            <div style="background: #e3f2fd; padding: 1rem; border-radius: 8px; border-left: 4px solid #2196F3;">
              <div style="font-size: 0.9rem; color: #1565c0; font-weight: 600;">ğŸ’¡ ì¡°íšŒëœ ì •ë³´ê°€ ìë™ìœ¼ë¡œ ì…ë ¥ë˜ì§€ ì•Šì•˜ë‹¤ë©´ ìˆ˜ë™ìœ¼ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.</div>
            </div>
          </div>
        `;
        
        resultsDiv.style.display = 'block';
        
        // ê²°ê³¼ë¡œ ìŠ¤í¬ë¡¤
        resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
      
      function sleep(ms) {
        return new Promise(resolve => setTimeout(resolve, ms));
      }
      
      console.log('âœ… ê°€ì ¸ì˜¤ê¸° ë²„íŠ¼ ê°•í™” ì™„ë£Œ');
    }
  </script>
</body>
</html>
