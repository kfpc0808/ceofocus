<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <title>ê¸°ì—… ì§€ì›ì‚¬ì—… AI ë§¤ì¹­ - KFPC</title>
  
  <style>
    /* ==================== iOS Safari ìµœì í™” ==================== */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: rgba(0,0,0,0);
      -webkit-touch-callout: none;
    }
    
    html {
      /* iOS Safari 100vh ë¬¸ì œ í•´ê²° */
      height: -webkit-fill-available;
      height: 100%;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Apple SD Gothic Neo', 'Noto Sans KR', sans-serif;
      background: linear-gradient(135deg, #0c2c54 0%, #2a5a8a 100%);
      color: #fff;
      min-height: 100vh;
      min-height: -webkit-fill-available;
      
      /* iOS Safari ìŠ¤í¬ë¡¤ ìµœì í™” */
      -webkit-overflow-scrolling: touch;
      overflow-y: auto;
      
      /* ë…¸ì¹˜ ëŒ€ì‘ */
      padding-top: env(safe-area-inset-top);
      padding-bottom: env(safe-area-inset-bottom);
      padding-left: env(safe-area-inset-left);
      padding-right: env(safe-area-inset-right);
      
      /* í…ìŠ¤íŠ¸ ì„ íƒ ë°©ì§€ (í¼ ì œì™¸) */
      -webkit-user-select: none;
      user-select: none;
    }
    
    /* ì…ë ¥ í•„ë“œëŠ” ì„ íƒ ê°€ëŠ¥ */
    input, textarea, select {
      -webkit-user-select: text;
      user-select: text;
    }
    
    /* ==================== ë¡œë”© í™”ë©´ ==================== */
    #loading-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100vh;
      height: -webkit-fill-available;
      background: linear-gradient(135deg, #0c2c54 0%, #2a5a8a 100%);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      transition: opacity 0.3s ease;
    }
    
    #loading-screen.hide {
      opacity: 0;
      pointer-events: none;
    }
    
    .loader {
      width: 50px;
      height: 50px;
      border: 4px solid rgba(255,255,255,0.3);
      border-top-color: #fff;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    .loading-text {
      margin-top: 1.5rem;
      font-size: 1.1rem;
      font-weight: 600;
    }
    
    /* ==================== ë©”ì¸ ì»¨í…Œì´ë„ˆ ==================== */
    #main-content {
      display: none;
      max-width: 1200px;
      margin: 0 auto;
      padding: 1rem;
      padding-bottom: calc(2rem + env(safe-area-inset-bottom));
    }
    
    /* ==================== í—¤ë” ==================== */
    .header {
      background: rgba(255,255,255,0.1);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border-radius: 16px;
      padding: 1.5rem;
      margin-bottom: 1.5rem;
      border: 1px solid rgba(255,255,255,0.2);
    }
    
    .header h1 {
      font-size: clamp(1.5rem, 5vw, 2rem);
      margin-bottom: 0.5rem;
      font-weight: 700;
    }
    
    .header p {
      font-size: clamp(0.9rem, 3vw, 1rem);
      opacity: 0.9;
    }
    
    .top-buttons {
      display: flex;
      gap: 0.5rem;
      margin-top: 1rem;
      flex-wrap: wrap;
    }
    
    /* ==================== ë²„íŠ¼ ìŠ¤íƒ€ì¼ ==================== */
    .btn {
      padding: 0.75rem 1.25rem;
      border-radius: 12px;
      border: none;
      font-weight: 600;
      font-size: 0.95rem;
      cursor: pointer;
      transition: all 0.2s ease;
      
      /* iOS í„°ì¹˜ ìµœì í™” */
      -webkit-appearance: none;
      appearance: none;
      touch-action: manipulation;
      min-height: 44px; /* iOS ê¶Œì¥ í„°ì¹˜ íƒ€ê²Ÿ í¬ê¸° */
    }
    
    .btn:active {
      transform: scale(0.98);
    }
    
    .btn-primary {
      background: linear-gradient(135deg, #FF8802 0%, #FF6B00 100%);
      color: #fff;
      box-shadow: 0 4px 12px rgba(255, 136, 2, 0.3);
    }
    
    .btn-secondary {
      background: rgba(255,255,255,0.15);
      color: #fff;
      border: 1px solid rgba(255,255,255,0.3);
    }
    
    .btn-home {
      background: rgba(76, 175, 80, 0.2);
      color: #fff;
      border: 1px solid rgba(76, 175, 80, 0.4);
    }
    
    /* ==================== ì¹´ë“œ ìŠ¤íƒ€ì¼ ==================== */
    .card {
      background: rgba(255,255,255,0.1);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border-radius: 16px;
      padding: 1.5rem;
      margin-bottom: 1.5rem;
      border: 1px solid rgba(255,255,255,0.2);
    }
    
    .card h2 {
      font-size: clamp(1.2rem, 4vw, 1.5rem);
      margin-bottom: 1rem;
      color: #ffd27f;
    }
    
    /* ==================== ê³ ê°ì‚¬ ì„ íƒ ì„¹ì…˜ ==================== */
    .company-selector {
      display: flex;
      gap: 0.75rem;
      margin-bottom: 1.5rem;
      flex-wrap: wrap;
    }
    
    .company-selector select {
      flex: 1;
      min-width: 200px;
    }
    
    /* ==================== ì…ë ¥ í•„ë“œ ==================== */
    .form-group {
      margin-bottom: 1.25rem;
    }
    
    .form-group label {
      display: block;
      font-size: 0.95rem;
      font-weight: 600;
      margin-bottom: 0.5rem;
      color: #ffd27f;
    }
    
    .form-group input,
    .form-group select,
    .form-group textarea {
      width: 100%;
      padding: 0.875rem;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.3);
      background: rgba(255,255,255,0.95);
      color: #333;
      font-size: 16px; /* iOS zoom ë°©ì§€ */
      
      /* iOS ìŠ¤íƒ€ì¼ ì œê±° */
      -webkit-appearance: none;
      appearance: none;
      
      /* iOS ê·¸ë¦¼ì ì œê±° */
      -webkit-box-shadow: none;
      box-shadow: none;
    }
    
    .form-group select {
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23333' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 0.875rem center;
      padding-right: 2.5rem;
    }
    
    .form-group input:focus,
    .form-group select:focus,
    .form-group textarea:focus {
      outline: none;
      border-color: #FF8802;
      box-shadow: 0 0 0 3px rgba(255, 136, 2, 0.2);
    }
    
    /* ==================== ì²´í¬ë°•ìŠ¤ ê·¸ë¦¬ë“œ ==================== */
    .checkbox-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
      gap: 0.75rem;
    }
    
    .checkbox-item {
      display: flex;
      align-items: center;
      padding: 0.625rem;
      background: rgba(255,255,255,0.1);
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s;
      min-height: 44px;
    }
    
    .checkbox-item:active {
      background: rgba(255,255,255,0.2);
    }
    
    .checkbox-item input[type="checkbox"] {
      width: 20px;
      height: 20px;
      margin-right: 0.5rem;
      cursor: pointer;
      
      /* iOS ì²´í¬ë°•ìŠ¤ ì»¤ìŠ¤í„°ë§ˆì´ì§• */
      -webkit-appearance: none;
      appearance: none;
      background: rgba(255,255,255,0.9);
      border: 2px solid rgba(255,255,255,0.5);
      border-radius: 4px;
      position: relative;
    }
    
    .checkbox-item input[type="checkbox"]:checked {
      background: #FF8802;
      border-color: #FF8802;
    }
    
    .checkbox-item input[type="checkbox"]:checked::after {
      content: 'âœ“';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: white;
      font-size: 14px;
      font-weight: bold;
    }
    
    .checkbox-item label {
      font-size: 0.9rem;
      cursor: pointer;
      margin: 0;
      color: #fff;
    }
    
    /* ==================== ì €ì¥ëœ ê³ ê°ì‚¬ ëª©ë¡ ==================== */
    .companies-list {
      max-height: 300px;
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
      margin-top: 1rem;
    }
    
    .company-item {
      background: rgba(255,255,255,0.1);
      padding: 1rem;
      border-radius: 12px;
      margin-bottom: 0.75rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      cursor: pointer;
      transition: all 0.2s;
      min-height: 60px;
    }
    
    .company-item:active {
      background: rgba(255,255,255,0.2);
      transform: scale(0.99);
    }
    
    .company-info h3 {
      font-size: 1.1rem;
      margin-bottom: 0.25rem;
    }
    
    .company-info p {
      font-size: 0.85rem;
      opacity: 0.8;
    }
    
    .company-actions {
      display: flex;
      gap: 0.5rem;
    }
    
    .btn-small {
      padding: 0.5rem 0.75rem;
      font-size: 0.85rem;
      min-height: 36px;
    }
    
    /* ==================== ê²°ê³¼ ì¹´ë“œ ==================== */
    .result-card {
      background: rgba(255,255,255,0.95);
      color: #333;
      border-radius: 16px;
      padding: 1.5rem;
      margin-bottom: 1rem;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    
    .result-card .rank {
      display: inline-block;
      background: linear-gradient(135deg, #FF8802 0%, #FF6B00 100%);
      color: white;
      padding: 0.25rem 0.75rem;
      border-radius: 20px;
      font-size: 0.85rem;
      font-weight: 700;
      margin-bottom: 0.75rem;
    }
    
    .result-card h3 {
      font-size: 1.2rem;
      color: #0c2c54;
      margin-bottom: 0.5rem;
      line-height: 1.4;
    }
    
    .result-card .org {
      color: #666;
      font-size: 0.9rem;
      margin-bottom: 0.75rem;
    }
    
    .match-score {
      display: inline-block;
      background: #4CAF50;
      color: white;
      padding: 0.375rem 0.875rem;
      border-radius: 20px;
      font-weight: 700;
      margin-bottom: 1rem;
    }
    
    .result-section {
      margin-bottom: 1rem;
    }
    
    .result-section h4 {
      font-size: 0.95rem;
      color: #0c2c54;
      margin-bottom: 0.5rem;
      font-weight: 700;
    }
    
    .result-section p {
      font-size: 0.9rem;
      line-height: 1.6;
      color: #555;
    }
    
    .priority-tag {
      display: inline-block;
      padding: 0.375rem 0.875rem;
      border-radius: 20px;
      font-size: 0.85rem;
      font-weight: 600;
      margin-top: 0.5rem;
    }
    
    .priority-ì¦‰ì‹œì‹ ì²­ {
      background: #ff5252;
      color: white;
    }
    
    .priority-ì¤€ë¹„í›„ì‹ ì²­ {
      background: #FFA726;
      color: white;
    }
    
    .priority-ì¥ê¸°ê²€í†  {
      background: #42A5F5;
      color: white;
    }
    
    /* ==================== ëª¨ë°”ì¼ ìµœì í™” ==================== */
    @media (max-width: 768px) {
      body {
        padding: 0.5rem;
      }
      
      #main-content {
        padding: 0.5rem;
        padding-bottom: calc(1rem + env(safe-area-inset-bottom));
      }
      
      .header {
        padding: 1rem;
      }
      
      .card {
        padding: 1rem;
      }
      
      .checkbox-grid {
        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
        gap: 0.5rem;
      }
      
      .top-buttons {
        flex-direction: column;
      }
      
      .btn {
        width: 100%;
      }
      
      .company-selector {
        flex-direction: column;
      }
      
      .company-selector select,
      .company-selector .btn {
        width: 100%;
      }
    }
    
    /* iPhone SE ë“± ì†Œí˜• ê¸°ê¸° */
    @media (max-width: 375px) {
      .header h1 {
        font-size: 1.3rem;
      }
      
      .checkbox-grid {
        grid-template-columns: 1fr;
      }
      
      .result-card {
        padding: 1rem;
      }
    }
    
    /* ==================== ê°€ë¡œ ëª¨ë“œ ìµœì í™” ==================== */
    @media (max-height: 500px) and (orientation: landscape) {
      body {
        padding-top: 0.5rem;
      }
      
      .header {
        padding: 0.75rem;
        margin-bottom: 1rem;
      }
      
      .card {
        padding: 1rem;
        margin-bottom: 1rem;
      }
    }
    
    /* ==================== ë‹¤í¬ëª¨ë“œ ëŒ€ì‘ ==================== */
    @media (prefers-color-scheme: dark) {
      /* iOS ë‹¤í¬ëª¨ë“œ ì‚¬ìš©ìë¥¼ ìœ„í•œ ì¶”ê°€ ìµœì í™” */
      .form-group input,
      .form-group select {
        background: rgba(255,255,255,0.9);
      }
    }
    
    /* ==================== ë¡œë”© ì˜¤ë²„ë ˆì´ ==================== */
    .loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100vh;
      height: -webkit-fill-available;
      background: rgba(12, 44, 84, 0.95);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 9998;
      flex-direction: column;
    }
    
    .loading-overlay.show {
      display: flex;
    }
    
    .loading-overlay .loader {
      width: 60px;
      height: 60px;
      border-width: 5px;
    }
    
    .loading-overlay .loading-text {
      font-size: 1.2rem;
      text-align: center;
      padding: 0 2rem;
    }
    
    .loading-steps {
      margin-top: 1rem;
      font-size: 0.9rem;
      opacity: 0.8;
      text-align: center;
    }
    
    /* ==================== ìŠ¤í¬ë¡¤ë°” ìŠ¤íƒ€ì¼ (WebKitë§Œ) ==================== */
    ::-webkit-scrollbar {
      width: 8px;
    }
    
    ::-webkit-scrollbar-track {
      background: rgba(255,255,255,0.1);
      border-radius: 4px;
    }
    
    ::-webkit-scrollbar-thumb {
      background: rgba(255,255,255,0.3);
      border-radius: 4px;
    }
    
    ::-webkit-scrollbar-thumb:hover {
      background: rgba(255,255,255,0.5);
    }
  </style>
</head>
<body>
  <!-- ë¡œë”© í™”ë©´ -->
  <div id="loading-screen">
    <div class="loader"></div>
    <div class="loading-text">ì•± ë¡œë”© ì¤‘...</div>
  </div>

  <!-- ë¡œë”© ì˜¤ë²„ë ˆì´ (ë¶„ì„ ì¤‘) -->
  <div id="loading-overlay" class="loading-overlay">
    <div class="loader"></div>
    <div class="loading-text" id="overlay-text">ê¸°ì—…ë§ˆë‹¹ ì¡°íšŒ ì¤‘...</div>
    <div class="loading-steps" id="overlay-steps"></div>
  </div>

  <!-- ë©”ì¸ ì»¨í…ì¸  -->
  <div id="main-content">
    <!-- í—¤ë” -->
    <div class="header">
      <h1>ğŸ¢ ê¸°ì—… ì§€ì›ì‚¬ì—… AI ë§¤ì¹­</h1>
      <p>Gemini 2.0 Flash ê¸°ë°˜ ë§ì¶¤ ì¶”ì²œ</p>
      <div class="top-buttons">
        <button class="btn btn-home" onclick="goHome()">ğŸ  ë©”ì¸ìœ¼ë¡œ</button>
      </div>
    </div>

    <!-- ê³ ê°ì‚¬ ì„ íƒ/ë“±ë¡ -->
    <div class="card">
      <h2>1. ê³ ê°ì‚¬ ì„ íƒ</h2>
      <div class="company-selector">
        <select id="company-select" onchange="loadSelectedCompany()">
          <option value="">-- ìƒˆë¡œ ì…ë ¥ --</option>
        </select>
        <button class="btn btn-primary btn-small" onclick="showCompanyList()">ëª©ë¡ ë³´ê¸°</button>
      </div>
    </div>

    <!-- ê¸°ì—… ì •ë³´ ì…ë ¥ -->
    <div class="card">
      <h2>2. ê¸°ì—… ì •ë³´ ì…ë ¥</h2>
      
      <div class="form-group">
        <label for="company-name">íšŒì‚¬ëª… *</label>
        <input type="text" id="company-name" placeholder="ì˜ˆ: (ì£¼)í•œêµ­FPì„¼í„°" required>
      </div>

      <div class="form-group">
        <label for="industry">ì—…ì¢… *</label>
        <select id="industry" required>
          <option value="">ì„ íƒí•˜ì„¸ìš”</option>
          <option value="IT/ì†Œí”„íŠ¸ì›¨ì–´">IT/ì†Œí”„íŠ¸ì›¨ì–´</option>
          <option value="ì œì¡°ì—…">ì œì¡°ì—…</option>
          <option value="ì„œë¹„ìŠ¤ì—…">ì„œë¹„ìŠ¤ì—…</option>
          <option value="ë„ì†Œë§¤">ë„ì†Œë§¤/ìœ í†µ</option>
          <option value="ê±´ì„¤">ê±´ì„¤</option>
          <option value="ê´€ê´‘/ìˆ™ë°•">ê´€ê´‘/ìˆ™ë°•/ìŒì‹</option>
          <option value="êµìœ¡">êµìœ¡</option>
          <option value="ì˜ë£Œ/ë°”ì´ì˜¤">ì˜ë£Œ/ë°”ì´ì˜¤</option>
          <option value="ë¬¸í™”/ì½˜í…ì¸ ">ë¬¸í™”/ì½˜í…ì¸ </option>
          <option value="ë†ë¦¼ì–´ì—…">ë†ë¦¼ì–´ì—…</option>
          <option value="ê¸°íƒ€">ê¸°íƒ€</option>
        </select>
      </div>

      <div class="form-group">
        <label for="location">ì†Œì¬ì§€ *</label>
        <select id="location" required>
          <option value="">ì„ íƒí•˜ì„¸ìš”</option>
          <option value="ì„œìš¸">ì„œìš¸</option>
          <option value="ê²½ê¸°">ê²½ê¸°</option>
          <option value="ì¸ì²œ">ì¸ì²œ</option>
          <option value="ë¶€ì‚°">ë¶€ì‚°</option>
          <option value="ëŒ€êµ¬">ëŒ€êµ¬</option>
          <option value="ëŒ€ì „">ëŒ€ì „</option>
          <option value="ê´‘ì£¼">ê´‘ì£¼</option>
          <option value="ìš¸ì‚°">ìš¸ì‚°</option>
          <option value="ì„¸ì¢…">ì„¸ì¢…</option>
          <option value="ê°•ì›">ê°•ì›</option>
          <option value="ì¶©ë¶">ì¶©ë¶</option>
          <option value="ì¶©ë‚¨">ì¶©ë‚¨</option>
          <option value="ì „ë¶">ì „ë¶</option>
          <option value="ì „ë‚¨">ì „ë‚¨</option>
          <option value="ê²½ë¶">ê²½ë¶</option>
          <option value="ê²½ë‚¨">ê²½ë‚¨</option>
          <option value="ì œì£¼">ì œì£¼</option>
        </select>
      </div>

      <div class="form-group">
        <label for="size">ê¸°ì—… ê·œëª¨ *</label>
        <select id="size" required>
          <option value="">ì„ íƒí•˜ì„¸ìš”</option>
          <option value="ì†Œê¸°ì—…">ì†Œê¸°ì—…</option>
          <option value="ì¤‘ê¸°ì—…">ì¤‘ê¸°ì—…</option>
          <option value="ëŒ€ê¸°ì—…">ëŒ€ê¸°ì—…</option>
        </select>
      </div>

      <div class="form-group">
        <label for="revenue">ë§¤ì¶œì•¡ (ì–µì›) *</label>
        <input type="number" id="revenue" placeholder="ì˜ˆ: 15" required>
      </div>

      <div class="form-group">
        <label for="experience">ì—…ë ¥ (ë…„) *</label>
        <input type="number" id="experience" placeholder="ì˜ˆ: 5" required>
      </div>
    </div>

    <!-- ì¸ì¦ ì •ë³´ -->
    <div class="card">
      <h2>3. ì¸ì¦ ì •ë³´ (ì„ íƒ)</h2>
      <div class="checkbox-grid" id="certifications">
        <div class="checkbox-item">
          <input type="checkbox" id="cert-venture" value="ë²¤ì²˜ê¸°ì—…">
          <label for="cert-venture">ë²¤ì²˜ê¸°ì—…</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="cert-innobiz" value="ì´ë…¸ë¹„ì¦ˆ">
          <label for="cert-innobiz">ì´ë…¸ë¹„ì¦ˆ</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="cert-mainbiz" value="ë©”ì¸ë¹„ì¦ˆ">
          <label for="cert-mainbiz">ë©”ì¸ë¹„ì¦ˆ</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="cert-woman" value="ì—¬ì„±ê¸°ì—…">
          <label for="cert-woman">ì—¬ì„±ê¸°ì—…</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="cert-social" value="ì‚¬íšŒì ê¸°ì—…">
          <label for="cert-social">ì‚¬íšŒì ê¸°ì—…</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="cert-export" value="ìˆ˜ì¶œê¸°ì—…">
          <label for="cert-export">ìˆ˜ì¶œê¸°ì—…</label>
        </div>
      </div>
    </div>

    <!-- ëª©í‘œ (ì„ íƒ) -->
    <div class="card">
      <h2>4. ì§€ì› ëª©í‘œ (ì„ íƒ)</h2>
      <div class="checkbox-grid" id="goals">
        <div class="checkbox-item">
          <input type="checkbox" id="goal-rd" value="R&D">
          <label for="goal-rd">R&D/ê¸°ìˆ ê°œë°œ</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="goal-export" value="ìˆ˜ì¶œ">
          <label for="goal-export">ìˆ˜ì¶œ/í•´ì™¸ì§„ì¶œ</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="goal-employ" value="ê³ ìš©">
          <label for="goal-employ">ê³ ìš©/ì¸ë ¥</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="goal-facility" value="ì‹œì„¤">
          <label for="goal-facility">ì‹œì„¤/ì„¤ë¹„</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="goal-marketing" value="ë§ˆì¼€íŒ…">
          <label for="goal-marketing">ë§ˆì¼€íŒ…/íŒë¡œ</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="goal-funding" value="ìê¸ˆ">
          <label for="goal-funding">ìš´ì˜ìê¸ˆ</label>
        </div>
      </div>
    </div>

    <!-- ì‹¤í–‰ ë²„íŠ¼ -->
    <div class="card">
      <button class="btn btn-primary" onclick="analyzePrograms()" style="width: 100%; font-size: 1.1rem; padding: 1rem;">
        ğŸ” ë§ì¶¤ ì§€ì›ì‚¬ì—… ì°¾ê¸°
      </button>
      <button class="btn btn-secondary" onclick="saveCompany()" style="width: 100%; margin-top: 0.75rem;">
        ğŸ’¾ ì´ ì •ë³´ ì €ì¥í•˜ê¸°
      </button>
    </div>

    <!-- ê²°ê³¼ í‘œì‹œ ì˜ì—­ -->
    <div id="results-section" style="display: none;">
      <!-- ê²°ê³¼ê°€ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë¨ -->
    </div>
  </div>

  <script>
    // ==================== ì „ì—­ ë³€ìˆ˜ ====================
    let savedCompanies = {};

    // ==================== ì•± ì´ˆê¸°í™” ====================
    async function initializeApp() {
      try {
        console.log('ğŸš€ ì•± ì´ˆê¸°í™” ì‹œì‘');
        
        // ì €ì¥ëœ ê³ ê°ì‚¬ ë¶ˆëŸ¬ì˜¤ê¸° (localStorage ì‚¬ìš©)
        loadSavedCompanies();
        
        hideLoading();
        
      } catch (error) {
        console.error('âŒ ì´ˆê¸°í™” ì‹¤íŒ¨:', error);
        alert('ì‹œìŠ¤í…œ ì´ˆê¸°í™”ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\n\n' + error.message);
      }
    }
    
    function hideLoading() {
      const loading = document.getElementById('loading-screen');
      const mainContent = document.getElementById('main-content');
      
      loading.classList.add('hide');
      mainContent.style.display = 'block';
      
      setTimeout(() => {
        loading.style.display = 'none';
      }, 300);
    }
    
    // ==================== ê³ ê°ì‚¬ ì €ì¥/ë¶ˆëŸ¬ì˜¤ê¸° (localStorage) ====================
    async function loadSavedCompanies() {
      try {
        console.log('ğŸ“ ì €ì¥ëœ ê³ ê°ì‚¬ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...');
        
        const saved = localStorage.getItem('bizinfo_companies');
        if (saved) {
          savedCompanies = JSON.parse(saved);
          updateCompanySelect();
          console.log(`âœ… ${Object.keys(savedCompanies).length}ê°œ ê³ ê°ì‚¬ ë¡œë“œ`);
        } else {
          console.log('â„¹ï¸ ì €ì¥ëœ ê³ ê°ì‚¬ ì—†ìŒ');
        }
        
      } catch (error) {
        console.warn('âš ï¸ ê³ ê°ì‚¬ ë¡œë“œ ì‹¤íŒ¨:', error);
      }
    }
    
    function updateCompanySelect() {
      const select = document.getElementById('company-select');
      select.innerHTML = '<option value="">-- ìƒˆë¡œ ì…ë ¥ --</option>';
      
      Object.keys(savedCompanies).forEach(id => {
        const company = savedCompanies[id];
        const option = document.createElement('option');
        option.value = id;
        option.textContent = `${company.name} (${company.industry})`;
        select.appendChild(option);
      });
    }
    
    function loadSelectedCompany() {
      const select = document.getElementById('company-select');
      const companyId = select.value;
      
      if (!companyId) {
        clearForm();
        return;
      }
      
      const company = savedCompanies[companyId];
      if (!company) return;
      
      // í¼ì— ë°ì´í„° ì±„ìš°ê¸°
      document.getElementById('company-name').value = company.name || '';
      document.getElementById('industry').value = company.industry || '';
      document.getElementById('location').value = company.location || '';
      document.getElementById('size').value = company.size || '';
      document.getElementById('revenue').value = company.revenue || '';
      document.getElementById('experience').value = company.experience || '';
      
      // ì²´í¬ë°•ìŠ¤
      document.querySelectorAll('#certifications input[type="checkbox"]').forEach(cb => {
        cb.checked = company.certifications?.includes(cb.value) || false;
      });
      
      document.querySelectorAll('#goals input[type="checkbox"]').forEach(cb => {
        cb.checked = company.goals?.includes(cb.value) || false;
      });
      
      console.log('âœ… ê³ ê°ì‚¬ ì •ë³´ ë¡œë“œ:', company.name);
    }
    
    async function saveCompany() {
      try {
        const companyData = collectFormData();
        
        if (!companyData.companyName) {
          alert('íšŒì‚¬ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
          return;
        }
        
        const companyId = Date.now().toString();
        savedCompanies[companyId] = {
          ...companyData,
          name: companyData.companyName,
          savedAt: new Date().toISOString()
        };
        
        // localStorageì— ì €ì¥
        localStorage.setItem('bizinfo_companies', JSON.stringify(savedCompanies));
        
        updateCompanySelect();
        
        alert(`âœ… "${companyData.companyName}" ì €ì¥ ì™„ë£Œ!`);
        console.log('ğŸ’¾ ê³ ê°ì‚¬ ì €ì¥ ì™„ë£Œ');
        
      } catch (error) {
        console.error('âŒ ì €ì¥ ì‹¤íŒ¨:', error);
        alert('ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\n\n' + error.message);
      }
    }
    
    function showCompanyList() {
      const companies = Object.values(savedCompanies);
      
      if (companies.length === 0) {
        alert('ì €ì¥ëœ ê³ ê°ì‚¬ê°€ ì—†ìŠµë‹ˆë‹¤.');
        return;
      }
      
      let html = '<div class="card"><h2>ğŸ“‹ ì €ì¥ëœ ê³ ê°ì‚¬</h2><div class="companies-list">';
      
      Object.keys(savedCompanies).forEach(id => {
        const company = savedCompanies[id];
        html += `
          <div class="company-item" onclick="selectAndLoadCompany('${id}')">
            <div class="company-info">
              <h3>${company.name}</h3>
              <p>${company.industry} | ${company.location} | ${company.size}</p>
            </div>
            <div class="company-actions">
              <button class="btn btn-primary btn-small" onclick="event.stopPropagation(); selectAndLoadCompany('${id}')">ì„ íƒ</button>
              <button class="btn btn-secondary btn-small" onclick="event.stopPropagation(); deleteCompany('${id}')">ì‚­ì œ</button>
            </div>
          </div>
        `;
      });
      
      html += '</div></div>';
      
      const resultsSection = document.getElementById('results-section');
      resultsSection.innerHTML = html;
      resultsSection.style.display = 'block';
      resultsSection.scrollIntoView({ behavior: 'smooth' });
    }
    
    function selectAndLoadCompany(companyId) {
      const select = document.getElementById('company-select');
      select.value = companyId;
      loadSelectedCompany();
      
      // ìŠ¤í¬ë¡¤ì„ í¼ìœ¼ë¡œ
      document.getElementById('company-name').scrollIntoView({ behavior: 'smooth' });
    }
    
    async function deleteCompany(companyId) {
      const company = savedCompanies[companyId];
      if (!confirm(`"${company.name}"ì„(ë¥¼) ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
        return;
      }
      
      try {
        delete savedCompanies[companyId];
        
        // localStorageì— ì €ì¥
        localStorage.setItem('bizinfo_companies', JSON.stringify(savedCompanies));
        
        updateCompanySelect();
        showCompanyList(); // ëª©ë¡ ê°±ì‹ 
        
        alert('ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
        
      } catch (error) {
        console.error('âŒ ì‚­ì œ ì‹¤íŒ¨:', error);
        alert('ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
      }
    }
    
    // ==================== í¼ ë°ì´í„° ìˆ˜ì§‘ ====================
    function collectFormData() {
      const certifications = Array.from(
        document.querySelectorAll('#certifications input[type="checkbox"]:checked')
      ).map(cb => cb.value);
      
      const goals = Array.from(
        document.querySelectorAll('#goals input[type="checkbox"]:checked')
      ).map(cb => cb.value);
      
      return {
        companyName: document.getElementById('company-name').value.trim(),
        industry: document.getElementById('industry').value,
        location: document.getElementById('location').value,
        size: document.getElementById('size').value,
        revenue: document.getElementById('revenue').value,
        experience: document.getElementById('experience').value,
        certifications: certifications,
        goals: goals
      };
    }
    
    function clearForm() {
      document.getElementById('company-name').value = '';
      document.getElementById('industry').value = '';
      document.getElementById('location').value = '';
      document.getElementById('size').value = '';
      document.getElementById('revenue').value = '';
      document.getElementById('experience').value = '';
      
      document.querySelectorAll('input[type="checkbox"]').forEach(cb => {
        cb.checked = false;
      });
    }
    
    // ==================== AI ë¶„ì„ ì‹¤í–‰ ====================
    async function analyzePrograms() {
      const companyData = collectFormData();
      
      // í•„ìˆ˜ í•­ëª© í™•ì¸
      if (!companyData.companyName || !companyData.industry || 
          !companyData.location || !companyData.size || 
          !companyData.revenue || !companyData.experience) {
        alert('í•„ìˆ˜ í•­ëª©(*)ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        return;
      }
      
      try {
        // ë¡œë”© ì˜¤ë²„ë ˆì´ í‘œì‹œ
        showLoadingOverlay('ê¸°ì—…ë§ˆë‹¹ API ì¡°íšŒ ì¤‘...', '500ê°œ ì§€ì›ì‚¬ì—… í™•ì¸ ì¤‘');
        
        console.log('ğŸ” ë¶„ì„ ì‹œì‘:', companyData.companyName);
        
        // Netlify Functions í˜¸ì¶œ
        const response = await fetch('/.netlify/functions/analyzeBizInfo', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({
            companyProfile: companyData
          })
        });
        
        if (!response.ok) {
          throw new Error(`ì„œë²„ ì˜¤ë¥˜: ${response.status}`);
        }
        
        const result = await response.json();
        
        console.log('âœ… ë¶„ì„ ì™„ë£Œ:', result);
        
        hideLoadingOverlay();
        
        // ê²°ê³¼ í‘œì‹œ
        displayResults(result);
        
      } catch (error) {
        hideLoadingOverlay();
        console.error('âŒ ë¶„ì„ ì‹¤íŒ¨:', error);
        
        let errorMsg = 'ë¶„ì„ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.';
        if (error.message) {
          errorMsg += '\n\n' + error.message;
        }
        
        alert(errorMsg);
      }
    }
    
    function showLoadingOverlay(text, steps) {
      const overlay = document.getElementById('loading-overlay');
      const textEl = document.getElementById('overlay-text');
      const stepsEl = document.getElementById('overlay-steps');
      
      textEl.textContent = text;
      stepsEl.textContent = steps || '';
      overlay.classList.add('show');
      
      // ì§„í–‰ ìƒí™© ì‹œë®¬ë ˆì´ì…˜
      setTimeout(() => {
        if (overlay.classList.contains('show')) {
          textEl.textContent = 'Gemini 2.0 Flash ë¶„ì„ ì¤‘...';
          stepsEl.textContent = 'ìµœì ì˜ ì‚¬ì—… ì„ ë³„ ì¤‘';
        }
      }, 3000);
    }
    
    function hideLoadingOverlay() {
      const overlay = document.getElementById('loading-overlay');
      overlay.classList.remove('show');
    }
    
    // ==================== ê²°ê³¼ í‘œì‹œ ====================
    function displayResults(data) {
      const resultsSection = document.getElementById('results-section');
      
      if (!data.success || !data.recommendations || data.recommendations.length === 0) {
        resultsSection.innerHTML = `
          <div class="card" style="background: rgba(255,200,100,0.2);">
            <h2>âš ï¸ ì¶”ì²œ ê²°ê³¼ ì—†ìŒ</h2>
            <p>í˜„ì¬ ì…ë ¥í•˜ì‹  ì¡°ê±´ì— ë§ëŠ” ì§€ì›ì‚¬ì—…ì„ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.</p>
            <p style="margin-top: 1rem;">ë‹¤ë¥¸ ì¡°ê±´ìœ¼ë¡œ ë‹¤ì‹œ ê²€ìƒ‰í•´ë³´ì„¸ìš”.</p>
          </div>
        `;
        resultsSection.style.display = 'block';
        resultsSection.scrollIntoView({ behavior: 'smooth' });
        return;
      }
      
      let html = `
        <div class="card">
          <h2>ğŸ’¡ AI ì¶”ì²œ ê²°ê³¼</h2>
          <p>ì´ ${data.totalPrograms}ê°œ ì¤‘ ${data.filteredPrograms}ê°œ í•„í„°ë§ â†’ ${data.recommendations.length}ê°œ ì¶”ì²œ</p>
        </div>
      `;
      
      data.recommendations.forEach((rec, index) => {
        html += `
          <div class="result-card">
            <span class="rank">${rec.rank || (index + 1)}ìœ„</span>
            <h3>${rec.programName}</h3>
            <div class="org">${rec.organization}</div>
            <span class="match-score">ë§¤ì¹­ë„ ${rec.matchScore}ì </span>
            
            <div class="result-section">
              <h4>âœ… ì¶”ì²œ ì´ìœ </h4>
              <p>${rec.reason}</p>
            </div>
            
            ${rec.benefits ? `
            <div class="result-section">
              <h4>ğŸ’° ì§€ì› ë‚´ìš©</h4>
              <p>${rec.benefits}</p>
            </div>
            ` : ''}
            
            ${rec.cautions ? `
            <div class="result-section">
              <h4>âš ï¸ ì£¼ì˜ì‚¬í•­</h4>
              <p>${rec.cautions}</p>
            </div>
            ` : ''}
            
            ${rec.applicationPeriod ? `
            <div class="result-section">
              <h4>ğŸ“… ì‹ ì²­ê¸°ê°„</h4>
              <p>${rec.applicationPeriod}</p>
            </div>
            ` : ''}
            
            ${rec.priority ? `
              <span class="priority-tag priority-${rec.priority}">${rec.priority}</span>
            ` : ''}
            
            ${rec.detailUrl ? `
              <button class="btn btn-primary" style="width: 100%; margin-top: 1rem;" 
                      onclick="window.open('${rec.detailUrl}', '_blank')">
                ìƒì„¸ë³´ê¸° â†’
              </button>
            ` : ''}
          </div>
        `;
      });
      
      resultsSection.innerHTML = html;
      resultsSection.style.display = 'block';
      
      // ë¶€ë“œëŸ½ê²Œ ìŠ¤í¬ë¡¤
      setTimeout(() => {
        resultsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }, 100);
    }
    
    // ==================== ë„¤ë¹„ê²Œì´ì…˜ ====================
    function goHome() {
      window.location.href = 'index.html';
    }
    
    // ==================== í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™” ====================
    window.addEventListener('load', () => {
      console.log('ğŸ“± í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ');
      initializeApp();
    });
  </script>
</body>
</html>
